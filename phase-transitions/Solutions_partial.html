<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Unifying concepts: outline solutions to problems</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../index.pdf" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-f9e9f27e2f64dd25e94c2742b294698a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/live-runtime/live-runtime.js" type="module"></script>
<link href="../site_libs/quarto-contrib/live-runtime/live-runtime.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="module" src="../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../phase-transitions/introduction.html">Unifying concepts</a></li><li class="breadcrumb-item"><a href="../phase-transitions/Solutions_partial.html">Solutions to problems</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../courselogo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reading.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Recommended texts</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Unifying concepts</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to phase behaviour</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/background.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Background concepts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/approach-to-criticality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The approach to criticality</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/Ising-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">The Ising model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/mean-field-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Mean field theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/scaling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">The static scaling hypothesis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/rg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Universality and renormalization group theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/precourse-reading.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Precourse reading and revision</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/problems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Problems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/Lecture Slides/Slides.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture slides</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notes as pdf</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/Solutions_partial.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Solutions to problems</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#existence-of-a-phase-transition-in-d2." id="toc-existence-of-a-phase-transition-in-d2." class="nav-link active" data-scroll-target="#existence-of-a-phase-transition-in-d2.">1. Existence of a phase transition in <span class="math inline">\(d=2\)</span>.</a></li>
  <li><a href="#correlation-length" id="toc-correlation-length" class="nav-link" data-scroll-target="#correlation-length">2. Correlation Length</a></li>
  <li><a href="#a-model-fluid" id="toc-a-model-fluid" class="nav-link" data-scroll-target="#a-model-fluid">3. A model fluid</a></li>
  <li><a href="#mean-field-theory-of-the-ising-model-heat-capacity" id="toc-mean-field-theory-of-the-ising-model-heat-capacity" class="nav-link" data-scroll-target="#mean-field-theory-of-the-ising-model-heat-capacity">4. Mean field theory of the Ising model heat capacity</a></li>
  <li><a href="#magnetisation-and-fluctuations" id="toc-magnetisation-and-fluctuations" class="nav-link" data-scroll-target="#magnetisation-and-fluctuations">5. Magnetisation and fluctuations</a></li>
  <li><a href="#spin-1-ising-model" id="toc-spin-1-ising-model" class="nav-link" data-scroll-target="#spin-1-ising-model">6. Spin-1 Ising model</a></li>
  <li><a href="#transfer-matrix" id="toc-transfer-matrix" class="nav-link" data-scroll-target="#transfer-matrix">7. Transfer Matrix</a></li>
  <li><a href="#landau-theory" id="toc-landau-theory" class="nav-link" data-scroll-target="#landau-theory">8. Landau theory</a></li>
  <li><a href="#scaling-equation-of-state" id="toc-scaling-equation-of-state" class="nav-link" data-scroll-target="#scaling-equation-of-state">9. Scaling equation of state</a></li>
  <li><a href="#scaling-laws" id="toc-scaling-laws" class="nav-link" data-scroll-target="#scaling-laws">10. Scaling laws</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../phase-transitions/introduction.html">Unifying concepts</a></li><li class="breadcrumb-item"><a href="../phase-transitions/Solutions_partial.html">Solutions to problems</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="solutions" class="quarto-section-identifier">Unifying concepts: outline solutions to problems</span></h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<p>Here we present outline solutions to the problems.</p>
<section id="existence-of-a-phase-transition-in-d2." class="level3">
<h3 class="anchored" data-anchor-id="existence-of-a-phase-transition-in-d2.">1. Existence of a phase transition in <span class="math inline">\(d=2\)</span>.</h3>
<p>Consider the simplest elementary excitation that will destroy long range order in the 2d system: a domain wall of <span class="math inline">\(N\)</span> segments which divides an Ising system of <span class="math inline">\(L\times L\)</span> spins into a spin up and a spin down part.</p>
<div id="fig-domainwall" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-domainwall-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figs/domainwall.001.png" class="img-fluid figure-img" style="width:30.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-domainwall-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: An <span class="math inline">\(N\)</span>-step domain wall in an Ising lattice.
</figcaption>
</figure>
</div>
<p>The associated energy cost is <span class="math inline">\(2JN \equiv \Delta E\)</span>.</p>
<p>To evaluate the entropy gain due to a domain wall in the system we have to estimate <span class="math inline">\(\Omega\)</span> the number of possible paths for the domain wall. If we start at the left hand side then there are <span class="math inline">\(L\)</span> starting positions. At each step the domain wall can move to the right, move up or move down. This implies that the number of domain walls is approximately</p>
<p><span class="math display">\[
\Omega\approx L3^N
\]</span> Hence the entropy gain is:</p>
<p><span class="math display">\[
\Delta S=Nk_B\ln 3+k_B\ln L\approx Nk_B\ln 3  
\]</span></p>
<p>Accordingly, the change in the free energy associated with inserting such a domain wall into an ordered system is</p>
<p><span class="math display">\[
\Delta F=\Delta E-T\Delta S= N(2J-k_BT\ln 3)
\]</span></p>
<p>For small enough <span class="math inline">\(T &lt;2J/(k_B\ln 3)\)</span>, the free energy change is positive. Thus the ordered phase is free energetically stable against formation of a wall. Accordingly there will be a non zero value for <span class="math inline">\(T_c\)</span> in two dimensions.</p>
<hr>
</section>
<section id="correlation-length" class="level3">
<h3 class="anchored" data-anchor-id="correlation-length">2. Correlation Length</h3>
<p>Denote by <span class="math inline">\(m\)</span> the number of domain walls between sites <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>. Then <span class="math inline">\(s_is_j=1\)</span> for <span class="math inline">\(m\)</span> even, and <span class="math inline">\(s_is_j=-1\)</span> for <span class="math inline">\(m\)</span> odd.</p>
<p>Hence</p>
<p><span class="math display">\[
\langle s_i s_j\rangle =\sum_m p_m(-1)^m
\]</span> with <span class="math inline">\(p_m\)</span> the probability of finding <span class="math inline">\(m\)</span> domain walls between them.</p>
<p>Now <span class="math inline">\(p_m\)</span> is given by the binomial distribution, with the probability of a single domain wall at each bond given by</p>
<p><span class="math display">\[
p=\frac{e^{-2J/k_BT}}{1+e^{-2J/k_BT}}
\]</span></p>
<p>and the probability of no wall is <span class="math inline">\(1-p\)</span>. Now, in the regime where <span class="math inline">\(T\)</span> is small, <span class="math inline">\(p\)</span> is very small, and there will be few domain walls between sites <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>. If additionally, <span class="math inline">\(R_{ij}=|i-j|a\)</span> is large, it tranpires that the binomial distribution assumes the limiting form of a Poissonian distribution (revise this if necessary). Thus</p>
<p><span class="math display">\[
p_m=\frac{\overline{m}^me^{-\overline{m}}}{m!}
\]</span></p>
<p>where <span class="math inline">\(\overline{m}=p|j-i|=pR_{ij}/a\)</span> . Then</p>
<p><span class="math display">\[\begin{align*}
\langle s_i s_j\rangle =&amp; e^{-\overline {m}}\sum_m\frac{(-1)^m\overline{m}^m} {m!}\approx e^{-2\overline{m}}\\
                       =&amp; e^{-2pR_{ij}/a}\\
                       =&amp; e^{-R_{ij}/\xi}
\end{align*}\]</span></p>
<p>with <span class="math inline">\(\xi=a/2p\)</span>, the correlation length.</p>
<hr>
</section>
<section id="a-model-fluid" class="level3">
<h3 class="anchored" data-anchor-id="a-model-fluid">3. A model fluid</h3>
<p>The van der Waals (vdW) equation of state (See Sec 4.4.1 of the book by Yeomans) is essentially a mean field theory for fluids. It relates the pressure and the volume of a fluid to the temperature:</p>
<p><span class="math display">\[
\left(P+\frac{a}{V^2}\right)(V-b)=Nk_BT
\]</span> where <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are constants chosen to describe a specific substance and <span class="math inline">\(N\)</span> is Avogadro’s number. Hence</p>
<p><span id="eq-pres"><span class="math display">\[
P=\frac{Nk_BT}{V-b}-\frac{a}{V^2}
\tag{1}\]</span></span></p>
<p><span class="math display">\[
\Rightarrow \frac{\partial P}{\partial V}=\frac{-Nk_BT}{(V-b)^2}+\frac{2a}{V^3}
\]</span></p>
<p><span class="math display">\[
\Rightarrow \frac{\partial^2 P}{\partial V^2}=\frac{2Nk_BT}{(V-b)^3}-\frac{6a}{V^4}
\]</span></p>
<p>Now at criticality (ie. a continuous transition).</p>
<p><span class="math display">\[
\left(\frac{\partial P}{\partial V}\right)_T=\left(\frac{\partial^2 P}{\partial V^2}\right)_T=0
\]</span></p>
<p>Thus <span class="math display">\[\begin{align*}
\frac{Nk_BT}{(V_c-b)^2} =&amp; \frac{2a}{V_c^3}\\
\frac{2Nk_BT}{(V_c-b)^3} =&amp; \frac{6a}{V_c^4}
\end{align*}\]</span></p>
<p>solving for <span class="math inline">\(V_c\)</span> and <span class="math inline">\(Nk_BT_c\)</span> yields</p>
<p><span class="math display">\[\begin{align*}
V_c =&amp; 3b\\
Nk_BT_c =&amp; \frac{8a}{27b}
\end{align*}\]</span></p>
<p>Substituting these two results into <a href="#eq-pres" class="quarto-xref">Equation&nbsp;<span>1</span></a> yields</p>
<p><span class="math display">\[
P_c=\frac{a}{27b^2}
\]</span></p>
<p>Now let <span class="math inline">\(P=P_c p, V=V_cv, T=T_ct\)</span> in the vdW eqn. (Note that in this context <span class="math inline">\(t\)</span> is not the reduced temperature).</p>
<p><span class="math display">\[
\left(P_cp+\frac{a}{(V_cv)^2}\right)(V_cv-b)=N_Ak_BT_ct
\]</span></p>
<p>Substituting in for <span class="math inline">\(V_c, N_Ak_BT_c\)</span> and <span class="math inline">\(P_c\)</span></p>
<p><span class="math display">\[\begin{align*}
\left(p\frac{a}{27b^2}+\frac{a}{9b^2v^2}\right)\left(3bv-b\right)=&amp;\frac{8a}{27b}t\\
\Rightarrow\left(p+\frac{3}{v^2}\right)\left(v-\frac{1}{3}\right)=&amp;\frac{8}{3}t
\end{align*}\]</span></p>
<p>This expression for the equation of state in terms of reduced variables is useful because reference to the system specific parameters <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> has vanished. In this form the equation is therefore universal.</p>
<p>Plotting <span class="math inline">\(P/P_c\)</span> vs <span class="math inline">\(V/V_c\)</span> for isotherms (values of <span class="math inline">\(t\)</span>) and focussing on the region close to the critical point, one finds</p>
<div id="fig-vdWisotherm" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-vdWisotherm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figs/vdw_isotherms.png" class="img-fluid figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-vdWisotherm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Isotherms of <span class="math inline">\(p\)</span> versus <span class="math inline">\(v\)</span> for various <span class="math inline">\(t\)</span> spanning the critical temperatures
</figcaption>
</figure>
</div>
<div id="fig-vdWderivs" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-vdWderivs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Figs/vdw_derivatives.png" class="img-fluid figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-vdWderivs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: (a) <span class="math inline">\(\frac{\partial p}{\partial v}\)</span> for <span class="math inline">\(T=T_c\)</span>. (b) <span class="math inline">\(\frac{\partial^2 p}{\partial v^2}\)</span> for <span class="math inline">\(T=T_c\)</span>.
</figcaption>
</figure>
</div>
<p>Plotting <span class="math inline">\((\frac{\partial p}{\partial v})_{t=1}\)</span> and <span class="math inline">\((\frac{\partial^2 p}{\partial v^2})_{t=1}\)</span>, we see that there is indeed a point of inflexion on the critical isotherm, at <span class="math inline">\(v=1\)</span>, this is the critical point (ie. a continuous phase transition), <a href="#fig-vdWderivs" class="quarto-xref">Figure&nbsp;<span>3</span></a> .</p>
<p>Subcritical isotherms (first order phase transition) exhibit a so called van-der Waals loop.</p>
<p>To find the compressibility critical exponent <span class="math inline">\(\gamma\)</span>, we recall that</p>
<p><span class="math display">\[
\kappa_T=\frac{-1}{V}\left(\frac{\partial V}{\partial P}\right)_T=\frac{-1}{p_cv}\left(\frac{\partial v}{\partial p}\right)_t\propto \tilde{t}^{-\gamma}
\]</span> with <span class="math inline">\(\tilde{t}=(T-T_c)/T_c\)</span> small.</p>
<p>Now from the reduced equation of state</p>
<p><span class="math display">\[
\frac{\partial p}{\partial v}=\frac{-8t}{3(v-1/3)^2}+\frac{6}{v^3}
\]</span> setting <span class="math inline">\(t=\tilde{t}+1\)</span> and <span class="math inline">\(v=1\)</span> gives <span class="math inline">\(\frac{\partial p}{\partial v} =-6\tilde{t}\)</span>, ie the compressibility diverges</p>
<p><span class="math display">\[
\kappa_T\propto \tilde{t}^{-1}
\]</span> ie. <span class="math inline">\(\gamma=1\)</span>, which is the same as the mean field result which we derived in another context of the magnetic susceptibility.</p>
<hr>
</section>
<section id="mean-field-theory-of-the-ising-model-heat-capacity" class="level3">
<h3 class="anchored" data-anchor-id="mean-field-theory-of-the-ising-model-heat-capacity">4. Mean field theory of the Ising model heat capacity</h3>
<p>We insert into the expression for the mean Ising energy</p>
<p><span class="math display">\[
\langle E \rangle =-J\sum_{&lt;i,j&gt;}\langle s_is_j\rangle\:,
\]</span> the simplest mean field approximation <span class="math inline">\(\langle s_is_j\rangle=\langle s_i\rangle\langle s_j\rangle=m^2\)</span>. Recalling the behaviour of the order parameter for small <span class="math inline">\(t\)</span>, that the number of bonds <span class="math inline">\(=qN/2\)</span>, and the mean field value of <span class="math inline">\(T_c=qJ/k_B\)</span>, we have for <span class="math inline">\(T&lt;T_c\)</span></p>
<p><span class="math display">\[\begin{align*}
\langle E \rangle =&amp; \frac{-NqJm^2}{2}\\
\:                =&amp; \frac{3NqJt}{2}\\
\:                =&amp; \frac{3Nk_B(T-T_c)}{2}
\end{align*}\]</span> while <span class="math inline">\(\langle E \rangle= \textrm{ constant}\)</span> for <span class="math inline">\(T&gt;T_c\)</span>.</p>
<p>Hence differentiating, we find <span class="math display">\[\begin{align*}
C_H= 0; &amp;\quad T&gt;T_c\\
C_H= 3Nk_B/2; &amp; \quad T\le T_c
\end{align*}\]</span></p>
<p>This independence of the heat capacity on <span class="math inline">\(t\)</span> corresponds to a critical exponent <span class="math inline">\(\alpha=0\)</span></p>
<hr>
</section>
<section id="magnetisation-and-fluctuations" class="level3">
<h3 class="anchored" data-anchor-id="magnetisation-and-fluctuations">5. Magnetisation and fluctuations</h3>
<p>The free energy is</p>
<p><span class="math display">\[
F=-k_BT\ln Z
\]</span> with the partition function</p>
<p><span class="math display">\[
Z=\sum_{{s}}\exp[-(E-hM)/k_BT]
\]</span></p>
<p>Thus <span class="math display">\[\begin{align*}
-\left(\frac{\partial F}{\partial h}\right)_T =&amp; k_BT\frac{1}{Z}\left(\frac{\partial Z}{\partial h}\right)_T\\
\: =&amp;\frac{1}{Z}\sum_{{s}}M \exp[-(E-hM)/k_BT]\\
   =&amp; \langle M\rangle
\end{align*}\]</span> where we have used the definition of the average of an observable given in lectures.</p>
<p>Now</p>
<p><span class="math display">\[\begin{align*}
\left(\frac{\partial^2 F}{\partial h^2}\right)_T =&amp; -k_BT\left[\frac{1}{Z}\left(\frac{\partial^2 Z}{\partial h^2}\right)_T-\left(\frac{\partial Z}{\partial h}\right)_T\frac{1}{Z^2}\left(\frac{\partial Z}{\partial h}\right)_T\right]\\
\: =&amp;\frac{-1}{k_BT}\left[\frac{1}{Z}\sum_{{s}}M^2 \exp[-(E-hM)/k_BT]-\langle M\rangle^2\right]\\
\:  =&amp; \frac{-1}{k_BT}\left[\langle M^2\rangle-\langle M\rangle^2\right]
\end{align*}\]</span></p>
<p>You should recognise the terms in square brackets as the variance of the magnetisation distribution.</p>
<p>Thus the susceptibility is <span class="math display">\[
\chi_H\equiv\frac{\partial \langle M\rangle}{\partial h}=\frac{1}{k_BT}\left[\langle M^2\rangle-\langle M\rangle^2\right]
\]</span></p>
<p>Incidently, this is known as the fluctuation-dissipation theorem. It is a neat result, because it allows you to calculate the response to a perturbation from equilibrium, without actually perturbing the system! Instead one merely looks at the form of the equilibrium fluctuations. It is used extensively in computer simulations.</p>
<hr>
</section>
<section id="spin-1-ising-model" class="level3">
<h3 class="anchored" data-anchor-id="spin-1-ising-model">6. Spin-1 Ising model</h3>
<p>As in lectures, the mean field Hamiltonian for a single spin is</p>
<p><span class="math display">\[
{\cal H}(s_0)=-s_0\left(qJm + h\right)+NqJm^2/2
\]</span> where here <span class="math inline">\(h\)</span> is the magnetic field.</p>
<p>The probability of finding this spin with value <span class="math inline">\(s_0\)</span> is <span class="math display">\[\begin{align*}
p(s_0) =&amp; \frac{e^{-\beta{\cal H}(s_0)}} {\sum_{s_0=0,\pm 1}e^{-\beta{\cal H}(s_0)}}\\
=&amp;\frac{e^{\beta s_0(qJm+h)}}{1+e^{\beta(qJm+h)}+e^{-\beta(qJm+h)}}
\end{align*}\]</span></p>
<p>Now for consistency <span class="math inline">\(\langle s_0\rangle=m\)</span>, so <span class="math display">\[\begin{align*}
m =&amp; \sum_{s_0=0,\pm 1}s_0p(s_0)\\
\:=&amp; \frac{0+e^{\beta(qJm+h)}-e^{\beta(qJm+h)}} {e^0+e^{\beta(qJm+h)}+e^{-\beta(qJm+h)}}\\
\:=&amp;  \frac{2\sinh[\beta(Jqm+h)]}{1+2\cosh[\beta(Jqm+h)]}
\end{align*}\]</span> To get the critical temperature, we can solve this graphically. One plots the RHS as a function of <span class="math inline">\(m\)</span>, for various <span class="math inline">\(\beta\)</span>. On the same graph one plots the curve <span class="math inline">\(y=m\)</span> (representing the LHS). <span class="math inline">\(T_c\)</span> is the highest <span class="math inline">\(T\)</span> for which the two curves intersect.</p>
<p>Alternatively to get <span class="math inline">\(T_c\)</span> analytically, set <span class="math inline">\(h=0\)</span> and expand for small <span class="math inline">\(m\)</span> (i.e.&nbsp;small <span class="math inline">\(x=\beta J q m\)</span>), we have <span class="math display">\[
m \approx \frac{2(\beta J q m)}{1+2} = \frac{2}{3}\,\beta J q\, m .
\]</span> (I would advise looking up the expansions of <span class="math inline">\(\sinh(x)\)</span> and <span class="math inline">\(\cosh(x)\)</span> to see how this is obtained.)</p>
<p>Now, a nonzero solution appears when the prefactor equals <span class="math inline">\(1\)</span>, i.e.&nbsp;when <span class="math inline">\(m=m\)</span>. Thus <span class="math display">\[
1 = \frac{2}{3}\,\beta_c J q
\quad \Rightarrow \quad
\beta_c = \frac{3}{2Jq}.
\]</span></p>
<p>Hence the critical temperature is <span class="math display">\[
k_B T_c = \frac{2}{3}\, J q .
\]</span></p>
<hr>
</section>
<section id="transfer-matrix" class="level3">
<h3 class="anchored" data-anchor-id="transfer-matrix">7. Transfer Matrix</h3>
<p>The transfer matrix is a list of the possible interactions of a pair of spins with one another and with a magnetic field. For a 1d spin-1/2 system it takes the form: <span class="math display">\[
\mathbf{V}(H)=\begin{bmatrix}
e^{\beta(J+H)} &amp; e^{-\beta J} \\
e^{-\beta J}   &amp; e^{\beta(J-H)}
\end{bmatrix}
\]</span> We need to find the eigenvalues, so we solve the characteristic equation det(<span class="math inline">\(\mathbf{V}-\lambda \mathbf{I})=0\)</span>, i.e.</p>
<p><span class="math display">\[
\mathbf{V}(H)=\begin{vmatrix}
e^{\beta(J+H)} -\lambda &amp; e^{-\beta J} \\
e^{-\beta J}   &amp; e^{\beta(J-H)}-\lambda
\end{vmatrix} =0
\]</span></p>
<p>Then <span class="math inline">\(\lambda^2-(a+d)\lambda+(ad-bc)=0\)</span>. So</p>
<p><span class="math display">\[\begin{align*}
\lambda_\pm =&amp; \frac{a+d\pm\sqrt{(a+d)^2-4(ad-bc)}}{2}\\
\lambda_{\pm} =&amp; e^{\beta J}\cosh(\beta H) \pm \frac{1}{2}\sqrt{e^{2\beta J}4\cosh^2\beta H-4(e^{2\beta J}-e^{-2\beta J})}\\
\lambda_{\pm} =&amp; e^{\beta J}\cosh(\beta H) \pm \sqrt{e^{2\beta J}\sinh^2\beta H+e^{-2\beta J}}.
\end{align*}\]</span></p>
<p>(You’ll need the identity <span class="math inline">\(\cosh^2 x-\sinh^2 x = 1\)</span>).</p>
<p>From lectures, you should know that the partition function</p>
<p><span class="math display">\[\begin{align}
Z=\textrm{Tr}(\mathbf{V}^N)=&amp;\lambda_+^N+\lambda_-^N\\
\approx &amp; \lambda_+^N \hspace{5mm}\textrm{N~large}
\end{align}\]</span></p>
<p>where <span class="math inline">\(\lambda_+\)</span> is the largest of the two evals.</p>
<p>Hence the free energy <span class="math inline">\(F=-k_BT\ln(Z)\)</span> can be written</p>
<p><span class="math display">\[
F=-Nk_BT\ln \left[e^{\beta J}\cosh(\beta H) + \sqrt{e^{2\beta J}\sinh^2\beta H+e^{-2\beta J}}\right].
\]</span></p>
<p>Now the magnetisation per site is</p>
<p><span class="math display">\[
m=-\frac{1}{N}\frac{\partial F}{\partial H}=\frac{k_BT}{\lambda_+}\frac{\partial \lambda_+}{\partial H}
\]</span></p>
<p>You can either be a hero here, or use a symbolic solution program like Maple or Wolfram Alpha. I did the latter to find the stated result.</p>
<p><span class="math display">\[
m=\frac{\sinh \beta H}{\sqrt{\sinh^2\beta H+\exp{(-4\beta J)}}}
\]</span></p>
<p>Hence at zero <span class="math inline">\(H\)</span>, there is no spontaneous magnetisation at any <span class="math inline">\(T\)</span>.</p>
<hr>
</section>
<section id="landau-theory" class="level3">
<h3 class="anchored" data-anchor-id="landau-theory">8. Landau theory</h3>
<p>If this were an Ising model problem (ie a microscopic model) we could write down the partition function, get an explicit expression for the free energy and differentiate once (wrt <span class="math inline">\(T\)</span>) to get the energy and again (wrt <span class="math inline">\(T\)</span>) to get the heat capacity. But the starting point for Landau theory is the free energy itself, so we need another starting point, namely thermodynamics. The appropriate thermodynamic potential for the magnet is <span class="math inline">\(F=E-TS-MH\)</span> with <span class="math inline">\(E\)</span> the internal energy. Then <span class="math display">\[
\begin{align*}
dF =&amp; dE-TdS-SdT-MdH-HdM\\
\: =&amp; TdS+HdM-TdS-SdT-MdH-HdM\\
\: =&amp; -SdT-MdH
\end{align*}
\]</span> where we have used the first law for a magnet <span class="math inline">\(dE=TdS+HdM\)</span>.</p>
<p>Thus</p>
<p><span class="math display">\[\begin{align*}
\left(\frac{\partial F}{\partial T}\right)_H =&amp; -S\\
-T\left(\frac{\partial^2 F}{\partial T^2}\right)_H =&amp;T\frac{dS}{dT}=\frac{dQ}{dT}\\ C_H=-T\left(\frac{\partial^2 F}{\partial T^2}\right)_H
\end{align*}\]</span></p>
<p>where <span class="math inline">\(C_H\)</span> is the specific heat at constant field and we have used the fact that <span class="math inline">\(dS=dQ/T\)</span>.</p>
<p>Now from lectures, the equilibrium magnetisation in the Landau free energy is given by</p>
<p><span class="math display">\[
m^2=\frac{-a_2}{2a_4}
\]</span> for <span class="math inline">\(T&lt;T_c\)</span> and zero otherwise. Substituting this into the Landau free energy <span class="math inline">\(F=F_0+a_2m^2+a_4m^4\)</span> gives</p>
<p><span class="math display">\[\begin{align*}
F = F_0 &amp; \quad T&gt;T_c\\
F = -a_2^2/4a_4 &amp; \quad T &lt; T_c
\end{align*}\]</span></p>
<p>Using the fact that <span class="math inline">\(a_2=\tilde{a_2} t\)</span>, with <span class="math inline">\(t=(T-T_c)/T_c\)</span> and differentiating wrt <span class="math inline">\(T\)</span> twice, to get the heat capacity, we find</p>
<p><span class="math display">\[\begin{align*}
C_H =  0; &amp; \quad T\to T_c^+\\
C_H = \frac{T\tilde a_2^2}{2a_4T_c^2}; &amp; \quad T \to T_c^-\:,
\end{align*}\]</span> The jump discontinuity rather that a divergence in the specific heat at <span class="math inline">\(T=T_c\)</span> formally corresponds to a critical exponent <span class="math inline">\(\alpha=0\)</span>.</p>
<p>To get the susceptibility exponent, we add a magnetic field to the free energy</p>
<p><span class="math display">\[
F(m)=F_0+a_2m^2+a_4m^4-Hm
\]</span></p>
<p>Then the equilibrium magnetisation satisfies</p>
<p><span class="math display">\[\begin{align*}
\frac{dF}{dm} =&amp;2\tilde{a_2} tm+4a_4m^3-H=0\\
\Rightarrow H =&amp;2\tilde{a_2} tm+4a_4m^3\\
\Rightarrow \left(\frac{\partial H}{\partial m}\right )_T =&amp;2\tilde{a_2} t+12a_4m^2
\end{align*}\]</span> Now using the results that <span class="math inline">\(m^2=0\)</span> for <span class="math inline">\(t&gt;0\)</span> and <span class="math inline">\(m^2=-\tilde{a_2}t/(2a_4)\)</span> for <span class="math inline">\(t&lt;0\)</span>, we have that in both cases</p>
<p><span class="math display">\[
\left(\frac{\partial H}{\partial m}\right )_T\propto t
\]</span></p>
<p>Hence</p>
<p><span class="math display">\[
\left(\frac{\partial m}{\partial H}\right )_T\propto t^{-1}
\]</span> so <span class="math inline">\(\gamma=1\)</span>.</p>
<hr>
</section>
<section id="scaling-equation-of-state" class="level3">
<h3 class="anchored" data-anchor-id="scaling-equation-of-state">9. Scaling equation of state</h3>
<p>The equilibrium state corresponds to the minimum of the free energy <span class="math inline">\(\partial F/\partial M=0\)</span>. This gives the equation of state</p>
<p><span class="math display">\[
H=2\tilde{a_2}tm+4a_4m^3
\]</span> (Note that we ignore the solution <span class="math inline">\(H=m=0\)</span> which corresponds to a maximum of the free energy.)</p>
<p>The near critical power law scaling of the magnetisation is <span class="math inline">\(m\propto t^\beta\)</span> and <span class="math inline">\(m\propto H^{1/\delta}\)</span>. To find a scaling form for the equation of state we need to transform to scaled variables <span class="math inline">\(H/m^\delta\)</span> and <span class="math inline">\(t/m^{1/\beta}\)</span>. We can get a scaling equation in terms of these variables by dividing through the equation of state by <span class="math inline">\(m^3\)</span>, so that</p>
<p><span class="math display">\[
\frac{H}{m^{3}}=\frac{2\tilde{a_2}t}{m^2}+4a_4
\]</span></p>
<p>Hence <span class="math inline">\(\delta=3\)</span> and <span class="math inline">\(\beta=1/2\)</span>.</p>
<p>The choice of scale <span class="math inline">\(a_4=1/4\)</span> and <span class="math inline">\(\tilde{a_2}=1/2\)</span> yields the given form of the scaling function.</p>
<hr>
</section>
<section id="scaling-laws" class="level3">
<h3 class="anchored" data-anchor-id="scaling-laws">10. Scaling laws</h3>
<p>First of all recall the definition of the critical exponents: <span class="math display">\[\begin{align*}
m       \propto  t^{\beta};&amp; \quad (h=0) \\
\chi_T  \propto  t^{-\gamma};&amp;\quad (h=0) \\
C_H  \propto  t^{-\alpha};&amp; \quad (h=0) \\
m  \propto  h^{1/\delta}.&amp; \quad (t=0) \\
\end{align*}\]</span></p>
<p>The free energy in generalised homogeneous form is</p>
<p><span class="math display">\[
F(\lambda^a t,\lambda^b h)=\lambda F(t,h)
\]</span></p>
<p>The first of the scaling relations to be derived was covered in lectures: Let <span class="math inline">\(\lambda^a=1/t\)</span>, so that <span class="math inline">\(\lambda=t^{-1/a}\)</span>. Then</p>
<p><span class="math display">\[\begin{align*}
F(t,h)=&amp;t^{1/a}F(1,t^{-b/a}h)\\
m(t,h)=&amp;-\left(\frac{\partial F}{\partial h}\right)_t= -t^{(1-b)/a} \left.\frac{\partial F(1,y)}{\partial y}\right|_{ht^{-b/a}}=t^{(1-b)/a}m(1,ht^{-b/a})
\end{align*}\]</span></p>
<p>so when <span class="math inline">\(h=0\)</span>, we have <span class="math inline">\(m(1,t^{-b/a}h)=m(1,0)=\textrm{ const}\)</span> and hence we can identify <span class="math inline">\(\boxed{\beta=(1-b)/a}\)</span>.</p>
<p>We also have for the isothermal susceptibility</p>
<p><span class="math display">\[
\chi=\left(\frac{\partial m}{\partial h}\right)_t=-t^{(1-2b)/a}\left.\frac{\partial^2 F(1,y)}{\partial y^2}\right|_{ht^{-b/a}},
\]</span> so taking again <span class="math inline">\(h=0\)</span>, we find <span class="math inline">\(\boxed{\gamma=(2b-1)/a}\)</span>.</p>
<p>For the specific heat at constant (zero) field, we have the definition: <span class="math display">\[
C_H = \left(\frac{\partial E}{\partial T}\right)_{h=0}=-T\left(\frac{\partial^2F}{\partial T^2}\right)_{h=0}\:,
\]</span> where in the last step have used <span class="math inline">\(E=-\partial (\beta F)/\partial\beta\)</span>, with <span class="math inline">\(\beta=(k_BT)^{-1}\)</span> (see fig 2.1 in notes). Alternatively one can use the thermodynamic derivation of this relation given in an earlier problem on Landau theory. Transforming from <span class="math inline">\(T\)</span> to <span class="math inline">\(t=(T-T_c)/T_c\)</span> and inserting the generalised homogeneous form for <span class="math inline">\(F\)</span> gives:</p>
<p><span class="math display">\[\begin{align*}
C_H =&amp; -\frac{T}{T_c^2}\frac{\partial^2}{\partial t^2}[t^{1/a}F(1,t^{-b/a}h)]\\
C_H \approx&amp; -\frac{1}{T_c}\frac{\partial^2}{\partial t^2}[t^{1/a}F(1,t^{-b/a}h)]\\
C_H =&amp; -\frac{1}{T_c}\frac{1}{a}(\frac{1}{a}-1)t^{(1/a-2)}F(1,0)
\end{align*}\]</span> Here we have neglected all derivatives of <span class="math inline">\(F\)</span> since they are multiplied by at least one power of <span class="math inline">\(h\)</span> which is zero. Hence <span class="math inline">\(\boxed{\alpha=2-1/a}\)</span>.</p>
<p>Finally, if we let <span class="math inline">\(\lambda^b=1/h\)</span>, so that <span class="math inline">\(\lambda=h^{-1/b}\)</span> and consider the critical isotherm <span class="math inline">\(t=0\)</span>. Then</p>
<p><span class="math display">\[\begin{align*}
F(t,h)=&amp;h^{1/b}F(h^{-a/b}t,1)\\
\Rightarrow m(t,h)=&amp; \frac{ta}{b}h^{(1-a-b)/b}\left.\frac{\partial F(x,1)}{\partial x}\right|_{h^{-a/b}t}-\frac{1}{b}h^{1/b-1}F(h^{-a/b}t,1).
\end{align*}\]</span> so when <span class="math inline">\(t=0\)</span>, we get <span class="math inline">\(m(0,h)\)</span> and can identify <span class="math inline">\(\boxed{\delta=b/(1-b)}\)</span>.</p>
<p>To derive the relationships (``scaling laws’’) among the critical exponents, we eliminate <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> from the boxed scaling relations. Setting <span class="math inline">\(a=(2-\alpha)^{-1}\)</span> in the first scaling relation, we find <span class="math inline">\(b=1-\beta/(2-\alpha)\)</span>. Substituting this into the second scaling relation gives the second of the two scaling laws quoted in the notes. Substituting into the 4th scaling relation gives the first scaling law.</p>


<script type="ojs-module-contents">
eyJjb250ZW50cyI6W119
</script>
<div id="exercise-loading-indicator" class="exercise-loading-indicator d-none d-flex align-items-center gap-2">
<div id="exercise-loading-status" class="d-flex gap-2">

</div>
<div class="spinner-grow spinner-grow-sm">

</div>
</div>
<script type="vfs-file">
W10=
</script>
</section>

</main> <!-- /main -->
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W119
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../phase-transitions";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="../index.pdf" class="pagination-link" aria-label="Notes as pdf">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Notes as pdf</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->




</body></html>