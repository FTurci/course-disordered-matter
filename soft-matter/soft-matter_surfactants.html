<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>18&nbsp; Surfactants</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../soft-matter/soft-matter_glasses.html" rel="next">
<link href="../soft-matter/soft-matter_liquidcrystals.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-f9e9f27e2f64dd25e94c2742b294698a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/live-runtime/live-runtime.js" type="module"></script>
<link href="../site_libs/quarto-contrib/live-runtime/live-runtime.css" rel="stylesheet">
<script src="../site_libs/quarto-contrib/molstar-v3.13.0/molstar.js"></script>
<link href="../site_libs/quarto-contrib/molstar-v3.13.0/molstar.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/molstar-v3.13.0/app-container.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="module" src="../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../soft-matter/soft-matter_intro.html">Complex disordered systems</a></li><li class="breadcrumb-item"><a href="../soft-matter/soft-matter_surfactants.html"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Surfactants</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../courselogo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reading.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Recommended texts</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Unifying concepts</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to phase behaviour</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/background.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Background concepts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/approach-to-criticality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The approach to criticality</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/Ising-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">The Ising model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/mean-field-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Mean field theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/lattice-gas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">The lattice gas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/scaling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">The static scaling hypothesis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/rg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Universality and renormalization group theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/rg-effective-coupling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">RG- the effective coupling viewpoint</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/nucleation-and-growth.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Nucleation, growth and spinodal decomposition</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/master-equation-and-diffusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Introduction to stochastic processes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/Brownian-and-Langevin-dynamics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Brownian and Langevin dynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/dynamics-of-fluctuations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Dynamics of fluctuations (non-examinable)</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Complex disordered systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../soft-matter/soft-matter_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Entropy matters</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../soft-matter/soft-matter_colloids.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Colloids</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../soft-matter/soft-matter_polymers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Polymers</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../soft-matter/soft-matter_liquidcrystals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Liquid crystals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../soft-matter/soft-matter_surfactants.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Surfactants</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../soft-matter/soft-matter_glasses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Arrested states</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../soft-matter/soft-matter_active.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Active matter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../soft-matter/soft-matter_problems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Problems</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Experimental techniques</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../revision_guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Revision guide</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/concepts_map.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Concept maps</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#hydrophobicity-and-amphiphiles" id="toc-hydrophobicity-and-amphiphiles" class="nav-link active" data-scroll-target="#hydrophobicity-and-amphiphiles"><span class="header-section-number">18.1</span> Hydrophobicity and amphiphiles</a>
  <ul>
  <li><a href="#sds-dodecyl-sulfate" id="toc-sds-dodecyl-sulfate" class="nav-link" data-scroll-target="#sds-dodecyl-sulfate">SDS (dodecyl sulfate)</a></li>
  <li><a href="#cholesterol" id="toc-cholesterol" class="nav-link" data-scroll-target="#cholesterol">Cholesterol</a></li>
  </ul></li>
  <li><a href="#self-assembled-structures" id="toc-self-assembled-structures" class="nav-link" data-scroll-target="#self-assembled-structures"><span class="header-section-number">18.2</span> Self-assembled structures</a>
  <ul>
  <li><a href="#aggregation-general-case" id="toc-aggregation-general-case" class="nav-link" data-scroll-target="#aggregation-general-case"><span class="header-section-number">18.2.1</span> Aggregation: general case</a></li>
  <li><a href="#aggregation-the-surfactant-case" id="toc-aggregation-the-surfactant-case" class="nav-link" data-scroll-target="#aggregation-the-surfactant-case"><span class="header-section-number">18.2.2</span> Aggregation: the surfactant case</a></li>
  <li><a href="#shape-of-surfactant-assemblies" id="toc-shape-of-surfactant-assemblies" class="nav-link" data-scroll-target="#shape-of-surfactant-assemblies"><span class="header-section-number">18.2.3</span> Shape of surfactant assemblies</a></li>
  </ul></li>
  <li><a href="#a-simple-on-lattice-model-for-micelle-formation" id="toc-a-simple-on-lattice-model-for-micelle-formation" class="nav-link" data-scroll-target="#a-simple-on-lattice-model-for-micelle-formation"><span class="header-section-number">18.3</span> A simple on-lattice model for micelle formation</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../soft-matter/soft-matter_intro.html">Complex disordered systems</a></li><li class="breadcrumb-item"><a href="../soft-matter/soft-matter_surfactants.html"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Surfactants</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Surfactants</span></h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<div>
<div id="pyodide-1" class="exercise-cell">

</div>
<script type="pyodide-1-contents">
eyJhdHRyIjp7ImF1dG9ydW4iOnRydWUsImVjaG8iOmZhbHNlLCJlZGl0IjpmYWxzZSwiZXZhbCI6dHJ1ZX0sImNvZGUiOiIjIG1vZGlmeWluZyB0aGUgcGF0aCB0byBhZGQgdGhlIGNvZGUgZm9sZGVyXG5pbXBvcnQgc3lzXG5zeXMucGF0aC5pbnNlcnQoMCwgJ3NyYycpIn0=
</script>
</div>
<section id="hydrophobicity-and-amphiphiles" class="level2" data-number="18.1">
<h2 data-number="18.1" class="anchored" data-anchor-id="hydrophobicity-and-amphiphiles"><span class="header-section-number">18.1</span> Hydrophobicity and amphiphiles</h2>
<p>The hydrophobic interaction between solutes is a statistical force mediated by water (the solvent). Traditional explanations focus on the role played by hydrogen bonds (an attractive interaction due to the difference in electronegativity between oxygen and hydrogen in water) and the structure of water around solutes.</p>
<p><strong>Polar</strong> molecules have regions with partial positive and negative charges due to differences in electronegativity between atoms, resulting in an uneven distribution of electrons. This allows them to interact strongly with water (hydrophilic) and other polar substances.</p>
<p><strong>Apolar</strong> (or nonpolar) molecules, instead, have a more even distribution of electrical charge, lacking distinct poles. They do not mix well with water and tend to aggregate with other nonpolar substances.</p>
<p>In this chapter we discuss the behaviour of a special class of molecules. In these molecules one end contains a <em>hydrophilic</em> (literally, <em>water-loving</em>) part, while the other end is <em>hydrophobic</em> (<em>water-fearing</em>). For their nature, they are called <strong>amphiphilic</strong> (loving both) molecules, which reflects their structure, or <strong>surfactants</strong> (from <em>SURFace ACTive AgeNT</em>), which refers to their behaviour in solution.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./figs/amphiphile.svg" class="img-fluid figure-img"></p>
<figcaption>Schematic model of a surfactant (<a href="https://phys.libretexts.org/Courses/University_of_California_Davis/Biophysics_241%3A_Membrane_Biology/04%3A_Membrane-Protein_Interactions/4.06%3A_Non-Membrane_Lipid_Assemblies">adapted</a>).</figcaption>
</figure>
</div>
<p>For very small solutes (a few atoms) the traditional picture of hydro-phobicity/philicity is that the energetic advantage due to hydrogen bonding favors configurations that minimally disrupt the local structure of water, and this means that multiple apolar solutes tend to come together to minimise such disruption since they cannot form such bonds. However, for larger molecules (such as large proteins or longer macromolecular chains) interfaces between the bulk water and the solutes are formed, to which we can associate characteristic density fluctuations and surface tensions. Phase separation between a local vapor-like layer and the bulk water becomes then important and aggregation due to hydrophobicty becomes very much a a many-body effect. This is an active topic of current research (even by some of us, see <span class="citation" data-cites="wildingturciPRR2025">Wilding and Turci (<a href="#ref-wildingturciPRR2025" role="doc-biblioref">2025</a>)</span> ) and demonstrates how even very foundational concepts in soft matter remain to be explored.</p>
<p>In the rest of the chapter, we will look mostly phenomenologically at the structure of surfactants and how they collectively come together to form meso-scale structures via the process of <strong>self-assembly</strong>, and assume that there exist solvent-mediated interactions such as hydrophobicity that control the free energies of these assemblies.</p>
<p>A few chemical structures are shown below. They illustrates that the hydrophobic tail usually consits of hydrocarbon chains of different lengths</p>
<section id="sds-dodecyl-sulfate" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="sds-dodecyl-sulfate">SDS (dodecyl sulfate)</h4>
<p>In SDS (sodium dodecyl sulfate) the head is the hydrophilic sulfate group (<span class="math inline">\({\rm –OSO_3}\)</span>), which is negatively charged and water-attracting whil the tail is the long hydrophobic 12-carbon alkyl chain (dodecyl group), which is water-repelling.</p>
<p>    </p><div id="app-./figs/SDS.pdb" class="molstar-app"></div>
    <script type="text/javascript">
    molstar.Viewer.create("app-./figs/SDS.pdb", {"emdbProvider":"rcsb","layoutIsExpanded":false,"layoutShowControls":false,"layoutShowLeftPanel":true,"layoutShowLog":false,"layoutShowRemoteState":false,"layoutShowSequence":false,"pdbProvider":"rcsb","viewportShowAnimation":true,"viewportShowExpand":true,"viewportShowSelectionMode":false}).then(viewer => {
    viewer.loadStructureFromUrl("./figs/SDS.pdb", format="pdb");    });
    </script>
     <!--  --><p></p>
</section>
<section id="cholesterol" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="cholesterol">Cholesterol</h4>
<p>In cholesterol the head is the small polar hydroxyl (-OH) group and the tail is the nonpolar hydrocarbon isooctyl side chain at the opposite end.</p>
    <div id="app-./figs/cholesterol.pdb" class="molstar-app"></div>
    <script type="text/javascript">
    molstar.Viewer.create("app-./figs/cholesterol.pdb", {"emdbProvider":"rcsb","layoutIsExpanded":false,"layoutShowControls":false,"layoutShowLeftPanel":true,"layoutShowLog":false,"layoutShowRemoteState":false,"layoutShowSequence":false,"pdbProvider":"rcsb","viewportShowAnimation":true,"viewportShowExpand":true,"viewportShowSelectionMode":false}).then(viewer => {
    viewer.loadStructureFromUrl("./figs/cholesterol.pdb", format="pdb");    });
    </script>
    
<p>In general, the hydrophilic head might either be positively or negatively charged, zwitterionic (with both charges but overall neutral) or uncharged.</p>
<p>The hydrocarbon chains are insoluble in water. The molecules are thus preferentially located at the surface, which allows the hydrophilic head to be surrounded by water and the hydrophobic chains to avoid contact with water. There is always an equilibrium between surfactants at the surface and in the bulk of the solution. The coverage of the surface leads to a reduction of the surface tension with increasing surfactant concentration.</p>
</section>
</section>
<section id="self-assembled-structures" class="level2" data-number="18.2">
<h2 data-number="18.2" class="anchored" data-anchor-id="self-assembled-structures"><span class="header-section-number">18.2</span> Self-assembled structures</h2>
<p><strong>Self-assembly</strong> is a fundamental property of surfactant molecules in solution. It also a highlight feature of soft-matter systems: under the influence of thermal fluctuations (typically mediated by a solvent), the constituents of soft matter systems self-organise into more complex, meso or macroscopic structures. This is typically due to driving thermodynamic forces that make initially unform systems find (local ord global) minima of their free energy which distinctive structural features. In this sense, soft matter systems explore <strong>free energy landscapes</strong> whose complexity is tuned by the strength of thermal fluctuations.</p>
<p>In many ways, we have already seen various forms of self assembly: crystallisation of colloids is itself self-organised but so is also the phase transition between the gasous and the liquid phase, or the isotropic-nematic transition in liquid crystals.</p>
<p>Full phase separation, though, is much more demanding than self assembly: in full phase separation we eventually attain the (global) free energy minimum corresponding to the equilibrium state prescribed by the chosen thermodynamic variables (e.g.&nbsp;temperature and pressure). The notion of self assembly emphasises instead the propensity of the constituents to aggregate, to form structures at intermediate scales, structures which can often be only very <strong>locally stable</strong>, and whose existence may rely not only on the structure of the energy landscape but also on the <strong>kinetics</strong> of the constituents, such as their diffusion mechanism.</p>
In the case of surfactants, we need to consider that these molecules are often very small—typically just a few nanometers in length. This small size means that thermal fluctuations play a significant role in their behavior, and their assembly is rapid due to their fast diffusion. For example, for an approximately spherical surfactant of size <span class="math inline">\(R\)</span> in a viscous medium its diffusivity is given by the Stokes-Einstein relation (see )
<div style="border: 2px solid red; padding: 1em; border-radius: 8px; background-color: transparent;">
<p><span class="math display">\[
D = \frac{k_B T}{6\pi \eta R}
\]</span></p>
</div>
<p>where <span class="math inline">\(D\)</span> is the diffusion coefficient, <span class="math inline">\(k_B\)</span> is Boltzmann’s constant, <span class="math inline">\(T\)</span> is temperature, <span class="math inline">\(\eta\)</span> is the viscosity of the solvent, and <span class="math inline">\(R\)</span> is the radius of the particle. Compared to a colloidal particle of <span class="math inline">\(2 {\rm \mu m}\)</span>, a single SDS surfactant molecule of approximately <span class="math inline">\(2 {\rm nm}\)</span> in size will be approximately 1000 times faster.</p>
<p>This leads to fast local equilibration and constant exchange between monomers and aggregates. As a result, the structures formed by surfactants are not static but exist in a dynamic equilibrium, with lifetimes and sizes that depend sensitively on temperature, concentration, and solvent conditions.</p>
<p>Due to their amphiphilic nature, surfactants spontaneously organise into ordered structures without external guidance, but driven by forces such as hydrophobicity, described above.</p>
<p>As a result, surfactants minimize the system’s free energy by forming a variety of aggregates such as <strong>micelles</strong>, <strong>vesicles</strong>, or bilayers. The specific structure formed depends on the molecular geometry of the surfactant and the solution conditions. Self-assembly is in many cases reversible and fundamentally dynamic process, with aggregates constantly forming and dissociating in equilibrium with monomers in solution.</p>
<!-- ![](https://cdn.mathpix.com/cropped/2025_01_27_a9af280ad9752fe3d0c0g-32.jpg?height=464&width=816&top_left_y=542&top_left_x=243) -->
<section id="aggregation-general-case" class="level3" data-number="18.2.1">
<h3 data-number="18.2.1" class="anchored" data-anchor-id="aggregation-general-case"><span class="header-section-number">18.2.1</span> Aggregation: general case</h3>
<p>Suppose we have a system where solvent particles are dispersed in a solvent and tend to aggregate due to their mutual interactions. Suppose that we know the quantity <span class="math inline">\(\epsilon_n\)</span> representing the free energy change when a specific particle is taken from the bulk and added to an aggregate of size <span class="math inline">\(N\)</span>.</p>
<p>Call $_1 $ and <span class="math inline">\(\mu_N\)</span> the chemical potential of isolated particles and aggregates of size <span class="math inline">\(N\)</span> respectively. In equilibrium, they must be equal, with value <span class="math inline">\(\mu\)</span>.</p>
<p>Let’s focus on an aggregate of size <span class="math inline">\(N\)</span>. We can express <span class="math inline">\(\mu\)</span> in terms of</p>
<ul>
<li>the interaction energy from being in the aggregate (<span class="math inline">\(\epsilon_N\)</span>)</li>
<li>the (translational) entropy of the aggregate as a whole (<span class="math inline">\(\propto {\rm number of aggregates}\times \ln {\rm number fo aggregates}\)</span>)</li>
</ul>
<p>Assume an overall volume fraction of surfactants <span class="math inline">\(\phi\)</span>. Call the volume fraction of surfactants in an aggregate with <span class="math inline">\(N\)</span> molecules <span class="math inline">\(X_N\)</span>, so that <span class="math inline">\(\sum_N X_N = \phi\)</span>. The numbers of aggregates of size <span class="math inline">\(N\)</span> is then simply <span class="math inline">\(X_N/N\)</span>. This means that we can write the uniform chemical potential as</p>
<p><span class="math display">\[\mu = \epsilon_N + \dfrac{k_B T}{N}\ln{\dfrac{X_N}{N}}\]</span></p>
<p>we can rewrite this as</p>
<p><span class="math display">\[X_N = N \exp{\left( \dfrac{N(\mu-\epsilon_N)}{k_BT}\right)}\]</span></p>
<p>we can eliminate <span class="math inline">\(\mu\)</span> by evaluating the expression for for <span class="math inline">\(N=1\)</span> and plugging it back to get</p>
<p><span class="math display">\[X_N = N X_1^N \exp{\left( \dfrac{N(\epsilon_1-\epsilon_N)}{k_BT}\right)}\]</span></p>
<p>Obviously, the equation show that one has a large fraction of the solutes in an aggregated state only if there is a free energy advantage at forming aggregates, i.e.&nbsp;<span class="math inline">\(\epsilon_1&gt;\epsilon_N\)</span>.</p>
<p>This means that knowning the form of <span class="math inline">\(\epsilon_N\)</span> allows us to predict the aggregation behaviour. For example, imagine we have an aggregate with <span class="math inline">\(N\)</span> particles of total radius <span class="math inline">\(r\approx (Nv)^(1/3)\)</span> where v is the volume of a single particle. Then <span class="math inline">\(\epsilon_N\)</span> is the free energy per particle of the aggregate of size <span class="math inline">\(N\)</span>, <span class="math inline">\(G_N=\text{ bulk free energy}+\text{surface free energy}\)</span>. Assuming a surface tension <span class="math inline">\(\gamma\)</span> we can then write</p>
<p><span class="math display">\[\epsilon_N = \dfrac{G_N}{N} = \epsilon_\infty  +\dfrac{1}{N}\gamma r^2 =\epsilon_\infty +\gamma\left(\dfrac{v^2}{N}\right)^{1/3}\]</span></p>
<p>which is a <strong>monotonically decreasing</strong> function of <span class="math inline">\(N\)</span>. By defininit <span class="math inline">\(\alpha k_B T = \gamma v^{2/3}\)</span> we can extract a relation between <span class="math inline">\(X_N\)</span> and <span class="math inline">\(X_1\)</span> parametrised solely by <span class="math inline">\(\alpha\)</span>, i.e.</p>
<p><span class="math display">\[\text{number of aggregates of size N per unit volume} = \dfrac{X_N}{N}\sim (X_1 e^{\alpha})^N\]</span></p>
<p>This should be read as follows: if we have very few isolated particles at a certain thermodynamic condition, then <span class="math inline">\(X_1 e^{\alpha} &lt; 1\)</span> and the exponential factor <span class="math inline">\((X_1 e^{\alpha})^N\)</span> becomes vanishingly small for large <span class="math inline">\(N\)</span>, leaving us with very few large aggregates. On the contrary, as <span class="math inline">\(X_1\)</span> approaches <span class="math inline">\(e^{-\alpha}\)</span> from below, we reach the critical point where <span class="math inline">\(X_1 e^{\alpha} = 1\)</span>, and aggregates of all sizes become equally probable. Since <span class="math inline">\(\epsilon_N\)</span> is rapidly decreasing in <span class="math inline">\(N\)</span>, this means that above a critical value of overall packing fraction <span class="math inline">\(\phi\)</span>, the system cannot remain in a homogeneous state. Instead, it undergoes phase separation into a dilute phase of isolated monomers (with <span class="math inline">\(X_1\)</span> pinned at <span class="math inline">\(e^{-\alpha}\)</span>) in coexistence with a dense phase consisting of one or very few aggregates of very large (effectively infinite) size.</p>
<p>The volume fraction <span class="math inline">\(\phi\)</span> at which this occurs is called <strong>critical aggregation concentration</strong>, or CAC.</p>
</section>
<section id="aggregation-the-surfactant-case" class="level3" data-number="18.2.2">
<h3 data-number="18.2.2" class="anchored" data-anchor-id="aggregation-the-surfactant-case"><span class="header-section-number">18.2.2</span> Aggregation: the surfactant case</h3>
<p>For amphiphilic molecules like surfactants, the free energy change <span class="math inline">\(\epsilon_N\)</span> associated with adding a molecule to an aggregate is not a monotonically decreasing function of <span class="math inline">\(N\)</span>. Instead, <span class="math inline">\(\epsilon_N\)</span> typically exhibits a minimum at a characteristic aggregation number <span class="math inline">\(N^*\)</span>. This reflects the fact that aggregates (such as micelles) of a particular size are thermodynamically favored: too-small aggregates cannot sufficiently shield the hydrophobic tails from the solvent, while too-large aggregates become energetically unfavorable due to packing constraints or headgroup repulsion. See <span class="citation" data-cites="jones2002soft">Jones (<a href="#ref-jones2002soft" role="doc-biblioref">2002</a>)</span> for a expanded discussion of this.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./figs/interface.svg" class="img-fluid figure-img"></p>
<figcaption>Surfactants in solution: normally, this is done in water in the presence of an interface with air. Due to their nature as amphiphiles, the surfactants typically sit at the air-water interface in a dynamical, equilibrium process that exchanges monomers between the bulk and the surface. The bulk surfactants, when the concentration is larger than a critical value, also self-assemble into micellar structures, which are at equilibrium with the isolated single surfactants.</figcaption>
</figure>
</div>
<p>Mathematically, this means that the distribution <span class="math inline">\(X_N\)</span> of aggregates as a function of <span class="math inline">\(N\)</span> is sharply peaked around <span class="math inline">\(N^*\)</span>, leading to a well-defined aggregate size in solution. The equilibrium is then characterized by a coexistence of monomers and aggregates of size <span class="math inline">\(N^*\)</span>, with very few intermediate-sized clusters. This is in contrast to the general case discussed above, where the aggregate size distribution can be broad or even diverge near a phase separation threshold.</p>
<p>This behavior underlies the concept of the <strong>critical micelle concentration (CMC)</strong>: below the CMC, almost all surfactant molecules are present as monomers; above the CMC, additional surfactant molecules predominantly form micelles of size <span class="math inline">\(N^*\)</span>, while the monomer concentration remains nearly constant.</p>
<p>Above the critical micellar concentration surfactants self-assemble in solution spontaneously into larger structures. (In the following we will consider aqueous solutions, although the arguments also apply to other polar or non-polar (organic) solvents.) This allows the hydrophobic parts to crowd together while being ‘shielded’ by the hydrophilic heads. The density of the hydrophobic cores is very similar to the density of fluid hydro-carbons and the random arrangements of the chains resemble closely a fluid structure.</p>
<p>The surfactant assemblies are not held together by chemical bonds, but only by weak interactions ( <span class="math inline">\(\lesssim k B T\)</span> ). Their existence and properties are thus determined by a delicate balance between different effects, such as the transfer of hydrophobic chains into the core, interactions between the head group and the entropy of mixing. Small changes in control parameters, for example temperature, salt concentration or pH , thus have large effects on the characteristics of the surfactant aggregates. Nevertheless, for given conditions, they have very well-defined properties (shape, size etc.).</p>
</section>
<section id="shape-of-surfactant-assemblies" class="level3" data-number="18.2.3">
<h3 data-number="18.2.3" class="anchored" data-anchor-id="shape-of-surfactant-assemblies"><span class="header-section-number">18.2.3</span> Shape of surfactant assemblies</h3>
<p>Surfactants spontaneously self-assemble into a variety of different structures. We use packing considerations to understand and predict the shape of surfactant aggregates, leveraging what we have learned on colloids, polymers and liquid crystals.</p>
<p>We construct a geometric model where a surfactant molecule is described using the following parameters:</p>
<ul>
<li><strong>optimal headgroup area <span class="math inline">\(a_{0}\)</span></strong>: As discussed in the previous section, this depends on a delicate balance of forces and is thus not only controlled by the chemistry of the surfactant molecule, but also depends on different control parameters of the solution, such as salt concentration, pH or temperature. -<strong>volume <span class="math inline">\(v\)</span> of the hydrophobic part</strong>: The hydrophobic part usually consists of hydrocarbon chains and for saturated hydrocarbons the volume <span class="math inline">\(v\)</span> can be approximated by <span class="math inline">\(v \approx(27.4+26.9 \mathrm{n}) \times 10^{-3} \mathrm{~nm}^{3}\)</span> where n is the number of carbon atoms.</li>
<li><strong>critical chain length</strong> <span class="math inline">\(\boldsymbol{l}_{\boldsymbol{c}}\)</span> : The maximum effective length of the hydrophobic chains is called the critical chain length <span class="math inline">\(l_{c}\)</span>, which has to be shorter than the fully extended molecular length of the chain <span class="math inline">\(l_{\max }\)</span>. For saturated hydrocarbons the critical length can be estimated using <span class="math inline">\(l_{c} \leq l_{\max } \approx(0.154+0.1265 \mathrm{n}) \mathrm{nm}\)</span>. The critical chain length heavily depends on the detailed chemical structure of the molecule, for example on the presence of double bonds or branching, as well as the temperature.</li>
</ul>
<p>The structure which will be adopted is determined by a balance between entropy, which favours small aggregates, and energy considerations: A certain shape or size might only be possible by imposing a headgroup area <span class="math inline">\(a&gt;a_{0}\)</span>, which is energetically not favourable. We will now establish the criteria for the different shapes.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./figs/selfassemblies.svg" class="img-fluid figure-img"></p>
<figcaption>Different types of self assembled structures: (A) spherical micelles, (B) cylindrical micelles and (C) bilayers.</figcaption>
</figure>
</div>
<p>A. <strong>Spherical micelle</strong></p>
<p>For a spherical micelle with aggregation number N , the total volume and surface area are given by</p>
<p><span class="math display">\[
\begin{gathered}
N v=\frac{4 \pi}{3} R^{3} \\
N a_{0}=4 \pi R^{2} \\
\therefore \frac{v}{a_{0}}=\frac{R}{3}&lt;\frac{l_{c}}{3}
\end{gathered}
\]</span></p>
<p>where we used the fact that the radius <span class="math inline">\(R\)</span> cannot be larger than the critical chain length <span class="math inline">\(\mathrm{I}_{\mathrm{c}}\)</span>. We thus obtain for the critical packing parameter <span class="math inline">\(P\)</span></p>
<p><span class="math display">\[
P=\frac{v}{a_{0} l_{c}}&lt;\frac{1}{3}
\]</span></p>
<p>B. <strong>Cylindrical micelles</strong></p>
<p>For a cylindrical micelle the total volume and surface area are given by <span class="math inline">\(N v=\pi R^{2} L\)</span> <span class="math inline">\(N a_{0}=2 \pi R L\)</span> <span class="math inline">\(\therefore \frac{v}{a_{0}}=\frac{R}{2}&lt;\frac{l_{c}}{2}\)</span> again using <span class="math inline">\(R&lt;I_{C}\)</span>.</p>
<p>We thus obtain for the critical packing parameter <span class="math inline">\(P\)</span> <span class="math inline">\(\frac{1}{3}&lt;\frac{v}{a_{0} l_{c}}&lt;\frac{1}{2}\)</span></p>
<p>Below the lower limit spherical micelles are formed.</p>
<p>C. <strong>Bilayers</strong></p>
<p>For a bilayer the total volume and surface area are given by</p>
<p><span class="math display">\[
\begin{aligned}
&amp; N v=A D \\
&amp; N a_{0}=2 A \\
&amp; \frac{v}{a_{0}}=\frac{D}{2}&lt;l_{c} \quad\left(\text { using } D&lt;2 l_{c}\right)
\end{aligned}
\]</span></p>
<p>We thus obtain for the critical packing parameter <span class="math inline">\(P\)</span> <span class="math inline">\(\frac{1}{2}&lt;\frac{v}{a_{0} l_{c}}&lt;1\)</span> Below the lower limit cylindrical micelles are formed.</p>
</section>
</section>
<section id="a-simple-on-lattice-model-for-micelle-formation" class="level2" data-number="18.3">
<h2 data-number="18.3" class="anchored" data-anchor-id="a-simple-on-lattice-model-for-micelle-formation"><span class="header-section-number">18.3</span> A simple on-lattice model for micelle formation</h2>
<p>Aggregation of surfactants has been studied in various ways, including numerical simulations. One can employ extremely realistic, all-atom molecular dynamics to glean the microscopic details or construct more coarse-grained, statistical mechanics models using for exmaple on lattice interactions.</p>
<p>Here below you can find a Javascript implementation of a lattice-gas-like model where surfactants are representes by chains of 3 sites on a lattice, with one site for the solvophilic head and two for the solvophobic tail. Each lattice site is occupied by either an amphiphile segment or a solvent molecule.</p>
<p>There are only nearest-neighbor interactions and the hamiltonian is simply</p>
<p><span class="math display">\[
H=n_{\mathrm{HH}} E_{\mathrm{HH}}+n_{\mathrm{TS}} E_{\mathrm{TS}}+n_{\mathrm{HS}} E_{\mathrm{HS}}+\sum_{\mathrm{i}} E_{\mathrm{c}}
\]</span></p>
<p>where <span class="math inline">\(n_{\mathrm{HH}}, n_{\mathrm{TS}}\)</span> and <span class="math inline">\(n_{\mathrm{HS}}\)</span> are the total number of head-head, tail-solvent and head-solvent bonds, <span class="math inline">\(E_{\mathrm{HH}}, E_{\mathrm{Ts}}\)</span> and <span class="math inline">\(E_{\mathrm{HS}}\)</span> are the head-head, tail-solvent and head-solvent interaction energies and <span class="math inline">\(E_c\)</span> is the energy associated with the conformation of the <span class="math inline">\(i\)</span> th molecule. The model has been discussed in detail in <span class="citation" data-cites="care1987cluster">Care (<a href="#ref-care1987cluster" role="doc-biblioref">1987</a>)</span>.</p>
<p>The model is simplified by setting the head-head interaction to zero, the tail-solvent interaction hydrophobic <span class="math inline">\(E_{\rm TS}&gt;0\)</span>, the head-solvent hydrophilic <span class="math inline">\(E_{\rm HS}&lt;0\)</span> and the chain completely flexible, <span class="math inline">\(E_c^i=0\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="234" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 233;"><span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a>viewof temperature <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.01</span><span class="op">,</span> <span class="dv">2</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="fl">0.05</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Temperature (kT)"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fl">0.5</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="238" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 237;"><span id="cb2-238"><a href="#cb2-238" aria-hidden="true" tabindex="-1"></a>viewof numChains <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">3</span><span class="op">,</span> <span class="dv">300</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">"Number of Chains"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">100</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" data-startfrom="242" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 241;"><span id="cb3-242"><a href="#cb3-242" aria-hidden="true" tabindex="-1"></a><span class="co">// This is ObservableJS code  </span></span>
<span id="cb3-243"><a href="#cb3-243" aria-hidden="true" tabindex="-1"></a><span class="co">// You can run at observableehq.com or convert it to an equivalent (and faster?) Python version if you like</span></span>
<span id="cb3-244"><a href="#cb3-244" aria-hidden="true" tabindex="-1"></a>viewof simulation <span class="op">=</span> {</span>
<span id="cb3-245"><a href="#cb3-245" aria-hidden="true" tabindex="-1"></a>    <span class="co">// --- Parameters ---</span></span>
<span id="cb3-246"><a href="#cb3-246" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> width <span class="op">=</span> <span class="dv">40</span><span class="op">,</span> height <span class="op">=</span> <span class="dv">40</span><span class="op">;</span></span>
<span id="cb3-247"><a href="#cb3-247" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> chainLength <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb3-248"><a href="#cb3-248" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> chainsToCreate <span class="op">=</span> numChains<span class="op">;</span></span>
<span id="cb3-249"><a href="#cb3-249" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> T <span class="op">=</span> temperature<span class="op">;</span></span>
<span id="cb3-250"><a href="#cb3-250" aria-hidden="true" tabindex="-1"></a>    <span class="co">// const numChains = 10;</span></span>
<span id="cb3-251"><a href="#cb3-251" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> E_TS <span class="op">=</span> <span class="fl">1.0</span><span class="op">;</span>     <span class="co">// tail-solvent energy (solvophobic)</span></span>
<span id="cb3-252"><a href="#cb3-252" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> E_HS <span class="op">=</span> <span class="op">-</span><span class="fl">1.5</span><span class="op">;</span>    <span class="co">// head-solvent energy (solvophilic)</span></span>
<span id="cb3-253"><a href="#cb3-253" aria-hidden="true" tabindex="-1"></a>    <span class="co">// const T = 0.1;        // temperature (kT units)</span></span>
<span id="cb3-254"><a href="#cb3-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-255"><a href="#cb3-255" aria-hidden="true" tabindex="-1"></a>    <span class="co">// --- Initialize grid and chains ---</span></span>
<span id="cb3-256"><a href="#cb3-256" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> grid <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>({<span class="dt">length</span><span class="op">:</span> width}<span class="op">,</span> () <span class="kw">=&gt;</span> <span class="bu">Array</span>(height)<span class="op">.</span><span class="fu">fill</span>(<span class="kw">null</span>))<span class="op">;</span></span>
<span id="cb3-257"><a href="#cb3-257" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> chains <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb3-258"><a href="#cb3-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-259"><a href="#cb3-259" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Periodic boundary helper</span></span>
<span id="cb3-260"><a href="#cb3-260" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">mod</span>(n<span class="op">,</span> m) { <span class="cf">return</span> ((n <span class="op">%</span> m) <span class="op">+</span> m) <span class="op">%</span> m<span class="op">;</span> }</span>
<span id="cb3-261"><a href="#cb3-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-262"><a href="#cb3-262" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">getNeighbors</span>(x<span class="op">,</span> y) {</span>
<span id="cb3-263"><a href="#cb3-263" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [</span>
<span id="cb3-264"><a href="#cb3-264" aria-hidden="true" tabindex="-1"></a>            {<span class="dt">x</span><span class="op">:</span> <span class="fu">mod</span>(x <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> width)<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> y}<span class="op">,</span></span>
<span id="cb3-265"><a href="#cb3-265" aria-hidden="true" tabindex="-1"></a>            {<span class="dt">x</span><span class="op">:</span> <span class="fu">mod</span>(x <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> width)<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> y}<span class="op">,</span></span>
<span id="cb3-266"><a href="#cb3-266" aria-hidden="true" tabindex="-1"></a>            {<span class="dt">x</span><span class="op">:</span> x<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="fu">mod</span>(y <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> height)}<span class="op">,</span></span>
<span id="cb3-267"><a href="#cb3-267" aria-hidden="true" tabindex="-1"></a>            {<span class="dt">x</span><span class="op">:</span> x<span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="fu">mod</span>(y <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> height)}</span>
<span id="cb3-268"><a href="#cb3-268" aria-hidden="true" tabindex="-1"></a>        ]<span class="op">;</span></span>
<span id="cb3-269"><a href="#cb3-269" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-270"><a href="#cb3-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-271"><a href="#cb3-271" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">placeChains</span>() {</span>
<span id="cb3-272"><a href="#cb3-272" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (<span class="kw">let</span> id <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> id <span class="op">&lt;</span> numChains<span class="op">;</span> id<span class="op">++</span>) {</span>
<span id="cb3-273"><a href="#cb3-273" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> (<span class="kw">let</span> tries <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> tries <span class="op">&lt;</span> <span class="dv">100</span><span class="op">;</span> tries<span class="op">++</span>) {</span>
<span id="cb3-274"><a href="#cb3-274" aria-hidden="true" tabindex="-1"></a>                <span class="kw">let</span> x <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>() <span class="op">*</span> width)<span class="op">;</span></span>
<span id="cb3-275"><a href="#cb3-275" aria-hidden="true" tabindex="-1"></a>                <span class="kw">let</span> y <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>() <span class="op">*</span> height)<span class="op">;</span></span>
<span id="cb3-276"><a href="#cb3-276" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (grid[x][y]) <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb3-277"><a href="#cb3-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-278"><a href="#cb3-278" aria-hidden="true" tabindex="-1"></a>                <span class="kw">let</span> chain <span class="op">=</span> [{x<span class="op">,</span> y<span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">'head'</span>}]<span class="op">;</span></span>
<span id="cb3-279"><a href="#cb3-279" aria-hidden="true" tabindex="-1"></a>                grid[x][y] <span class="op">=</span> {id<span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">'head'</span>}<span class="op">;</span></span>
<span id="cb3-280"><a href="#cb3-280" aria-hidden="true" tabindex="-1"></a>                <span class="kw">let</span> ok <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb3-281"><a href="#cb3-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-282"><a href="#cb3-282" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> chainLength<span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb3-283"><a href="#cb3-283" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">let</span> last <span class="op">=</span> chain[chain<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span>]<span class="op">;</span></span>
<span id="cb3-284"><a href="#cb3-284" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">let</span> nbs <span class="op">=</span> <span class="fu">getNeighbors</span>(last<span class="op">.</span><span class="at">x</span><span class="op">,</span> last<span class="op">.</span><span class="at">y</span>)<span class="op">.</span><span class="fu">filter</span>(p <span class="kw">=&gt;</span> <span class="op">!</span>grid[p<span class="op">.</span><span class="at">x</span>][p<span class="op">.</span><span class="at">y</span>])<span class="op">;</span></span>
<span id="cb3-285"><a href="#cb3-285" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> (nbs<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">0</span>) { ok <span class="op">=</span> <span class="kw">false</span><span class="op">;</span> <span class="cf">break</span><span class="op">;</span> }</span>
<span id="cb3-286"><a href="#cb3-286" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">let</span> next <span class="op">=</span> nbs[<span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>() <span class="op">*</span> nbs<span class="op">.</span><span class="at">length</span>)]<span class="op">;</span></span>
<span id="cb3-287"><a href="#cb3-287" aria-hidden="true" tabindex="-1"></a>                    chain<span class="op">.</span><span class="fu">push</span>({<span class="op">...</span>next<span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">'tail'</span>})<span class="op">;</span></span>
<span id="cb3-288"><a href="#cb3-288" aria-hidden="true" tabindex="-1"></a>                    grid[next<span class="op">.</span><span class="at">x</span>][next<span class="op">.</span><span class="at">y</span>] <span class="op">=</span> {id<span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">'tail'</span>}<span class="op">;</span></span>
<span id="cb3-289"><a href="#cb3-289" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb3-290"><a href="#cb3-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-291"><a href="#cb3-291" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (ok) { chains<span class="op">.</span><span class="fu">push</span>({id<span class="op">,</span> <span class="dt">segments</span><span class="op">:</span> chain})<span class="op">;</span> <span class="cf">break</span><span class="op">;</span> }</span>
<span id="cb3-292"><a href="#cb3-292" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span> { chain<span class="op">.</span><span class="fu">forEach</span>(p <span class="kw">=&gt;</span> grid[p<span class="op">.</span><span class="at">x</span>][p<span class="op">.</span><span class="at">y</span>] <span class="op">=</span> <span class="kw">null</span>)<span class="op">;</span> }</span>
<span id="cb3-293"><a href="#cb3-293" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb3-294"><a href="#cb3-294" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb3-295"><a href="#cb3-295" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-296"><a href="#cb3-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-297"><a href="#cb3-297" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">energy</span>(seg) {</span>
<span id="cb3-298"><a href="#cb3-298" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> solventNbs <span class="op">=</span> <span class="fu">getNeighbors</span>(seg<span class="op">.</span><span class="at">x</span><span class="op">,</span> seg<span class="op">.</span><span class="at">y</span>)<span class="op">.</span><span class="fu">filter</span>(p <span class="kw">=&gt;</span> <span class="op">!</span>grid[p<span class="op">.</span><span class="at">x</span>][p<span class="op">.</span><span class="at">y</span>])<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb3-299"><a href="#cb3-299" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> seg<span class="op">.</span><span class="at">type</span> <span class="op">===</span> <span class="st">'head'</span> <span class="op">?</span> solventNbs <span class="op">*</span> E_HS <span class="op">:</span> solventNbs <span class="op">*</span> E_TS<span class="op">;</span></span>
<span id="cb3-300"><a href="#cb3-300" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-301"><a href="#cb3-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-302"><a href="#cb3-302" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">attemptMove</span>(chain) {</span>
<span id="cb3-303"><a href="#cb3-303" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> forward <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>() <span class="op">&lt;</span> <span class="fl">0.5</span><span class="op">;</span></span>
<span id="cb3-304"><a href="#cb3-304" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> tail <span class="op">=</span> forward <span class="op">?</span> chain<span class="op">.</span><span class="at">segments</span>[<span class="dv">0</span>] <span class="op">:</span> chain<span class="op">.</span><span class="at">segments</span><span class="op">.</span><span class="fu">at</span>(<span class="op">-</span><span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb3-305"><a href="#cb3-305" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> head <span class="op">=</span> forward <span class="op">?</span> chain<span class="op">.</span><span class="at">segments</span><span class="op">.</span><span class="fu">at</span>(<span class="op">-</span><span class="dv">1</span>) <span class="op">:</span> chain<span class="op">.</span><span class="at">segments</span>[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb3-306"><a href="#cb3-306" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> options <span class="op">=</span> <span class="fu">getNeighbors</span>(head<span class="op">.</span><span class="at">x</span><span class="op">,</span> head<span class="op">.</span><span class="at">y</span>)<span class="op">.</span><span class="fu">filter</span>(p <span class="kw">=&gt;</span> <span class="op">!</span>grid[p<span class="op">.</span><span class="at">x</span>][p<span class="op">.</span><span class="at">y</span>])<span class="op">;</span></span>
<span id="cb3-307"><a href="#cb3-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-308"><a href="#cb3-308" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (options<span class="op">.</span><span class="at">length</span> <span class="op">===</span> <span class="dv">0</span>) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb3-309"><a href="#cb3-309" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> next <span class="op">=</span> options[<span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>() <span class="op">*</span> options<span class="op">.</span><span class="at">length</span>)]<span class="op">;</span></span>
<span id="cb3-310"><a href="#cb3-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-311"><a href="#cb3-311" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> dE_old <span class="op">=</span> <span class="fu">energy</span>(tail)<span class="op">;</span></span>
<span id="cb3-312"><a href="#cb3-312" aria-hidden="true" tabindex="-1"></a>        grid[tail<span class="op">.</span><span class="at">x</span>][tail<span class="op">.</span><span class="at">y</span>] <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb3-313"><a href="#cb3-313" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> dE_new <span class="op">=</span> <span class="fu">energy</span>({<span class="op">...</span>next<span class="op">,</span> <span class="dt">type</span><span class="op">:</span> tail<span class="op">.</span><span class="at">type</span>})<span class="op">;</span></span>
<span id="cb3-314"><a href="#cb3-314" aria-hidden="true" tabindex="-1"></a>        grid[tail<span class="op">.</span><span class="at">x</span>][tail<span class="op">.</span><span class="at">y</span>] <span class="op">=</span> {<span class="dt">id</span><span class="op">:</span> chain<span class="op">.</span><span class="at">id</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> tail<span class="op">.</span><span class="at">type</span>}<span class="op">;</span></span>
<span id="cb3-315"><a href="#cb3-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-316"><a href="#cb3-316" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> deltaU <span class="op">=</span> dE_new <span class="op">-</span> dE_old<span class="op">;</span></span>
<span id="cb3-317"><a href="#cb3-317" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> accept <span class="op">=</span> deltaU <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">||</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>() <span class="op">&lt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span>(<span class="op">-</span>deltaU <span class="op">/</span> T)<span class="op">;</span></span>
<span id="cb3-318"><a href="#cb3-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-319"><a href="#cb3-319" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (accept) {</span>
<span id="cb3-320"><a href="#cb3-320" aria-hidden="true" tabindex="-1"></a>            grid[tail<span class="op">.</span><span class="at">x</span>][tail<span class="op">.</span><span class="at">y</span>] <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb3-321"><a href="#cb3-321" aria-hidden="true" tabindex="-1"></a>            grid[next<span class="op">.</span><span class="at">x</span>][next<span class="op">.</span><span class="at">y</span>] <span class="op">=</span> {<span class="dt">id</span><span class="op">:</span> chain<span class="op">.</span><span class="at">id</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> tail<span class="op">.</span><span class="at">type</span>}<span class="op">;</span></span>
<span id="cb3-322"><a href="#cb3-322" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (forward) {</span>
<span id="cb3-323"><a href="#cb3-323" aria-hidden="true" tabindex="-1"></a>                chain<span class="op">.</span><span class="at">segments</span><span class="op">.</span><span class="fu">shift</span>()<span class="op">;</span></span>
<span id="cb3-324"><a href="#cb3-324" aria-hidden="true" tabindex="-1"></a>                chain<span class="op">.</span><span class="at">segments</span><span class="op">.</span><span class="fu">push</span>({<span class="op">...</span>next<span class="op">,</span> <span class="dt">type</span><span class="op">:</span> tail<span class="op">.</span><span class="at">type</span>})<span class="op">;</span></span>
<span id="cb3-325"><a href="#cb3-325" aria-hidden="true" tabindex="-1"></a>            } <span class="cf">else</span> {</span>
<span id="cb3-326"><a href="#cb3-326" aria-hidden="true" tabindex="-1"></a>                chain<span class="op">.</span><span class="at">segments</span><span class="op">.</span><span class="fu">pop</span>()<span class="op">;</span></span>
<span id="cb3-327"><a href="#cb3-327" aria-hidden="true" tabindex="-1"></a>                chain<span class="op">.</span><span class="at">segments</span><span class="op">.</span><span class="fu">unshift</span>({<span class="op">...</span>next<span class="op">,</span> <span class="dt">type</span><span class="op">:</span> tail<span class="op">.</span><span class="at">type</span>})<span class="op">;</span></span>
<span id="cb3-328"><a href="#cb3-328" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb3-329"><a href="#cb3-329" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb3-330"><a href="#cb3-330" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-331"><a href="#cb3-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-332"><a href="#cb3-332" aria-hidden="true" tabindex="-1"></a>    <span class="co">// --- Visualization ---</span></span>
<span id="cb3-333"><a href="#cb3-333" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> svg <span class="op">=</span> d3<span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb3-334"><a href="#cb3-334" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> <span class="vs">`0 0 </span><span class="sc">${</span>width<span class="sc">}</span><span class="vs"> </span><span class="sc">${</span>height<span class="sc">}</span><span class="vs">`</span>)</span>
<span id="cb3-335"><a href="#cb3-335" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"width"</span><span class="op">,</span> <span class="st">"400px"</span>)</span>
<span id="cb3-336"><a href="#cb3-336" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"height"</span><span class="op">,</span> <span class="st">"400px"</span>)</span>
<span id="cb3-337"><a href="#cb3-337" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"border"</span><span class="op">,</span> <span class="st">"1px solid #ccc"</span>)<span class="op">;</span></span>
<span id="cb3-338"><a href="#cb3-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-339"><a href="#cb3-339" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> g <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">;</span></span>
<span id="cb3-340"><a href="#cb3-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-341"><a href="#cb3-341" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">draw</span>() {</span>
<span id="cb3-342"><a href="#cb3-342" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> data <span class="op">=</span> chains<span class="op">.</span><span class="fu">flatMap</span>(c <span class="kw">=&gt;</span> c<span class="op">.</span><span class="at">segments</span>)<span class="op">;</span></span>
<span id="cb3-343"><a href="#cb3-343" aria-hidden="true" tabindex="-1"></a>        g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"circle"</span>)</span>
<span id="cb3-344"><a href="#cb3-344" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">data</span>(data<span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span>d<span class="op">.</span><span class="at">x</span><span class="sc">}</span><span class="vs">-</span><span class="sc">${</span>d<span class="op">.</span><span class="at">y</span><span class="sc">}</span><span class="vs">`</span>)</span>
<span id="cb3-345"><a href="#cb3-345" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">join</span>(<span class="st">"circle"</span>)</span>
<span id="cb3-346"><a href="#cb3-346" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cx"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">x</span> <span class="op">+</span> <span class="fl">0.5</span>)</span>
<span id="cb3-347"><a href="#cb3-347" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">y</span> <span class="op">+</span> <span class="fl">0.5</span>)</span>
<span id="cb3-348"><a href="#cb3-348" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> <span class="fl">0.45</span>)</span>
<span id="cb3-349"><a href="#cb3-349" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">type</span> <span class="op">===</span> <span class="st">"head"</span> <span class="op">?</span> <span class="st">"blue"</span> <span class="op">:</span> <span class="st">"red"</span>)<span class="op">;</span></span>
<span id="cb3-350"><a href="#cb3-350" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-351"><a href="#cb3-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-352"><a href="#cb3-352" aria-hidden="true" tabindex="-1"></a>    <span class="co">// --- Main Loop ---</span></span>
<span id="cb3-353"><a href="#cb3-353" aria-hidden="true" tabindex="-1"></a>    <span class="fu">placeChains</span>()<span class="op">;</span></span>
<span id="cb3-354"><a href="#cb3-354" aria-hidden="true" tabindex="-1"></a>    <span class="fu">draw</span>()<span class="op">;</span></span>
<span id="cb3-355"><a href="#cb3-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-356"><a href="#cb3-356" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> running <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb3-357"><a href="#cb3-357" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> button <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;button&gt;⏸ Pause&lt;/button&gt;`</span><span class="op">;</span></span>
<span id="cb3-358"><a href="#cb3-358" aria-hidden="true" tabindex="-1"></a>    button<span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb3-359"><a href="#cb3-359" aria-hidden="true" tabindex="-1"></a>        running <span class="op">=</span> <span class="op">!</span>running<span class="op">;</span></span>
<span id="cb3-360"><a href="#cb3-360" aria-hidden="true" tabindex="-1"></a>        button<span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> running <span class="op">?</span> <span class="st">"⏸ Pause"</span> <span class="op">:</span> <span class="st">"▶ Resume"</span><span class="op">;</span></span>
<span id="cb3-361"><a href="#cb3-361" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb3-362"><a href="#cb3-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-363"><a href="#cb3-363" aria-hidden="true" tabindex="-1"></a>    (<span class="kw">async</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb3-364"><a href="#cb3-364" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> (<span class="kw">true</span>) {</span>
<span id="cb3-365"><a href="#cb3-365" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (running) {</span>
<span id="cb3-366"><a href="#cb3-366" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> chains<span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb3-367"><a href="#cb3-367" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">const</span> c <span class="op">=</span> chains[<span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>() <span class="op">*</span> chains<span class="op">.</span><span class="at">length</span>)]<span class="op">;</span></span>
<span id="cb3-368"><a href="#cb3-368" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">attemptMove</span>(c)<span class="op">;</span></span>
<span id="cb3-369"><a href="#cb3-369" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb3-370"><a href="#cb3-370" aria-hidden="true" tabindex="-1"></a>                <span class="fu">draw</span>()<span class="op">;</span></span>
<span id="cb3-371"><a href="#cb3-371" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb3-372"><a href="#cb3-372" aria-hidden="true" tabindex="-1"></a>            <span class="cf">await</span> <span class="kw">new</span> <span class="bu">Promise</span>(r <span class="kw">=&gt;</span> <span class="pp">setTimeout</span>(r<span class="op">,</span> <span class="dv">50</span>))<span class="op">;</span></span>
<span id="cb3-373"><a href="#cb3-373" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb3-374"><a href="#cb3-374" aria-hidden="true" tabindex="-1"></a>    })()<span class="op">;</span></span>
<span id="cb3-375"><a href="#cb3-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-376"><a href="#cb3-376" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">html</span><span class="vs">`&lt;div&gt;</span><span class="sc">${</span>button<span class="sc">}</span><span class="vs">&lt;br&gt;</span><span class="sc">${</span>svg<span class="op">.</span><span class="fu">node</span>()<span class="sc">}</span><span class="vs">&lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb3-377"><a href="#cb3-377" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="ojs-cell-3" data-nodetype="declaration">

</div>
</div>
</div>
</section>
<section id="references" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="references">References</h2>


<script type="pyodide-data">
eyJvcHRpb25zIjp7ImVudiI6eyJQTE9UTFlfUkVOREVSRVIiOiJwbG90bHlfbWltZXR5cGUifSwiaW5kZXhVUkwiOiJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvcHlvZGlkZS92MC4yNy4wL2Z1bGwvIn0sInBhY2thZ2VzIjp7InBrZ3MiOlsicHlvZGlkZV9odHRwIiwibWljcm9waXAiLCJpcHl0aG9uIiwibnVtcHkiLCJtYXRwbG90bGliIiwicGxvdGx5IiwibmJmb3JtYXQiLCJwYW5kYXMiXX19
</script>
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3siY2VsbE5hbWUiOiJweW9kaWRlLTEiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoiX3B5b2RpZGVfdmFsdWVfMSA9IHtcbiAgY29uc3QgeyBoaWdobGlnaHRQeXRob24sIGI2NERlY29kZX0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuXG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwicHlvZGlkZS0xLWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgLy8gRGVmYXVsdCBldmFsdWF0aW9uIGNvbmZpZ3VyYXRpb25cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe1xuICAgIGlkOiBcInB5b2RpZGUtMS1jb250ZW50c1wiLFxuICAgIGVjaG86IHRydWUsXG4gICAgb3V0cHV0OiB0cnVlXG4gIH0sIGJsb2NrLmF0dHIpO1xuXG4gIC8vIEV2YWx1YXRlIHRoZSBwcm92aWRlZCBQeXRob24gY29kZVxuICBjb25zdCByZXN1bHQgPSBweW9kaWRlT2pzLnByb2Nlc3Moe2NvZGU6IGJsb2NrLmNvZGUsIG9wdGlvbnN9LCB7fSk7XG5cbiAgLy8gRWFybHkgeWllbGQgd2hpbGUgd2Ugd2FpdCBmb3IgdGhlIGZpcnN0IGV2YWx1YXRpb24gYW5kIHJlbmRlclxuICBpZiAob3B0aW9ucy5vdXRwdXQgJiYgIShcIjFcIiBpbiBweW9kaWRlT2pzLnJlbmRlcmVkT2pzKSkge1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgY29uc3Qgc3Bpbm5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cbiAgICBpZiAob3B0aW9ucy5lY2hvKSB7XG4gICAgICAvLyBTaG93IG91dHB1dCBhcyBoaWdobGlnaHRlZCBzb3VyY2VcbiAgICAgIGNvbnN0IHByZUVsZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicHJlXCIpO1xuICAgICAgY29udGFpbmVyLmNsYXNzTmFtZSA9IFwic291cmNlQ29kZVwiO1xuICAgICAgcHJlRWxlbS5jbGFzc05hbWUgPSBcInNvdXJjZUNvZGUgcHl0aG9uXCI7XG4gICAgICBwcmVFbGVtLmFwcGVuZENoaWxkKGhpZ2hsaWdodFB5dGhvbihibG9jay5jb2RlKSk7XG4gICAgICBzcGlubmVyLmNsYXNzTmFtZSA9IFwic3Bpbm5lci1ncm93IHNwaW5uZXItZ3Jvdy1zbSBtLTIgcG9zaXRpb24tYWJzb2x1dGUgdG9wLTAgZW5kLTBcIjtcbiAgICAgIHByZUVsZW0uYXBwZW5kQ2hpbGQoc3Bpbm5lcik7XG4gICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQocHJlRWxlbSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNwaW5uZXIuY2xhc3NOYW1lID0gXCJzcGlubmVyLWJvcmRlciBzcGlubmVyLWJvcmRlci1zbVwiO1xuICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHNwaW5uZXIpO1xuICAgIH1cblxuICAgIHlpZWxkIGNvbnRhaW5lcjtcbiAgfVxuXG4gIHB5b2RpZGVPanMucmVuZGVyZWRPanNbXCIxXCJdID0gdHJ1ZTtcbiAgeWllbGQgYXdhaXQgcmVzdWx0O1xufVxuIn0seyJjZWxsTmFtZSI6InB5b2RpZGUtcHJlbHVkZSIsImlubGluZSI6ZmFsc2UsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InB5b2RpZGVPanMgPSB7XG4gIGNvbnN0IHtcbiAgICBQeW9kaWRlRXZhbHVhdG9yLFxuICAgIFB5b2RpZGVFbnZpcm9ubWVudE1hbmFnZXIsXG4gICAgc2V0dXBQeXRob24sXG4gICAgc3RhcnRQeW9kaWRlV29ya2VyLFxuICAgIGI2NERlY29kZSxcbiAgICBjb2xsYXBzZVBhdGgsXG4gIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuXG4gIGNvbnN0IHN0YXR1c0NvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZXhlcmNpc2UtbG9hZGluZy1zdGF0dXNcIik7XG4gIGNvbnN0IGluZGljYXRvckNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZXhlcmNpc2UtbG9hZGluZy1pbmRpY2F0b3JcIik7XG4gIGluZGljYXRvckNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFwiZC1ub25lXCIpO1xuXG4gIGxldCBzdGF0dXNUZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKVxuICBzdGF0dXNUZXh0LmNsYXNzTGlzdCA9IFwiZXhlcmNpc2UtbG9hZGluZy1kZXRhaWxzXCI7XG4gIHN0YXR1c1RleHQgPSBzdGF0dXNDb250YWluZXIuYXBwZW5kQ2hpbGQoc3RhdHVzVGV4dCk7XG4gIHN0YXR1c1RleHQudGV4dENvbnRlbnQgPSBgSW5pdGlhbGlzZWA7XG5cbiAgLy8gSG9pc3QgaW5kaWNhdG9yIG91dCBmcm9tIGZpbmFsIHNsaWRlIHdoZW4gcnVubmluZyB1bmRlciByZXZlYWxcbiAgY29uc3QgcmV2ZWFsU3RhdHVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5yZXZlYWwgLmV4ZXJjaXNlLWxvYWRpbmctaW5kaWNhdG9yXCIpO1xuICBpZiAocmV2ZWFsU3RhdHVzKSB7XG4gICAgcmV2ZWFsU3RhdHVzLnJlbW92ZSgpO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucmV2ZWFsID4gLnNsaWRlc1wiKS5hcHBlbmRDaGlsZChyZXZlYWxTdGF0dXMpO1xuICB9XG5cbiAgLy8gTWFrZSBhbnkgcmV2ZWFsIHNsaWRlcyB3aXRoIGxpdmUgY2VsbHMgc2Nyb2xsYWJsZVxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnJldmVhbCAuZXhlcmNpc2UtY2VsbFwiKS5mb3JFYWNoKChlbCkgPT4ge1xuICAgIGVsLmNsb3Nlc3QoJ3NlY3Rpb24uc2xpZGUnKS5jbGFzc0xpc3QuYWRkKFwic2Nyb2xsYWJsZVwiKTtcbiAgfSlcblxuICAvLyBQeW9kaWRlIHN1cHBsZW1lbnRhbCBkYXRhIGFuZCBvcHRpb25zXG4gIGNvbnN0IGRhdGFDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihgc2NyaXB0W3R5cGU9XFxcInB5b2RpZGUtZGF0YVxcXCJdYCkudGV4dENvbnRlbnQ7XG4gIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKGI2NERlY29kZShkYXRhQ29udGVudCkpO1xuXG4gIC8vIEdyYWIgbGlzdCBvZiByZXNvdXJjZXMgdG8gYmUgZG93bmxvYWRlZFxuICBjb25zdCBmaWxlc0NvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwidmZzLWZpbGVcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBmaWxlcyA9IEpTT04ucGFyc2UoYjY0RGVjb2RlKGZpbGVzQ29udGVudCkpO1xuXG4gIGxldCBweW9kaWRlUHJvbWlzZSA9IChhc3luYyAoKSA9PiB7XG4gICAgc3RhdHVzVGV4dC50ZXh0Q29udGVudCA9IGBEb3dubG9hZGluZyBQeW9kaWRlYDtcbiAgICBjb25zdCBweW9kaWRlID0gYXdhaXQgc3RhcnRQeW9kaWRlV29ya2VyKGRhdGEub3B0aW9ucyk7XG5cbiAgICBzdGF0dXNUZXh0LnRleHRDb250ZW50ID0gYERvd25sb2FkaW5nIHBhY2thZ2U6IG1pY3JvcGlwYDtcbiAgICBhd2FpdCBweW9kaWRlLmxvYWRQYWNrYWdlKFwibWljcm9waXBcIik7XG4gICAgY29uc3QgbWljcm9waXAgPSBhd2FpdCBweW9kaWRlLnB5aW1wb3J0KFwibWljcm9waXBcIik7XG4gICAgYXdhaXQgZGF0YS5wYWNrYWdlcy5wa2dzLm1hcCgocGtnKSA9PiAoKSA9PiB7XG4gICAgICBzdGF0dXNUZXh0LnRleHRDb250ZW50ID0gYERvd25sb2FkaW5nIHBhY2thZ2U6ICR7cGtnfWA7XG4gICAgICByZXR1cm4gbWljcm9waXAuaW5zdGFsbChwa2cpO1xuICAgIH0pLnJlZHVjZSgoY3VyLCBuZXh0KSA9PiBjdXIudGhlbihuZXh0KSwgUHJvbWlzZS5yZXNvbHZlKCkpO1xuICAgIGF3YWl0IG1pY3JvcGlwLmRlc3Ryb3koKTtcblxuICAgIC8vIERvd25sb2FkIGFuZCBpbnN0YWxsIHJlc291cmNlc1xuICAgIGF3YWl0IGZpbGVzLm1hcCgoZmlsZSkgPT4gYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbmFtZSA9IGZpbGUuc3Vic3RyaW5nKGZpbGUubGFzdEluZGV4T2YoJy8nKSArIDEpO1xuICAgICAgc3RhdHVzVGV4dC50ZXh0Q29udGVudCA9IGBEb3dubG9hZGluZyByZXNvdXJjZTogJHtuYW1lfWA7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGZpbGUpO1xuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENhbid0IGRvd25sb2FkIFxcYCR7ZmlsZX1cXGAuIEVycm9yICR7cmVzcG9uc2Uuc3RhdHVzfTogXCIke3Jlc3BvbnNlLnN0YXR1c1RleHR9XCIuYCk7XG4gICAgICB9XG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuYXJyYXlCdWZmZXIoKTtcblxuICAgICAgLy8gU3RvcmUgVVJMcyBpbiB0aGUgY3dkIHdpdGhvdXQgYW55IHN1YmRpcmVjdG9yeSBzdHJ1Y3R1cmVcbiAgICAgIGlmIChmaWxlLmluY2x1ZGVzKFwiOi8vXCIpKSB7XG4gICAgICAgIGZpbGUgPSBuYW1lO1xuICAgICAgfVxuXG4gICAgICAvLyBDb2xsYXBzZSBoaWdoZXIgZGlyZWN0b3J5IHN0cnVjdHVyZVxuICAgICAgZmlsZSA9IGNvbGxhcHNlUGF0aChmaWxlKTtcblxuICAgICAgLy8gQ3JlYXRlIGRpcmVjdG9yeSB0cmVlLCBpZ25vcmluZyBcImRpcmVjdG9yeSBleGlzdHNcIiBWRlMgZXJyb3JzXG4gICAgICBjb25zdCBwYXJ0cyA9IGZpbGUuc3BsaXQoJy8nKS5zbGljZSgwLCAtMSk7XG4gICAgICBsZXQgcGF0aCA9ICcnO1xuICAgICAgd2hpbGUgKHBhcnRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcGF0aCArPSBwYXJ0cy5zaGlmdCgpICsgJy8nO1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGF3YWl0IHB5b2RpZGUuRlMubWtkaXIocGF0aCk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBpZiAoZS5uYW1lICE9PSBcIkVycm5vRXJyb3JcIikgdGhyb3cgZTtcbiAgICAgICAgICBpZiAoZS5lcnJubyAhPT0gMjApIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yVGV4dFB0ciA9IGF3YWl0IHB5b2RpZGUuX21vZHVsZS5fc3RyZXJyb3IoZS5lcnJubyk7XG4gICAgICAgICAgICBjb25zdCBlcnJvclRleHQgPSBhd2FpdCBweW9kaWRlLl9tb2R1bGUuVVRGOFRvU3RyaW5nKGVycm9yVGV4dFB0cik7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZpbGVzeXN0ZW0gRXJyb3IgJHtlLmVycm5vfSBcIiR7ZXJyb3JUZXh0fVwiLmApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBXcml0ZSB0aGlzIGZpbGUgdG8gdGhlIFZGU1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IHB5b2RpZGUuRlMud3JpdGVGaWxlKGZpbGUsIG5ldyBVaW50OEFycmF5KGRhdGEpKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgaWYgKGUubmFtZSAhPT0gXCJFcnJub0Vycm9yXCIpIHRocm93IGU7XG4gICAgICAgIGNvbnN0IGVycm9yVGV4dFB0ciA9IGF3YWl0IHB5b2RpZGUuX21vZHVsZS5fc3RyZXJyb3IoZS5lcnJubyk7XG4gICAgICAgIGNvbnN0IGVycm9yVGV4dCA9IGF3YWl0IHB5b2RpZGUuX21vZHVsZS5VVEY4VG9TdHJpbmcoZXJyb3JUZXh0UHRyKTtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGaWxlc3lzdGVtIEVycm9yICR7ZS5lcnJub30gXCIke2Vycm9yVGV4dH1cIi5gKTtcbiAgICAgIH1cbiAgICB9KS5yZWR1Y2UoKGN1ciwgbmV4dCkgPT4gY3VyLnRoZW4obmV4dCksIFByb21pc2UucmVzb2x2ZSgpKTtcblxuICAgIHN0YXR1c1RleHQudGV4dENvbnRlbnQgPSBgUHlvZGlkZSBlbnZpcm9ubWVudCBzZXR1cGA7XG4gICAgYXdhaXQgc2V0dXBQeXRob24ocHlvZGlkZSk7XG5cbiAgICBzdGF0dXNUZXh0LnJlbW92ZSgpO1xuICAgIGlmIChzdGF0dXNDb250YWluZXIuY2hpbGRyZW4ubGVuZ3RoID09IDApIHtcbiAgICAgIHN0YXR1c0NvbnRhaW5lci5wYXJlbnROb2RlLnJlbW92ZSgpO1xuICAgIH1cbiAgICByZXR1cm4gcHlvZGlkZTtcbiAgfSkoKS5jYXRjaCgoZXJyKSA9PiB7XG4gICAgc3RhdHVzVGV4dC5zdHlsZS5jb2xvciA9IFwidmFyKC0tZXhlcmNpc2UtZWRpdG9yLWhsLWVyLCAjQUQwMDAwKVwiO1xuICAgIHN0YXR1c1RleHQudGV4dENvbnRlbnQgPSBlcnIubWVzc2FnZTtcbiAgICAvL2luZGljYXRvckNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLnNwaW5uZXItZ3Jvd1wiKS5jbGFzc0xpc3QuYWRkKFwiZC1ub25lXCIpO1xuICAgIHRocm93IGVycjtcbiAgfSk7XG5cbiAgLy8gS2VlcCB0cmFjayBvZiBpbml0aWFsIE9KUyBibG9jayByZW5kZXJcbiAgY29uc3QgcmVuZGVyZWRPanMgPSB7fTtcblxuICBjb25zdCBwcm9jZXNzID0gYXN5bmMgKGNvbnRleHQsIGlucHV0cykgPT4ge1xuICAgIGNvbnN0IHB5b2RpZGUgPSBhd2FpdCBweW9kaWRlUHJvbWlzZTtcbiAgICBjb25zdCBldmFsdWF0b3IgPSBuZXcgUHlvZGlkZUV2YWx1YXRvcihweW9kaWRlLCBjb250ZXh0KTtcbiAgICBhd2FpdCBldmFsdWF0b3IucHJvY2VzcyhpbnB1dHMpO1xuICAgIHJldHVybiBldmFsdWF0b3IuY29udGFpbmVyO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBweW9kaWRlUHJvbWlzZSxcbiAgICByZW5kZXJlZE9qcyxcbiAgICBwcm9jZXNzLFxuICB9O1xufVxuIn1dfQ==
</script>
<div id="exercise-loading-indicator" class="exercise-loading-indicator d-none d-flex align-items-center gap-2">
<div id="exercise-loading-status" class="d-flex gap-2">

</div>
<div class="spinner-grow spinner-grow-sm">

</div>
</div>
<script type="vfs-file">
WyIuL2ZpZ3MvU0RTLnBkYiIsIi4vZmlncy9jaG9sZXN0ZXJvbC5wZGIiXQ==
</script>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-care1987cluster" class="csl-entry" role="listitem">
Care, Christopher M. 1987. <span>“Cluster Size Distribution in a Monte Carlo Simulation of the Micellar Phase of an Amphiphile and Solvent Mixture.”</span> <em>Journal of the Chemical Society, Faraday Transactions 1: Physical Chemistry in Condensed Phases</em> 83 (9): 2905–12. <a href="https://pubs.rsc.org/en/content/articlehtml/1987/f1/f19878302905">https://pubs.rsc.org/en/content/articlehtml/1987/f1/f19878302905</a>.
</div>
<div id="ref-jones2002soft" class="csl-entry" role="listitem">
Jones, Richard AL. 2002. <em>Soft Condensed Matter</em>. Vol. 6. Oxford University Press. <a href="https://bris.on.worldcat.org/oclc/48753186">https://bris.on.worldcat.org/oclc/48753186</a>.
</div>
<div id="ref-wildingturciPRR2025" class="csl-entry" role="listitem">
Wilding, Nigel B., and Francesco Turci. 2025. <span>“Origin of the Inverse Temperature Dependence of Hydrophobic Attraction.”</span> <em>Phys. Rev. Res.</em> 7 (June): L022079. <a href="https://doi.org/10.1103/66lz-1yw9">https://doi.org/10.1103/66lz-1yw9</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiB0ZW1wZXJhdHVyZSA9IElucHV0cy5yYW5nZShbMC4wMSwgMl0sIHtzdGVwOiAwLjA1LCBsYWJlbDogXCJUZW1wZXJhdHVyZSAoa1QpXCIsIHZhbHVlOiAwLjV9KVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIG51bUNoYWlucyA9IElucHV0cy5yYW5nZShbMywgMzAwXSwge3N0ZXA6IDEwLCBsYWJlbDogXCJOdW1iZXIgb2YgQ2hhaW5zXCIsIHZhbHVlOiAxMDB9KVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0zIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiLy8gVGhpcyBpcyBPYnNlcnZhYmxlSlMgY29kZSAgXG4vLyBZb3UgY2FuIHJ1biBhdCBvYnNlcnZhYmxlZWhxLmNvbSBvciBjb252ZXJ0IGl0IHRvIGFuIGVxdWl2YWxlbnQgKGFuZCBmYXN0ZXI/KSBQeXRob24gdmVyc2lvbiBpZiB5b3UgbGlrZVxudmlld29mIHNpbXVsYXRpb24gPSB7XG4gICAgLy8gLS0tIFBhcmFtZXRlcnMgLS0tXG4gICAgY29uc3Qgd2lkdGggPSA0MCwgaGVpZ2h0ID0gNDA7XG4gICAgY29uc3QgY2hhaW5MZW5ndGggPSAzO1xuICAgIGNvbnN0IGNoYWluc1RvQ3JlYXRlID0gbnVtQ2hhaW5zO1xuICAgIGNvbnN0IFQgPSB0ZW1wZXJhdHVyZTtcbiAgICAvLyBjb25zdCBudW1DaGFpbnMgPSAxMDtcbiAgICBjb25zdCBFX1RTID0gMS4wOyAgICAgLy8gdGFpbC1zb2x2ZW50IGVuZXJneSAoc29sdm9waG9iaWMpXG4gICAgY29uc3QgRV9IUyA9IC0xLjU7ICAgIC8vIGhlYWQtc29sdmVudCBlbmVyZ3kgKHNvbHZvcGhpbGljKVxuICAgIC8vIGNvbnN0IFQgPSAwLjE7ICAgICAgICAvLyB0ZW1wZXJhdHVyZSAoa1QgdW5pdHMpXG5cbiAgICAvLyAtLS0gSW5pdGlhbGl6ZSBncmlkIGFuZCBjaGFpbnMgLS0tXG4gICAgbGV0IGdyaWQgPSBBcnJheS5mcm9tKHtsZW5ndGg6IHdpZHRofSwgKCkgPT4gQXJyYXkoaGVpZ2h0KS5maWxsKG51bGwpKTtcbiAgICBsZXQgY2hhaW5zID0gW107XG5cbiAgICAvLyBQZXJpb2RpYyBib3VuZGFyeSBoZWxwZXJcbiAgICBmdW5jdGlvbiBtb2QobiwgbSkgeyByZXR1cm4gKChuICUgbSkgKyBtKSAlIG07IH1cblxuICAgIGZ1bmN0aW9uIGdldE5laWdoYm9ycyh4LCB5KSB7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICB7eDogbW9kKHggLSAxLCB3aWR0aCksIHk6IHl9LFxuICAgICAgICAgICAge3g6IG1vZCh4ICsgMSwgd2lkdGgpLCB5OiB5fSxcbiAgICAgICAgICAgIHt4OiB4LCB5OiBtb2QoeSAtIDEsIGhlaWdodCl9LFxuICAgICAgICAgICAge3g6IHgsIHk6IG1vZCh5ICsgMSwgaGVpZ2h0KX1cbiAgICAgICAgXTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwbGFjZUNoYWlucygpIHtcbiAgICAgICAgZm9yIChsZXQgaWQgPSAwOyBpZCA8IG51bUNoYWluczsgaWQrKykge1xuICAgICAgICAgICAgZm9yIChsZXQgdHJpZXMgPSAwOyB0cmllcyA8IDEwMDsgdHJpZXMrKykge1xuICAgICAgICAgICAgICAgIGxldCB4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogd2lkdGgpO1xuICAgICAgICAgICAgICAgIGxldCB5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogaGVpZ2h0KTtcbiAgICAgICAgICAgICAgICBpZiAoZ3JpZFt4XVt5XSkgY29udGludWU7XG5cbiAgICAgICAgICAgICAgICBsZXQgY2hhaW4gPSBbe3gsIHksIHR5cGU6ICdoZWFkJ31dO1xuICAgICAgICAgICAgICAgIGdyaWRbeF1beV0gPSB7aWQsIHR5cGU6ICdoZWFkJ307XG4gICAgICAgICAgICAgICAgbGV0IG9rID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgY2hhaW5MZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBsZXQgbGFzdCA9IGNoYWluW2NoYWluLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICAgICAgICBsZXQgbmJzID0gZ2V0TmVpZ2hib3JzKGxhc3QueCwgbGFzdC55KS5maWx0ZXIocCA9PiAhZ3JpZFtwLnhdW3AueV0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAobmJzLmxlbmd0aCA9PT0gMCkgeyBvayA9IGZhbHNlOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgICBsZXQgbmV4dCA9IG5ic1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBuYnMubGVuZ3RoKV07XG4gICAgICAgICAgICAgICAgICAgIGNoYWluLnB1c2goey4uLm5leHQsIHR5cGU6ICd0YWlsJ30pO1xuICAgICAgICAgICAgICAgICAgICBncmlkW25leHQueF1bbmV4dC55XSA9IHtpZCwgdHlwZTogJ3RhaWwnfTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAob2spIHsgY2hhaW5zLnB1c2goe2lkLCBzZWdtZW50czogY2hhaW59KTsgYnJlYWs7IH1cbiAgICAgICAgICAgICAgICBlbHNlIHsgY2hhaW4uZm9yRWFjaChwID0+IGdyaWRbcC54XVtwLnldID0gbnVsbCk7IH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGVuZXJneShzZWcpIHtcbiAgICAgICAgbGV0IHNvbHZlbnROYnMgPSBnZXROZWlnaGJvcnMoc2VnLngsIHNlZy55KS5maWx0ZXIocCA9PiAhZ3JpZFtwLnhdW3AueV0pLmxlbmd0aDtcbiAgICAgICAgcmV0dXJuIHNlZy50eXBlID09PSAnaGVhZCcgPyBzb2x2ZW50TmJzICogRV9IUyA6IHNvbHZlbnROYnMgKiBFX1RTO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGF0dGVtcHRNb3ZlKGNoYWluKSB7XG4gICAgICAgIGNvbnN0IGZvcndhcmQgPSBNYXRoLnJhbmRvbSgpIDwgMC41O1xuICAgICAgICBjb25zdCB0YWlsID0gZm9yd2FyZCA/IGNoYWluLnNlZ21lbnRzWzBdIDogY2hhaW4uc2VnbWVudHMuYXQoLTEpO1xuICAgICAgICBjb25zdCBoZWFkID0gZm9yd2FyZCA/IGNoYWluLnNlZ21lbnRzLmF0KC0xKSA6IGNoYWluLnNlZ21lbnRzWzBdO1xuICAgICAgICBjb25zdCBvcHRpb25zID0gZ2V0TmVpZ2hib3JzKGhlYWQueCwgaGVhZC55KS5maWx0ZXIocCA9PiAhZ3JpZFtwLnhdW3AueV0pO1xuXG4gICAgICAgIGlmIChvcHRpb25zLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuICAgICAgICBjb25zdCBuZXh0ID0gb3B0aW9uc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBvcHRpb25zLmxlbmd0aCldO1xuXG4gICAgICAgIGNvbnN0IGRFX29sZCA9IGVuZXJneSh0YWlsKTtcbiAgICAgICAgZ3JpZFt0YWlsLnhdW3RhaWwueV0gPSBudWxsO1xuICAgICAgICBjb25zdCBkRV9uZXcgPSBlbmVyZ3koey4uLm5leHQsIHR5cGU6IHRhaWwudHlwZX0pO1xuICAgICAgICBncmlkW3RhaWwueF1bdGFpbC55XSA9IHtpZDogY2hhaW4uaWQsIHR5cGU6IHRhaWwudHlwZX07XG5cbiAgICAgICAgY29uc3QgZGVsdGFVID0gZEVfbmV3IC0gZEVfb2xkO1xuICAgICAgICBjb25zdCBhY2NlcHQgPSBkZWx0YVUgPCAwIHx8IE1hdGgucmFuZG9tKCkgPCBNYXRoLmV4cCgtZGVsdGFVIC8gVCk7XG5cbiAgICAgICAgaWYgKGFjY2VwdCkge1xuICAgICAgICAgICAgZ3JpZFt0YWlsLnhdW3RhaWwueV0gPSBudWxsO1xuICAgICAgICAgICAgZ3JpZFtuZXh0LnhdW25leHQueV0gPSB7aWQ6IGNoYWluLmlkLCB0eXBlOiB0YWlsLnR5cGV9O1xuICAgICAgICAgICAgaWYgKGZvcndhcmQpIHtcbiAgICAgICAgICAgICAgICBjaGFpbi5zZWdtZW50cy5zaGlmdCgpO1xuICAgICAgICAgICAgICAgIGNoYWluLnNlZ21lbnRzLnB1c2goey4uLm5leHQsIHR5cGU6IHRhaWwudHlwZX0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjaGFpbi5zZWdtZW50cy5wb3AoKTtcbiAgICAgICAgICAgICAgICBjaGFpbi5zZWdtZW50cy51bnNoaWZ0KHsuLi5uZXh0LCB0eXBlOiB0YWlsLnR5cGV9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIC0tLSBWaXN1YWxpemF0aW9uIC0tLVxuICAgIGNvbnN0IHN2ZyA9IGQzLmNyZWF0ZShcInN2Z1wiKVxuICAgICAgICAuYXR0cihcInZpZXdCb3hcIiwgYDAgMCAke3dpZHRofSAke2hlaWdodH1gKVxuICAgICAgICAuc3R5bGUoXCJ3aWR0aFwiLCBcIjQwMHB4XCIpXG4gICAgICAgIC5zdHlsZShcImhlaWdodFwiLCBcIjQwMHB4XCIpXG4gICAgICAgIC5zdHlsZShcImJvcmRlclwiLCBcIjFweCBzb2xpZCAjY2NjXCIpO1xuXG4gICAgY29uc3QgZyA9IHN2Zy5hcHBlbmQoXCJnXCIpO1xuXG4gICAgZnVuY3Rpb24gZHJhdygpIHtcbiAgICAgICAgY29uc3QgZGF0YSA9IGNoYWlucy5mbGF0TWFwKGMgPT4gYy5zZWdtZW50cyk7XG4gICAgICAgIGcuc2VsZWN0QWxsKFwiY2lyY2xlXCIpXG4gICAgICAgICAgICAuZGF0YShkYXRhLCBkID0+IGAke2QueH0tJHtkLnl9YClcbiAgICAgICAgICAgIC5qb2luKFwiY2lyY2xlXCIpXG4gICAgICAgICAgICAuYXR0cihcImN4XCIsIGQgPT4gZC54ICsgMC41KVxuICAgICAgICAgICAgLmF0dHIoXCJjeVwiLCBkID0+IGQueSArIDAuNSlcbiAgICAgICAgICAgIC5hdHRyKFwiclwiLCAwLjQ1KVxuICAgICAgICAgICAgLmF0dHIoXCJmaWxsXCIsIGQgPT4gZC50eXBlID09PSBcImhlYWRcIiA/IFwiYmx1ZVwiIDogXCJyZWRcIik7XG4gICAgfVxuXG4gICAgLy8gLS0tIE1haW4gTG9vcCAtLS1cbiAgICBwbGFjZUNoYWlucygpO1xuICAgIGRyYXcoKTtcblxuICAgIGxldCBydW5uaW5nID0gdHJ1ZTtcbiAgICBjb25zdCBidXR0b24gPSBodG1sYDxidXR0b24+4o+4IFBhdXNlPC9idXR0b24+YDtcbiAgICBidXR0b24ub25jbGljayA9ICgpID0+IHtcbiAgICAgICAgcnVubmluZyA9ICFydW5uaW5nO1xuICAgICAgICBidXR0b24udGV4dENvbnRlbnQgPSBydW5uaW5nID8gXCLij7ggUGF1c2VcIiA6IFwi4pa2IFJlc3VtZVwiO1xuICAgIH07XG5cbiAgICAoYXN5bmMgKCkgPT4ge1xuICAgICAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICAgICAgaWYgKHJ1bm5pbmcpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNoYWlucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjID0gY2hhaW5zW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGNoYWlucy5sZW5ndGgpXTtcbiAgICAgICAgICAgICAgICAgICAgYXR0ZW1wdE1vdmUoYyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGRyYXcoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHIgPT4gc2V0VGltZW91dChyLCA1MCkpO1xuICAgICAgICB9XG4gICAgfSkoKTtcblxuICAgIHJldHVybiBodG1sYDxkaXY+JHtidXR0b259PGJyPiR7c3ZnLm5vZGUoKX08L2Rpdj5gO1xufVxuXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3RlbXBlcmF0dXJlJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ251bUNoYWlucycpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdzaW11bGF0aW9uJykifV19
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../soft-matter";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="../soft-matter/soft-matter_liquidcrystals.html" class="pagination-link" aria-label="Liquid crystals">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Liquid crystals</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../soft-matter/soft-matter_glasses.html" class="pagination-link" aria-label="Arrested states">
        <span class="nav-page-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Arrested states</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>