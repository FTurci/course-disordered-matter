<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>15&nbsp; Colloids</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../soft-matter/soft-matter_polymers.html" rel="next">
<link href="../soft-matter/soft-matter_intro.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-f9e9f27e2f64dd25e94c2742b294698a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/live-runtime/live-runtime.js" type="module"></script>
<link href="../site_libs/quarto-contrib/live-runtime/live-runtime.css" rel="stylesheet">
<script src="../site_libs/quarto-contrib/videojs/video.min.js"></script>
<link href="../site_libs/quarto-contrib/videojs/video-js.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="module" src="../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked slimcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../soft-matter/soft-matter_intro.html">Complex disordered systems</a></li><li class="breadcrumb-item"><a href="../soft-matter/soft-matter_colloids.html"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Colloids</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../courselogo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reading.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Recommended texts</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Unifying concepts</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to phase behaviour</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/background.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Background concepts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/approach-to-criticality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The approach to criticality</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/Ising-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">The Ising model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/mean-field-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Mean field theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/lattice-gas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">The lattice gas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/scaling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">The static scaling hypothesis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/rg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Universality and renormalization group theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/rg-effective-coupling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">RG- the effective coupling viewpoint</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/nucleation-and-growth.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Nucleation, growth and spinodal decomposition</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/master-equation-and-diffusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Introduction to stochastic processes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/Brownian-and-Langevin-dynamics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Brownian and Langevin dynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/dynamics-of-fluctuations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Dynamics of fluctuations (non-examinable)</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Complex disordered systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../soft-matter/soft-matter_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Entropy matters</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../soft-matter/soft-matter_colloids.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Colloids</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../soft-matter/soft-matter_polymers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Polymers</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../soft-matter/soft-matter_liquidcrystals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Liquid crystals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../soft-matter/soft-matter_surfactants.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Surfactants</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../soft-matter/soft-matter_glasses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Arrested states</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../soft-matter/soft-matter_active.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Active matter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../soft-matter/soft-matter_problems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Problems</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Experimental techniques</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../revision_guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Revision guide</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/concepts_map.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Concept maps</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#kinds-of-colloids" id="toc-kinds-of-colloids" class="nav-link active" data-scroll-target="#kinds-of-colloids"><span class="header-section-number">15.1</span> Kinds of colloids</a></li>
  <li><a href="#stability-of-colloids-and-colloid-colloid-interactions" id="toc-stability-of-colloids-and-colloid-colloid-interactions" class="nav-link" data-scroll-target="#stability-of-colloids-and-colloid-colloid-interactions"><span class="header-section-number">15.2</span> Stability of colloids and colloid-colloid interactions</a>
  <ul>
  <li><a href="#fundamental-and-effective-forces" id="toc-fundamental-and-effective-forces" class="nav-link" data-scroll-target="#fundamental-and-effective-forces"><span class="header-section-number">15.2.1</span> Fundamental and effective forces</a></li>
  <li><a href="#van-der-waals-interaction" id="toc-van-der-waals-interaction" class="nav-link" data-scroll-target="#van-der-waals-interaction"><span class="header-section-number">15.2.2</span> Van der Waals interaction</a></li>
  <li><a href="#double-layer-interaction" id="toc-double-layer-interaction" class="nav-link" data-scroll-target="#double-layer-interaction"><span class="header-section-number">15.2.3</span> Double-layer interaction</a></li>
  <li><a href="#steric-interactions-and-depletion-interactions" id="toc-steric-interactions-and-depletion-interactions" class="nav-link" data-scroll-target="#steric-interactions-and-depletion-interactions"><span class="header-section-number">15.2.4</span> Steric interactions and depletion interactions</a>
  <ul class="collapse">
  <li><a href="#a-simple-example-particles-in-a-one-dimensional-line-hard-rods" id="toc-a-simple-example-particles-in-a-one-dimensional-line-hard-rods" class="nav-link" data-scroll-target="#a-simple-example-particles-in-a-one-dimensional-line-hard-rods"><span class="header-section-number">15.2.4.1</span> A simple example: particles in a one-dimensional line (<em>hard rods</em>)</a></li>
  </ul></li>
  <li><a href="#sec-ao-potential" id="toc-sec-ao-potential" class="nav-link" data-scroll-target="#sec-ao-potential"><span class="header-section-number">15.2.5</span> Asakura-Oosawa depletion potential</a></li>
  </ul></li>
  <li><a href="#colloids-as-big-atoms" id="toc-colloids-as-big-atoms" class="nav-link" data-scroll-target="#colloids-as-big-atoms"><span class="header-section-number">15.3</span> Colloids as big atoms</a>
  <ul>
  <li><a href="#sec-hard-spheres" id="toc-sec-hard-spheres" class="nav-link" data-scroll-target="#sec-hard-spheres"><span class="header-section-number">15.3.1</span> The archetype: hard-spheres</a>
  <ul class="collapse">
  <li><a href="#phase-behaviour-of-hard-spheres" id="toc-phase-behaviour-of-hard-spheres" class="nav-link" data-scroll-target="#phase-behaviour-of-hard-spheres">Phase behaviour of hard spheres</a></li>
  <li><a href="#low-packing-fractions" id="toc-low-packing-fractions" class="nav-link" data-scroll-target="#low-packing-fractions">Low packing fractions</a></li>
  <li><a href="#dense-packing-metastability-and-crystalisation" id="toc-dense-packing-metastability-and-crystalisation" class="nav-link" data-scroll-target="#dense-packing-metastability-and-crystalisation">Dense packing: metastability and crystalisation</a></li>
  </ul></li>
  <li><a href="#beyond-hard-spheres-simple-liquids" id="toc-beyond-hard-spheres-simple-liquids" class="nav-link" data-scroll-target="#beyond-hard-spheres-simple-liquids"><span class="header-section-number">15.3.2</span> Beyond hard-spheres: simple liquids</a></li>
  </ul></li>
  <li><a href="#characterisation-of-colloidal-systems" id="toc-characterisation-of-colloidal-systems" class="nav-link" data-scroll-target="#characterisation-of-colloidal-systems"><span class="header-section-number">15.4</span> Characterisation of colloidal systems</a>
  <ul>
  <li><a href="#structural-properties-the-radial-distribution-function" id="toc-structural-properties-the-radial-distribution-function" class="nav-link" data-scroll-target="#structural-properties-the-radial-distribution-function"><span class="header-section-number">15.4.1</span> Structural properties: the radial distribution function</a></li>
  <li><a href="#dynamics-single-vs-collective-displacements" id="toc-dynamics-single-vs-collective-displacements" class="nav-link" data-scroll-target="#dynamics-single-vs-collective-displacements"><span class="header-section-number">15.4.2</span> Dynamics: single vs collective displacements</a>
  <ul class="collapse">
  <li><a href="#diffusion-and-interactions" id="toc-diffusion-and-interactions" class="nav-link" data-scroll-target="#diffusion-and-interactions"><span class="header-section-number">15.4.2.1</span> Diffusion and interactions</a></li>
  </ul></li>
  <li><a href="#stokes-einstein-relation" id="toc-stokes-einstein-relation" class="nav-link" data-scroll-target="#stokes-einstein-relation"><span class="header-section-number">15.4.3</span> Stokes-Einstein relation</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../soft-matter/soft-matter_intro.html">Complex disordered systems</a></li><li class="breadcrumb-item"><a href="../soft-matter/soft-matter_colloids.html"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Colloids</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Colloids</span></h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<div>
<div id="pyodide-1" class="exercise-cell">

</div>
<script type="pyodide-1-contents">
eyJhdHRyIjp7ImF1dG9ydW4iOnRydWUsImVjaG8iOmZhbHNlLCJlZGl0IjpmYWxzZSwiZXZhbCI6dHJ1ZX0sImNvZGUiOiIjIG1vZGlmeWluZyB0aGUgcGF0aCB0byBhZGQgdGhlIGNvZGUgZm9sZGVyXG5pbXBvcnQgc3lzXG5zeXMucGF0aC5pbnNlcnQoMCwgJ3NyYycpIn0=
</script>
</div>
<section id="kinds-of-colloids" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="kinds-of-colloids"><span class="header-section-number">15.1</span> Kinds of colloids</h2>
<p>Colloids are mixtures where one substance is dispersed throughout another. They consist of particles that are larger than typical molecules but small enough to remain suspended without settling. Examples include milk, fog, and paint.</p>
<p>Colloids can be classified based on the state of the <strong>dispersed phase</strong> and the <strong>dispersion medium</strong>. Depending on the particular mixture, one can obtain a wide variety of soft materials, with unique mechanical, optical, and thermal properties.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 21%">
<col style="width: 40%">
<col style="width: 36%">
</colgroup>
<thead>
<tr class="header">
<th>Dispersion Phase</th>
<th></th>
<th>Dispersion Medium</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>Solid</td>
<td>Liquid</td>
</tr>
<tr class="even">
<td>Solid</td>
<td><em>Solid suspension:</em><br>
pigmented plastics,<br>
stained glass,<br>
ruby glass, opal, pearl</td>
<td><em>Sol, colloidal suspension:</em><br>
metal sol,<br>
toothpaste, paint,<br>
ink, clay slurries, mud</td>
</tr>
<tr class="odd">
<td>Liquid</td>
<td><em>Solid emulsion:</em><br>
bituminous road paving,<br>
ice cream</td>
<td><em>Emulsion:</em><br>
milk, mayonnaise,<br>
butter, pharmaceutical creams</td>
</tr>
<tr class="even">
<td>Gas</td>
<td><em>Solid foam:</em><br>
zeolites, expanded polystyrene,<br>
‘silica gel’</td>
<td><em>Foam:</em><br>
froths, soap foam,<br>
fire-extinguisher foam</td>
</tr>
</tbody>
</table>
<p>Clearly, colloidal materials form an incredibly diverse class, and surround us in our everyday lives. Here are some visual examples from the table above:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/colloids.png" class="img-fluid figure-img"></p>
<figcaption>First row: opal, paint, smoke. Middle row: ice-cream (<em>gelato</em>), milk, fog. Bottom row: expanded polystyrene and foam. Source: unsplash.com</figcaption>
</figure>
</div>
<p>The <a href="https://goldbook.iupac.org/terms/view/C01172">IUPAC definition of colloids</a> is based on the idea that the particles are dispersed in a medium, creating a <em>subdivision</em> at the <strong>colloidal scale</strong>: approximately 1nm to 1µm.</p>
<p>The small sizes of colloids means that they are constantly subject to the collisions with the atom/molecules/particle of the medium, triggered by thermal fluctuations. Due to this, the colloids undergo <a href="../phase-transitions/Brownian-and-Langevin-dynamics.html">Brownian motion</a>. For each particle, the amount of energy received from the medium is of the order of <span class="math inline">\(k_B T\)</span> (the reference energy scale of thermal soft matter). This energy can be compared with the the potential energy to produce a dimensionless number, the <strong>gravitational Péclet number</strong></p>
<p><span class="math display">\[{\rm Pe}_g = \dfrac{\Delta m g R}{k_B T}\]</span></p>
<p>where <span class="math inline">\(R\)</span> is the radius of the colloid respectively, <span class="math inline">\(g\)</span> is the acceleration due to gravity, and <span class="math inline">\(\Delta m\)</span> is the <em>buoyant mass</em>, which for a spherical colloid is expressed as <span class="math inline">\(\Delta m = \dfrac{4\pi}{3}\Delta\rho R^3\)</span>, with <span class="math inline">\(\Delta \rho\)</span> being the density difference between the particle and the dispersion medium (the <em>solvent</em>). We have a colloidal suspension only when <span class="math inline">\({\rm Pe}_g \lesssim 1\)</span>, i.e.&nbsp;when Brownian motion is only marginally perturbed by the effects of gravity.</p>
</section>
<section id="stability-of-colloids-and-colloid-colloid-interactions" class="level2 page-columns page-full" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="stability-of-colloids-and-colloid-colloid-interactions"><span class="header-section-number">15.2</span> Stability of colloids and colloid-colloid interactions</h2>
<p>A colloidal dispersion is said to be <strong>stable</strong> if it is able to remain dispersed and Brownian for a long time (typically, significantly longer than the experimental observation time). Unstable colloids undergo aggregation or sedimentation due to the dominance of attractive forces or gravity.</p>
<p>For example, consider a colloidal suspension like milk. Milk is an emulsion where fat droplets are dispersed in water and stabilised by proteins. If lemon juice (an acid) is added, the dispersion medium (water) changes, the pH drops, and the emulsion is <em>destabilised</em>. This causes the proteins to coagulate, leading to the separation of curds (solid) and whey (liquid).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/Curds_and_whey.jpg" class="img-fluid figure-img"></p>
<figcaption>Curds and whey resulting from the destabilisation of milk, a colloidal emulsion. (Wikimedia)</figcaption>
</figure>
</div>
<p>It is clear from this example that the nature of the dispersed phase and the dispersed medium ultimately determine the stability of colloidal dispersions. What ultimately matters for the stability is whether the colloids have a propensity to aggregate or not. This propensity is quantified in terms of <strong>colloidal interactions</strong>.</p>
<section id="fundamental-and-effective-forces" class="level3" data-number="15.2.1">
<h3 data-number="15.2.1" class="anchored" data-anchor-id="fundamental-and-effective-forces"><span class="header-section-number">15.2.1</span> Fundamental and effective forces</h3>
<p>At the colloidal scales, only two kinds of fundamental forces are relevant: gravity and electro (and occasionally magneto) static forces. As we have seen above, when a system is truly colloidal, gravitational contributions are assumed to be small, so in effect for a non magnetic colloid (which is the vast majority of colloidal systems) only electrostatic forces are fundamentally important.</p>
<p>However, colloidal dispersions consist of large particles carrying many charges both in the dispersed phase and the surrounding medium, arranged disorderly at the atomic scale. This makes a microscopic description of all charges and the resulting electrostatic fields not only unfeasible but also ineffective for understanding colloidal systems in terms of key characteristics such as particle size, density, and spatial distribution. The fundamental issue is the one of time-scales: the motion of colloids is much slower than the motion of individual ions or molecules. Over such longer timescales, many interactions at the <strong>microscopic</strong> atomistic scale take place and we can think of taking averages to extract <strong>macroscopic</strong>, <strong>effective</strong> interactions at the colloidal scale <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<p>This is especially important due to <strong>quantum fluctuations</strong>: the uncertainty principle means that electron clouds around atoms are not fixed but exhibit intrinsic fluctuations in their charge distribution. Perturbative approaches allow us to capture the effective forces resulting from such fluctuations.</p>
<p>There are many examples of such effective forces <span class="citation" data-cites="lekkerkerker2024colloids">(<a href="#ref-lekkerkerker2024colloids" role="doc-biblioref">Lekkerkerker, Tuinier, and Vis 2024</a>)</span>. One you may already know is the Van der Waals interaction. For colloids, we have additional relevant forces, such as the double layer interaction and the depletion interaction. We detail them here below.</p>
</section>
<section id="van-der-waals-interaction" class="level3 page-columns page-full" data-number="15.2.2">
<h3 data-number="15.2.2" class="anchored" data-anchor-id="van-der-waals-interaction"><span class="header-section-number">15.2.2</span> Van der Waals interaction</h3>
<p>The London-van der Waals <strong>dispersion forces</strong> arise from the interaction between <strong>instantaneous dipoles</strong> in overall neutral atoms or molecules. We know from classical electrostatics that static dipoles interact via the dipole-dipole interaction, with a potential strength which decays like <span class="math inline">\(1/r^3\)</span>, where <span class="math inline">\(r\)</span> is the separation between two dipoles.</p>
<p>More in general, neutral atom or molecules have electronic clouds that are fluctuating and not symmetrically distributed, creating a <strong>temporary dipole</strong>. Such instantaneous dipole <strong>induces</strong> a dipole in a neighboring atom or molecule by distorting its electron cloud.</p>
<p>The interaction energy between two dipoles <span class="math inline">\(\mu_1\)</span> and <span class="math inline">\(\mu_2\)</span> separated by a distance <span class="math inline">\(r\)</span> is proportional to: <span class="math display">\[
U \propto -\frac{\mu_1 \mu_2}{r^3}
\]</span></p>

<div class="no-row-height column-margin column-container"><div class="">

</div></div><p>The dipole moments fluctuate due to quantum mechanical effects. The average interaction energy is derived using perturbation theory and is proportional to the polarisabilities <span class="math inline">\(\alpha_1\)</span> and <span class="math inline">\(\alpha_2\)</span> of the two particles:</p>
<div style="border: 2px solid red; padding: 1em; border-radius: 8px; background-color: transparent;">
<p><span class="math display">\[
    U(r) = -\frac{C}{r^6}
\]</span></p>
</div>
<p>where <span class="math inline">\(C \propto \alpha_1 \alpha_2\)</span> depends on the polarisabilities and ionization energies of the particles.</p>
<p>The resulting <span class="math inline">\(r^{-6}\)</span> dependence is also referred to as the <strong>London dispersion force</strong>, which can be derived within quantum-mechanical perturbation theory <span class="citation" data-cites="london1937general">(<a href="#ref-london1937general" role="doc-biblioref">London 1937</a>)</span>.</p>
<p>We can then assume to take two identical spherical colloids of radius <span class="math inline">\(R\)</span> at distance <span class="math inline">\(h\)</span> and that every volume element of such spheres interacts with the London dispersion force (see the semi-classical approach of Hamaker <span class="citation" data-cites="hamaker1937london">Hamaker (<a href="#ref-hamaker1937london" role="doc-biblioref">1937</a>)</span> for illustration). Integrating over all volume elements yields the collodial spheres <strong>Van der Waals attractive potential</strong> in the form</p>
<div style="border: 2px solid red; padding: 1em; border-radius: 8px; background-color: transparent;">
<p><span class="math display">\[W_{wdW}(h)=-\dfrac{A-H}{g}f(h/R)\]</span></p>
</div>
<p>where <span class="math inline">\(A_H\)</span> is the <strong>Hamaker constant</strong> and <span class="math inline">\(f(h/R)\)</span> is</p>
<p><span class="math display">\[f(h/R) = \left[ \frac{2R^2}{h^2 - 4R^2} + \frac{2R^2}{h^2} + \ln\left( \frac{h^2 - 4R^2}{h^2} \right) \right]\]</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Sketch of a derivation of colloid-colloid Van der Waals potential
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Each volume element in one sphere interacts with each in the other sphere via:</p>
<p><span class="math display">\[
\phi(r) = -\frac{C}{r^6}
\]</span></p>
<p>So the total interaction energy is:</p>
<p><span class="math display">\[
U(h) = -C \iint \frac{1}{|\mathbf{r}_1 - \mathbf{r}_2|^6} \, dV_1 \, dV_2
\]</span></p>
<p>Let:</p>
<ul>
<li>Sphere 1 be centered at <span class="math inline">\((0, 0, 0)\)</span>,</li>
<li>Sphere 2 be centered at <span class="math inline">\((0, 0, h)\)</span>,</li>
<li><span class="math inline">\(\mathbf{r}_1 = \mathbf{r}\)</span>, <span class="math inline">\(\mathbf{r}_2 = \mathbf{r}'\)</span></li>
</ul>
<p>Then <span class="math inline">\(|\mathbf{r}_1 - \mathbf{r}_2| = |\mathbf{r} - \mathbf{r}'|\)</span>, and the integral becomes:</p>
<p><span class="math display">\[
U(h) = -C \iiint_{|\mathbf{r}| \leq R} \iiint_{|\mathbf{r}' - h\hat{z}| \leq R} \frac{1}{|\mathbf{r} - \mathbf{r}'|^6} \, d^3\mathbf{r} \, d^3\mathbf{r}'
\]</span></p>
<p>Hamaker evaluated this by integrating over the <strong>densities of interacting atoms</strong> with number density <span class="math inline">\(\rho\)</span> in both spheres. The result:</p>
<p><span class="math display">\[
U(h) = -\rho^2 C \iint \frac{1}{|\mathbf{r}_1 - \mathbf{r}_2|^6} \, dV_1 \, dV_2
\]</span></p>
<p>Defining the <strong>Hamaker constant</strong>:</p>
<p><span class="math display">\[
A_H = \pi^2 \rho^2 C
\]</span></p>
<p>So,</p>
<p><span class="math display">\[
U(h) = -\frac{A_H}{\pi^2} \iint \frac{1}{|\mathbf{r}_1 - \mathbf{r}_2|^6} \, dV_1 \, dV_2
\]</span></p>
<p>This six-dimensional integral can be evaluated analytically for spheres, yielding:</p>
<p><span class="math display">\[
U(h) = -\frac{A_H}{6} \left[ \frac{2R^2}{h^2 - 4R^2} + \frac{2R^2}{h^2} + \ln\left( \frac{h^2 - 4R^2}{h^2} \right) \right]
\]</span></p>
</div>
</div>
</div>
<div>
<div id="pyodide-2" class="exercise-cell">

</div>
<script type="pyodide-2-contents">
eyJhdHRyIjp7ImF1dG9ydW4iOnRydWUsImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiaW1wb3J0IG51bXB5IGFzIG5wXG5pbXBvcnQgcGxvdHRpbmdcbiMgcGFyYW1ldGVyczogY2hhbmdlIHRoZW0gdG8gZXhwbG9yZSB0aGUgaW50ZXJhY3Rpb24hXG5SID0gNS4wICAjIFJhZGl1cyBvZiB0aGUgY29sbG9pZFxuQV9IID0gMWUtMjAgICMgSGFtYWtlciBjb25zdGFudCAoaW4gSm91bGVzKVxuaCA9IG5wLmxpbnNwYWNlKDIuMDEgKiBSLCAxMCtSKjIsIDEwMDApICAjIFNlcGFyYXRpb24gZGlzdGFuY2UgKGggPiAyUilcbiMgVmFuIGRlciBXYWFscyBwb3RlbnRpYWxcbmRlZiB2YW5fZGVyX3dhYWxzX3BvdGVudGlhbChoLCBSLCBBX0gpOlxuICAgIGZfaF9SID0gKDIgKiBSKioyIC8gKGgqKjIgLSA0ICogUioqMikpICsgKDIgKiBSKioyIC8gaCoqMikgKyBucC5sb2coKGgqKjIgLSA0ICogUioqMikgLyBoKioyKVxuICAgIHJldHVybiAtQV9IICogZl9oX1JcblxuIyBjb21wdXRlIHBvdGVudGlhbFxuV192ZFcgPSB2YW5fZGVyX3dhYWxzX3BvdGVudGlhbChoLCBSLCBBX0gpXG4jIGNvbnZlbmllbmNlIHBsb3R0aW5nIGZ1bmN0aW9uLCB5b3UgY2FuIHVzZSBtYXRwbG90bGliIGlmIHlvdSBwcmVmZXJcbnBsb3R0aW5nLnNpbXBsZV9wbG90KGgsV192ZFcpIn0=
</script>
</div>
<p>Van der Waals interactions are considered to be <strong>short-range</strong> forces in the sense that their decay rate(e.g.&nbsp;London’s <span class="math inline">\(1/r^6\)</span>) is much faster than Coulombic interactions (<span class="math inline">\(1/r\)</span>). Importantly, since their origin resides in the fluctuation of charges on the colloids, their strength is <em>not additive</em>: simply summing all the pairwise interactions does not fully accurately account for man-body effects. We often rely on such two-body approximations, but we should be aware that they are a simplified scenario.</p>
</section>
<section id="double-layer-interaction" class="level3" data-number="15.2.3">
<h3 data-number="15.2.3" class="anchored" data-anchor-id="double-layer-interaction"><span class="header-section-number">15.2.3</span> Double-layer interaction</h3>
<p>Colloids are often charged. The solution they are immersed also has an <strong>inhomogeneous</strong> distribution of ions: there will be</p>
<ul>
<li><p><strong>co-ions</strong> (same charge as the colloid) that will be pushed away from the colloid surface, while</p></li>
<li><p><strong>counter-ions</strong> (opposite charge) will accumulate at the surface.</p></li>
</ul>
<p>These two different concentrations of oppositely charged ions form what is called a <strong>double layer</strong> and its property (such as its width) are obviously controlled by the number of ions in the solvent, which can be tuned by adding or removing, for example, salts.</p>
<p>Suppose we now have two colloids of the same size and charges in the solvent. Th charges in their double layers will interact giving rise to a <strong>repulsive interaction</strong>. This interaction is referred to as <strong>screened-Coulomb</strong> (as the electrostatic interaction is <em>screened by the presence of the ions</em> or <strong>double layer repulsion.</strong> We are not going to derive it, but it can be shown that, for a colloid of radius <span class="math inline">\(R\)</span> in solvent with salt density <span class="math inline">\(n_s\)</span> it can approximated by an exponential decay</p>
<div style="border: 2px solid red; padding: 1em; border-radius: 8px; background-color: transparent;">
<p><span class="math display">\[
W_{DR}(h) = B\dfrac{R}{\lambda_B}\exp{(-h/\lambda_D)}
\]</span></p>
</div>
<p>where <span class="math inline">\(\lambda_D\)</span> is called the <strong>Debye length</strong></p>
<p><span class="math display">\[
\lambda_D = \sqrt{\dfrac{1}{8\pi\lambda_B n_s}}
\]</span></p>
<p>while <span class="math inline">\(\lambda_B\)</span> is the <strong>Bjerrum length</strong>, which is itself derived from the characteristic distance at which two elementary charges have energy <span class="math inline">\(k_B T\)</span> <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p><span class="math display">\[
\lambda_B = \dfrac{e^2}{4\pi \varepsilon_0\varepsilon_r k_B T}
\]</span></p>
<p>The coefficient <span class="math inline">\(B\)</span> is a material properties that depend on the surface potential. We are not going more into the details of these features, which are important for the design of colloidal experiments.</p>
<hr>
<p>From our point of view, what matters is that identical colloids in solution appear to have two interactions of opposite sign</p>
<ul>
<li><p>a van der Waals components, typically attractive and emergent from induced dipole -dipole ineractions emerging from quantum fluctuations of the electronic clouds</p></li>
<li><p>a double layer component, repulsive in nature, and resulting from the electrostatic repulsions induced by ions and counterions</p></li>
</ul>
<p>The <strong>sum</strong> of the two gives rise to the <strong>DLVO</strong> (Derjaguin–Landau–Verwey–Overbeek) <strong>interaction</strong> which is an elementary model for colloid stability and aggregation.</p>
<div>
<div id="pyodide-3" class="exercise-cell">

</div>
<script type="pyodide-3-contents">
eyJhdHRyIjp7ImF1dG9ydW4iOnRydWUsImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiXG5pbXBvcnQgbnVtcHkgYXMgbnBcbmltcG9ydCBtYXRwbG90bGliLnB5cGxvdCBhcyBwbHRcblxuUiA9IDEuMCAgIyBSYWRpdXMgb2YgdGhlIGNvbGxvaWQgKG1pY3JvbikgXG5oID0gbnAubGluc3BhY2UoMi4wMSAqIFIsIDIrUioyLCAxMDAwKSAgIyBTZXBhcmF0aW9uIGRpc3RhbmNlIChoID4gMlIpXG4jIFZhbiBkZXIgV2FhbHMgYXR0cmFjdGl2ZSBwb3RlbnRpYWxcbmRlZiB2YW5fZGVyX3dhYWxzX3BvdGVudGlhbChoLCBSLCBBX0gpOlxuICAgIGZfaF9SID0gKDIgKiBSKioyIC8gKGgqKjIgLSA0ICogUioqMikpICsgKDIgKiBSKioyIC8gaCoqMikgKyBucC5sb2coKGgqKjIgLSA0ICogUioqMikgLyBoKioyKVxuICAgIHJldHVybiAtQV9IICogZl9oX1JcbiMgZG91YmxlIGxheWVyIHJlcHVsc2l2ZSBwb3RlbnRpYWxcbmRlZiBkb3VibGVfbGF5ZXIoaCwgUixCLG5zICk6XG4gICAgbGFtYmRhQiA9IDAuMDAwNyAjIHR5cGljYWwgQmplcnJ1bSBsZW5ndGggZm9yIHdhdGVyIGF0IDI1IGRlZ3JlZXMgKG1pY3JvbilcbiAgICBsYW1iZGFEID0gbnAuc3FydCgxLyg4Km5wLnBpKmxhbWJkYUIqbnMpKVxuICAgIHByaW50KFwiRGVieWUgbGVuZ3RoIG9mXCIsIGxhbWJkYUQpXG4gICAgcmV0dXJuICBCKlIvbGFtYmRhQipucC5leHAoLWgvbGFtYmRhRClcbiJ9
</script>
</div>
<div>
<div id="pyodide-4" class="exercise-cell">

</div>
<script type="pyodide-4-contents">
eyJhdHRyIjp7ImF1dG9ydW4iOnRydWUsImNhcHRpb24iOiJETFZPIHBvdGVudGlhbCBbcHJlc3MgY3RybC9jbWQgW0VOVEVSXSB0byBydW5dIiwiZWRpdCI6dHJ1ZSwiZXZhbCI6dHJ1ZX0sImNvZGUiOiIjIHBhcmFtZXRlcnM6IENIQU5HRSB0aGVtIHRvIGV4cGxvcmUgdGhlIGludGVyYWN0aW9uIVxuXG5BX0ggPSAxLjAgICMgSGFtYWtlciBjb25zdGFudCAoa0JUKVxuQiA9IDUwLjAgIyBkb3VibGUgbGF5ZXIgZW5lcmd5IHNjYWxlIFxuc2FsdF9ucyA9IDIwMDAgIyBzYWx0IGNvbmNlbnRyYXRpb24gKHBhcnRpY2xlcy9taWNyb25eMylcblxuIyBjb21wdXRlIHBvdGVudGlhbHNcbldfdmRXID0gdmFuX2Rlcl93YWFsc19wb3RlbnRpYWwoaCwgUiwgQV9IKVxuV19EUiA9IGRvdWJsZV9sYXllcihoLCBSLCBCLHNhbHRfbnMpXG5ETFZPID0gV192ZFcrV19EUlxuXG5cbmltcG9ydCBwbG90dGluZ1xucGxvdHRpbmcubXVsdGlfcGxvdChoLCBXX3ZkVywgV19EUixETFZPLFxuICAgIHhsYWJlbD1cImggW8K1bV1cIiwgeWxhYmVsPVwiSW50ZXJhY3Rpb24gc3RyZW5ndGggW2tCVF1cIilcbiMgbmljZXIgY2xpcGluZ1xueWxpbSAgPSBtYXgoRExWTy5tYXgoKSwwLjUpXG5wbHQueWxpbSgteWxpbSoxLjEsIHlsaW0qMS4xKVxucGx0LnNob3coKSJ9
</script>
</div>
<div class="callout callout-style-simple callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Activity
</div>
</div>
<div class="callout-body-container callout-body">
<p>Modify the script above and test graphically that:</p>
<ol type="1">
<li>When the salt concentration is low, the double layer repulsion dominates the DVLO interaction</li>
<li>There are salt concentrations where two minima occur in the DLVO potential: on at very close distance (dominated by the Van der Waals attraction) and one, much shallower, at intermediate distances comparable to <span class="math inline">\(2(R+\lambda_D)\)</span> . This minimum can lead to weak aggregation of colloids</li>
<li>Large salt concentrations depress the DVLO maximum altogether and eventually the Van der Waals interaction dominates.</li>
</ol>
</div>
</div>
</section>
<section id="steric-interactions-and-depletion-interactions" class="level3" data-number="15.2.4">
<h3 data-number="15.2.4" class="anchored" data-anchor-id="steric-interactions-and-depletion-interactions"><span class="header-section-number">15.2.4</span> Steric interactions and depletion interactions</h3>
<p>We have seen that quantum fluctuations from the uncertainty principle can be recast via a semi-classical approach into effective short-range interactions (van-der Waals). Another fundamental quantum principle – Paulis’s <strong>exclusion principle</strong> – is also at the source of key effective interactions that can be understood in a semi-classical picture. Indeed, the main consequence of the exclusion principle is that since electrons cannot occupy the same quantum state, there are minimal distances below which atoms cannot be brought together.</p>
<p>This simply means that as we take a pair of atoms, below a certain distance they <strong>repel</strong> each other with very strong forces, even in the absence of double layer interactions. These <strong>repulsive interactions</strong> can be approximated in various ways: their strength depends on the details of the atoms and hence, in the case of colloids, on the details of the materials composing the colloids. We call these excluded volume interactions <strong>steric interactions</strong><a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>.</p>
<p>These fundamentally repulsive interactions mean that that, in a system with <span class="math inline">\(N\)</span> colloids, an additional <span class="math inline">\(N+1\)</span> colloid does not have access to the entire configuration space: there is a large <strong>excluded volume</strong> due to the presence of the other colloids.</p>
<p>What is intriguing of these interactions is that, even if they are purely repulsive, they can collectively give rise to effective attractive interactions: <strong>attraction through repulsion</strong>.</p>
<section id="a-simple-example-particles-in-a-one-dimensional-line-hard-rods" class="level4" data-number="15.2.4.1">
<h4 data-number="15.2.4.1" class="anchored" data-anchor-id="a-simple-example-particles-in-a-one-dimensional-line-hard-rods"><span class="header-section-number">15.2.4.1</span> A simple example: particles in a one-dimensional line (<em>hard rods</em>)</h4>
<p>As an introductory example, let us consider a very simple, idealised system of purely repulsive objects. Let us confine them along a one dimensional line, bounded by hard (repulsive and impenetrable) walls seperated by the distance <span class="math inline">\(L\)</span>. Assume the objects to be <span class="math inline">\(N\)</span> spheres of diameter <span class="math inline">\(d\)</span>, or (equivalently) <em>hard rods</em> of length <span class="math inline">\(d\)</span>. They cannot overlap so, once they are placed along the line, their order cannot change.</p>
<p>What we want to know is how these hard objects, that interact solely via repulsive interactions, distribute themselves along the line. The problem is a classic of statistical mechanics and thanks to its one-dimensional nature can be addrssed extensively using analytical methods.</p>
<p>Here we take a more algorithmic approach, and directly sample the probability density distribution <span class="math inline">\(\rho(x)\)</span> of finding a particle center at position <span class="math inline">\(x\)</span>.</p>
<p>To do so, we do the following:</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Algorithm
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>position the particles in a valid configuration (no overlaps with other particles or the walls)</li>
<li>pick a particle at random</li>
<li>move it slightly along the line</li>
<li>test the if the new position is valid (no overlaps)</li>
<li>if valid, accept the move otherwise, reject</li>
<li>go back to (2)</li>
</ol>
</div>
</div>
<p>This very simple algorithm is based on a <strong>trial</strong> move and an <strong>acception/rejection</strong> step. This is the heart of a very popular molecular simulation method, named <strong>Metropolis Monte-Carlo Chain method</strong>.</p>
<p>Here below you have a very simple implementation in <code>python</code>.</p>
<div>
<div id="pyodide-5" class="exercise-cell">

</div>
<script type="pyodide-5-contents">
eyJhdHRyIjp7ImNhcHRpb24iOiIxRCBoYXJkIHBhcnRpY2xlcyBbcHJlc3MgY3RybC9jbWQgW0VOVEVSXSB0byBydW5dIiwiZWRpdCI6dHJ1ZSwiZXZhbCI6dHJ1ZX0sImNvZGUiOiJpbXBvcnQgbnVtcHkgYXMgbnBcbmltcG9ydCBtYXRwbG90bGliLnB5cGxvdCBhcyBwbHRcblxuI251bWJlciBvZiBwYXJ0aWNsZXMgXG5OID0gMThcbiMgcGFydGljbGUgZGlhbWV0ZXJcbmQgPSAxLjBcbiMgYm94IHNpemVcbkwgPSAyNC4wXG4jIG1heGltdW0gZGlzcGxhY2VtZW50IGFuZCBudW1iZXIgb2Ygc3RlcHNcbmRlbHRhLCBzdGVwcyA9ICAwLjUsIDEwMDAwMFxuIyBpbml0aWFsIGNvbmZpZ3VyYXRpb24gXG5wb3MgPSBucC5saW5zcGFjZShkLCBMIC0gZCwgTilcblxuZGVmIHZhbGlkKHApOlxuICAgIFwiQ2hlY2sgdGhhdCBjb25zZWN1dGl2ZSAoc29ydGVkKSBwYXJ0aWNsZXMgYXJlIG5vbi1vdmVybGFwcGluZ1wiXG4gICAgcmV0dXJuIG5wLmFsbChwID49IGQvMikgYW5kIG5wLmFsbChwIDw9IEwtZC8yKSBhbmQgbnAuYWxsKG5wLmRpZmYocCkgPj0gZClcblxucG9zaXRpb25zX3NhbXBsZXMgPSBbXVxuXG5mb3Igc3RlcCBpbiByYW5nZShzdGVwcyk6XG4gICAgaSA9IG5wLnJhbmRvbS5yYW5kaW50KE4pXG4gICAgbW92ZSA9IG5wLnJhbmRvbS51bmlmb3JtKC1kZWx0YSwgZGVsdGEpXG4gICAgbmV3X3BvcyA9IHBvcy5jb3B5KClcbiAgICBuZXdfcG9zW2ldICs9IG1vdmVcbiAgICAjIHNwcnRpbmcgYWxsb3dzIG90IG9ubHkgY2hlY2sgZm9yIGNvbnNlY3V0aXZlIHBhcnRpY2xlc1xuICAgIG5ld19wb3Muc29ydCgpXG4gICAgaWYgdmFsaWQobmV3X3Bvcyk6XG4gICAgICAgIHBvcyA9IG5ld19wb3NcbiAgICBpZiBzdGVwICUgMTAwID09IDA6XG4gICAgICAgIHBvc2l0aW9uc19zYW1wbGVzLmV4dGVuZChwb3MpXG5cbnBsdC5oaXN0KHBvc2l0aW9uc19zYW1wbGVzLCBiaW5zPTEyOCwgcmFuZ2U9KDAsIEwpLCBkZW5zaXR5PVRydWUpXG5wbHQueGxhYmVsKFwiUG9zaXRpb24gW2RdXCIpXG5wbHQueWxhYmVsKFwiUHJvYmFiaWxpdHkgZGVuc2l0eVwiKVxucGx0LnRpdGxlKFwiSGlzdG9ncmFtIG9mIHBhcnRpY2xlIHBvc2l0aW9uc1wiKVxucGx0LnNob3coKSJ9
</script>
</div>
<p>The code should produce a final probability distribution along the <span class="math inline">\(x\)</span> axis. The main control parameter here is the <strong>packing fraction</strong>, i.e.&nbsp;<span class="math inline">\(\phi = \dfrac{dN}{L}\)</span>, the coverage of the line. If you take high values for the packing fraction you will obserbve an interesting effect: the distribution <span class="math inline">\(\rho(x)\)</span> displays distinctive modulations. Surely, these reflect the layering of the particles along the line, due to their hard-core interactions. However, the oscillations are even more interesting as we observe that the particles are morelikely to be found near the walls than away from them.</p>
<p>Reflect on this point. In the complete absence of any attractive interactions, we find that the hard particles are <em>preferentially</em> located close to the walls. It is <em>as if</em> the walls exerted an <em>attractive force</em> capable of pulling the particles close to them. In reality, the force is purely statistical in nature. It ismerely the result of the <strong>entropic</strong> advantage that the <strong>entire</strong> system acquire when the particles are closer to the walls: simply put,if the first (and last) particles are close to the walls, there is more space for the particles in the middle, hence a larger number of configurations and hence larger <strong>configurational entropy</strong>.</p>
<p>Even if the force is statistical, it is not less real: in this simplified case, it leads to the layering of the density profile. Its generalisation to less idiealised conditions leads to a family of forces that are essential for the aggregation of soft matter which are called <strong>depletion interactions</strong>.</p>
</section>
</section>
<section id="sec-ao-potential" class="level3 page-columns page-full" data-number="15.2.5">
<h3 data-number="15.2.5" class="anchored" data-anchor-id="sec-ao-potential"><span class="header-section-number">15.2.5</span> Asakura-Oosawa depletion potential</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/depletion.svg" class="img-fluid figure-img"></p>
<figcaption>Mixture of colloids (yellow) and polymers (squiggly lines inside red circles). The depletion layers are as thick as the polymer radius (red circles) and are indicated with the dashes around the colloids. When the two layers do not overlap, the osmotic pressure due to the polymers on the colloids is balanced. When there is overlap, there is a region inaccessible to the polymers (purple) and the pressure is unbalanced, leading to aggregation.</figcaption>
</figure>
</div>
<p>The simple unidimensional scenario can be extended to a more interesting situation of hard-core colloidal particles dispersed in a medium where other smaller, repulsive particles (e.g.&nbsp;coiled polymers) are also dispersed. It is not important atthistage to know the details of such polymeric structures. We will ignore their internal structure and we wil also ignore their mutual interactions. We will only consider for the moment how they interact with the colloids and how this mediates an interaction <em>between</em> the colloids. We call these idealised polymers <em>penetrable hard spheres</em>.</p>
<p>This assumption yield a great simplification: the polymers, on their own, are an ideal gas. Their chemical potnetial is given by</p>
<p><span id="eq-ideal-mu"><span class="math display">\[\mu = k_BT \ln \eta_b \tag{15.1}\]</span></span></p>
<p>We assume also to work in an ensemble at fixed volume <span class="math inline">\(V\)</span>, temperature <span class="math inline">\(T\)</span> and chemical potential <span class="math inline">\(\mu\)</span>: this is the <strong>grand canonical ensemble</strong>. This means that we imagine that there is some ideal reservoir with which we can exchange polymers in order to maintain the chemical potential constant.</p>
<p>The grand potential for such ideal polymers is given by</p>
<p><span class="math display">\[\Omega = -k_BT e^{\mu/k_B T}V_{\rm accessible}\]</span></p>
<p>where <span class="math inline">\(V_{\rm accessible}\)</span> is the accessible volume. In the absence of the colloids, the entire volume <span class="math inline">\(V\)</span> is accessible.</p>
<p>Let’s image to intrudce two colloids at separation <span class="math inline">\(r\)</span>. For all <span class="math inline">\(r&gt; 2(R+\delta)=R_d\)</span>, the accessible volume is <span class="math inline">\(V_{\rm accessible}^{\infty}=V-2V_{\rm exclusion}\)</span>, where <span class="math inline">\(R_d\)</span> is the <strong>depletion radius</strong> and <span class="math inline">\(V_{\rm exclusion}\)</span> is the inaccessible region due to the colloid-polymer interaction around each colloid:</p>
<p><span class="math display">\[\begin{aligned}
V_{\rm exclusion}&amp; = V_{\rm outer}-V_{\rm inner}\\
&amp;= \dfrac{4\pi}{3}\left((R+\delta)^3-R^3\right)
\end{aligned}
\]</span></p>
<p>Changing the separation between the two colloids but maintaining <span class="math inline">\(r&gt;2R_d\)</span> does not change the grand potential: there is no free energy advantage and hence no effective interaction.</p>
<p>Instead, it is only when we take the colloids <em>closer</em> than <span class="math inline">\(2R_d\)</span> that we see a free energy difference. When <span class="math inline">\(r&lt;2R_d\)</span> (and, obviously, <span class="math inline">\(r&gt;2R\)</span>) an overlap region is formed (the lens-shaped region of tha figur above). Its volume can be calculated simply from geometrical considerations and it is <span id="eq-voverlap"><span class="math display">\[
V_{\mathrm{overlap}}(r)=\dfrac{4 \pi}{3} R_d^3\left[1-\frac{3}{4} \frac{r}{R_d}+\frac{1}{16}\left(\frac{r}{R_d}\right)^3\right]
\tag{15.2}\]</span></span></p>
<p>Th new accessible volume is <span class="math display">\[V_{\rm accessible}\prime=V-2V_{\rm exclusion}+V_{\mathrm{overlap}}\]</span>. The interaction between the two colloids resulting from the free energy adgvantage is called <strong>potential of mean force</strong> <span class="math inline">\(W(r)\)</span>. It is expressed as</p>
<p><span class="math display">\[
\begin{aligned}
W_{\rm AO}(r) = \Omega(r)-\Omega^{\infty} &amp; =-k_BT e^{m/k_B T}\left(V_{\rm accessible}(r)-V_{\rm accessible}(\infty)\right)\\
&amp; = -k_BT e^{m/k_B T}\left[V-2V_{\rm exclusion}+V_{\mathrm{overlap}}(r)-(V-2V_{\rm exclusion})\right]\\
&amp; = -k_BT e^{m/k_B T} V_{\mathrm{overlap}(r)}
\end{aligned}
\]</span></p>
<p>We can now re-use the ideal polymer chemical potential definition <a href="#eq-ideal-mu" class="quarto-xref">Equation&nbsp;<span>15.1</span></a> and the gemoetrical expression for <span class="math inline">\(V_{\mathrm{overlap}}\)</span> in <a href="#eq-voverlap" class="quarto-xref">Equation&nbsp;<span>15.2</span></a> to finally write the <strong>Asakura-Oosawa</strong> potential</p>
<div style="border: 2px solid red; padding: 1em; border-radius: 8px; background-color: transparent;">
<p><span class="math display">\[
W_{\rm AO} (r) = - \dfrac{4 \pi \eta_b k_B T}{3} (R+\delta)^3\left[1-\dfrac{3}{4} \dfrac{r}{R+\delta}+\frac{1}{16}\left(\dfrac{r}{R+\delta}\right)^3\right] \quad 2R\leq r&lt; 2R+\delta
\]</span></p>
</div>
<p>taking <span class="math inline">\(q = \delta / R\)</span> (the polymer-to-colloid size ratio), so <span class="math inline">\(R+\delta = R(1+q)\)</span> and <span class="math inline">\(r/(R+\delta) = r/[R(1+q)]\)</span> the AO potential can also be rewritten as:</p>
<p><span class="math display">\[
W_{\rm AO}(r) = -\frac{4\pi \eta_b k_B T}{3} [R(1+q)]^3 \left[1 - \frac{3}{4} \frac{r}{R(1+q)} + \frac{1}{16} \left(\frac{r}{R(1+q)}\right)^3 \right] \quad 2R \leq r &lt; 2R(1+q)
\]</span></p>
<div>
<div id="pyodide-6" class="exercise-cell">

</div>
<script type="pyodide-6-contents">
eyJhdHRyIjp7ImF1dG9ydW4iOnRydWUsImNhcHRpb24iOiJBc2FrdXJhLU9vc2F3YSBwb3RlbnRpYWwgW3ByZXNzIGN0cmwvY21kIFtFTlRFUl0gdG8gcnVuXSIsImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiXG5pbXBvcnQgbnVtcHkgYXMgbnBcbmltcG9ydCBtYXRwbG90bGliLnB5cGxvdCBhcyBwbHRcblxuIyBQYXJhbWV0ZXJzIChjaGFuZ2UgdG8gZXhwbG9yZSlcblIgPSAxLjAgICAgICAgICAgICMgQ29sbG9pZCByYWRpdXNcbmRlbHRhID0gMC4yICAgICAgICMgUG9seW1lciByYWRpdXNcbmV0YV9iID0gMC4xICAgICAgICMgUG9seW1lciBjb25jZW50cmF0aW9uIChkaW1lbnNpb25sZXNzKVxua0JUID0gMS4wICAgICAgICAgIyBTZXQga0JUPTEgZm9yIHJlZHVjZWQgdW5pdHNcblxuIyBEZXBsZXRpb24gcmFkaXVzXG5SZCA9IFIgKyBkZWx0YVxuXG4jIHIgdmFsdWVzOiBmcm9tIGNvbnRhY3QgKDJSKSB1cCB0byAzKFIrZGVsdGEpXG5yID0gbnAubGluc3BhY2UoMipSLCAzKlJkLCA1MDApXG5cbmRlZiBBT19wb3RlbnRpYWwociwgUiwgZGVsdGEsIGV0YV9iLCBrQlQpOlxuICAgIFJkID0gUiArIGRlbHRhXG4gICAgIyBPbmx5IGRlZmluZWQgZm9yIDJSIDw9IHIgPCAyUmRcbiAgICBXID0gbnAuemVyb3NfbGlrZShyKVxuICAgIG1hc2sgPSAociA+PSAyKlIpICYgKHIgPCAyKlJkKVxuICAgIHggPSByW21hc2tdIC8gUmRcbiAgICBXW21hc2tdID0gLSAoNCAqIG5wLnBpICogZXRhX2IgKiBrQlQgLyAzKSAqIFJkKiozICogKDEgLSAwLjc1ICogeCArIDAuMDYyNSAqIHgqKjMpXG4gICAgcmV0dXJuIFdcblxuV19BTyA9IEFPX3BvdGVudGlhbChyLCBSLCBkZWx0YSwgZXRhX2IsIGtCVClcblxucGx0LnBsb3QociwgV19BTylcbnBsdC5nY2EoKS5zZXQoeGxhYmVsPVwiU2VwYXJhdGlvbiAkci9SJFwiLCB5bGFiZWw9XCIkV197QU99KHIpJFwiLCB0aXRsZT1cIkFzYWt1cmEtT29zYXdhIERlcGxldGlvbiBQb3RlbnRpYWxcIilcbnBsdC5zaG93KCkifQ==
</script>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Force-based derivation of the AO interaction
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>When the colloids are so close the polymers cannot enter the lens-shaped region between the two colloids. This gap leads therefore to an <em>uniform</em> distribution of polymers which results in an pressure difference: the outer polymers push the colloids together, producing an effective attractive force. Such pressure resulting from an uncompensated concentration gradient is called <strong>osmotic</strong>.</p>
<p>The lens-shaped overlap region between the two colloids consists of two identical spherical caps, each subtending an angle <span class="math inline">\(\theta_0\)</span> at the center of the colloid. From the given geometry, the angle is such that <span class="math display">\[\cos\theta_0 = \dfrac{r}{2R_d}.\]</span></p>
<p>The uncompensated pressure acts on such surface.</p>
<p>For symmetry reasons, only the forces along the axis connecting the wto spheres contribute to the total force. For a given angle <span class="math inline">\(\theta\)</span> the components is proportional to <span class="math inline">\(P\cos\theta\)</span> where <span class="math inline">\(P\)</span> is the pressure exerted by the ideal gas of polymers is simply <span class="math inline">\(P=\eta_b kT\)</span> where <span class="math inline">\(\eta_b\)</span> is the polymer concentration. The surface element on which this pressure acts for a small increment <span class="math inline">\(d\theta\)</span> is <span class="math display">\[dS = 2\pi R_d^2\sin\theta d\theta\]</span>. Integrating over the range <span class="math inline">\([0,\theta_0]\)</span> yields the total force <span class="math inline">\(F_d\)</span></p>
<p><span class="math display">\[
\begin{aligned}
F_d(r) &amp;= -2\pi \eta_b k_B T R_d^2 \int_0^{\theta_0} \sin\theta \cos\theta \, d\theta \\
&amp;= -\pi R_d^2 \eta_b k_B T \left[1 - \left(\frac{r}{2R_d}\right)^2\right]
\end{aligned}
\]</span></p>
<p>Notice the negative sign, chosen to reflect the fact that the force is attarctive.</p>
<p>Integrating the force yields the interaction potential.</p>
</div>
</div>
</div>
<div class="cell">

</div>
<div class="cell">

</div>

<div class="no-row-height column-margin column-container"><div class="">

</div></div><div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Summary of main colloid-colloid interactions
</div>
</div>
<div class="callout-body-container callout-body">
<table class="caption-top table">
<colgroup>
<col style="width: 13%">
<col style="width: 69%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Interaction Type</th>
<th>Description</th>
<th>Range</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Van der Waals</td>
<td>Attractive forces arising from induced dipoles between particles.</td>
<td>Short-range</td>
</tr>
<tr class="even">
<td>Double Layer</td>
<td>Electrostatic repulsion due to overlapping electrical double layers around charged particles.</td>
<td>Long-range</td>
</tr>
<tr class="odd">
<td>DLVO</td>
<td>Combination of van der Waals attraction and double layer repulsion.</td>
<td>Short and long range</td>
</tr>
<tr class="even">
<td>Depletion</td>
<td>Typically attractive interactions emerging from purely entropic interactions</td>
<td>Short range</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="colloids-as-big-atoms" class="level2 page-columns page-full" data-number="15.3">
<h2 data-number="15.3" class="anchored" data-anchor-id="colloids-as-big-atoms"><span class="header-section-number">15.3</span> Colloids as big atoms</h2>
<p>Colloids can be viewed as “big atoms”: they are large particles suspended in a medium, exhibiting thermal motion and interactions in various ways analogous to atoms, but at much larger length and time scales. As we have seen above, the interactionsa can have statistical or even quanto-mechanical origina, but are ultimately cast in a classical form that is amenable to a classical treatment. At the same time, the large scales of colloids mean that via dedicatated microscopy techniques one is able to identify individual colloids, study theiur arrangements in detail, and follow their dynamics.</p>
<p>As mentionedearlier, there is a huge variety of colloids and a vast literature characterising their properties but also producing theoritical and computational models.</p>
<p>Here we focus on the most elementary model of a colloid. The simplest such exammple is the purely repulsive hard-sphere colloid. While an idealisation, quasi-hard-sphere colloids can be prepared in the laboratory by various techniques (see <span class="citation" data-cites="royall2024colloidal">Royall et al. (<a href="#ref-royall2024colloidal" role="doc-biblioref">2024</a>)</span> ). This includes by synthesizing a spheres of bundled polymers (you will learn about polymers in the next chapter) such as polymethyl methacrylate (PMMA), but also simply silica (small sphere of non-crystalline <span class="math inline">\(\rm Si O_2\)</span>) micron-sized beads carefully treated to screen and minimize the electrostatic interactions that would lead to DLVO-like contributions.</p>
<section id="sec-hard-spheres" class="level3 page-columns page-full" data-number="15.3.1">
<h3 data-number="15.3.1" class="anchored" data-anchor-id="sec-hard-spheres"><span class="header-section-number">15.3.1</span> The archetype: hard-spheres</h3>
<p>A <strong>hard-sphere</strong> is an idealized particle model in which each particle is represented as a perfectly rigid sphere of fixed radius <span class="math inline">\(R\)</span> and diameter <span class="math inline">\(\sigma=2R\)</span>. Hard spheres interact only through excluded volume: they cannot overlap, but otherwise experience no attraction or repulsion. The interaction potential <span class="math inline">\(U(r)\)</span> between two hard spheres separated by a center-to-center distance <span class="math inline">\(r\)</span> is:</p>
<p><span class="math display">\[
U(r) = \begin{cases}
\infty &amp; \text{if } r &lt; \sigma \\
0 &amp; \text{if } r \geq \sigma
\end{cases}
\]</span></p>
<p>This model captures the essential physics of <strong>excluded volume</strong> which, as we said earlier, fundamentally emerges from Pauli’s exclusion principle (electrons cannot occupy the same quantum state so electronic clouds of different atoms <em>exclude</em> each other).</p>
<svg width="400" height="220" viewbox="0 0 400 220" xmlns="http://www.w3.org/2000/svg">
<!-- Axes -->
<line x1="40" y1="180" x2="370" y2="180" stroke="black" stroke-width="2"></line> <line x1="60" y1="200" x2="60" y2="30" stroke="black" stroke-width="2"></line> <!-- x axis label --> <text x="360" y="195" font-size="16" font-family="sans-serif">r</text> <!-- y axis label --> <text x="30" y="40" font-size="16" font-family="sans-serif" transform="rotate(-90 30,40)">U(r)</text> <!-- Hard sphere potential: vertical line at r=2R, infinite wall --> <line x1="120" y1="180" x2="120" y2="40" stroke="red" stroke-width="4"></line> <!-- Dashed line for r < 2R (forbidden region) --> <rect x="60" y="40" width="60" height="140" fill="#f88" fill-opacity="0.2"></rect> <!-- Label for r=2R --> <text x="115" y="195" font-size="14" font-family="sans-serif" text-anchor="middle">2R</text> <!-- Flat line for r > 2R (U=0) --> <line x1="120" y1="180" x2="360" y2="180" stroke="blue" stroke-width="3"></line> <!-- Dotted line at U=infty --> <text x="80" y="55" font-size="14" font-family="sans-serif" fill="red" text-anchor="middle">∞</text> <!-- Label for U=0 --> <text x="70" y="175" font-size="14" font-family="sans-serif" fill="blue">0</text> <!-- Bracket for forbidden region --> <text x="95" y="210" font-size="13" font-family="sans-serif" text-anchor="middle" fill="#f88">forbidden</text> <!-- Title --> <text x="200" y="25" font-size="18" font-family="sans-serif" text-anchor="middle">Hard Sphere Potential</text>
</svg>
<section id="phase-behaviour-of-hard-spheres" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="phase-behaviour-of-hard-spheres">Phase behaviour of hard spheres</h4>
<p>Since the interaction potential is only based on excluded volume, the energy of hard spheres is trivial: it is <strong>always zero</strong>. A naive interpretation of such trivial energetics may lead to conclude that nothing interesting happens to a collection of hard spheres, since they always are at their energy minimum (namely, zero). However, it is clear from the earlier discussion of depletion forces that the interaction energy is only a part of the picture for systems subject to thermal fluctuations: indeed, for any <span class="math inline">\(T&gt;0\)</span>, <strong>entropic</strong> contributions to the free energy are always present. In the specific case of a fixed number of hard spheres in a fixed volume, they are <em>the only</em> contribution to the free energy.</p>
<p>In this sense, hard-spheres are completely <strong>entropy-driven</strong> system. For a collection of identical (<strong>monodisperse</strong>) hard spheres the entropy is solely <strong>configurational</strong> and correspods to the number of possible arrangements. This constrained only by the accessible volume, of which we have seen an instance when considering the depletion interactions. Notice that changing the temperature does not really affect the statistics of the configurations: the Boltzmann factor <span class="math inline">\(e^{U(\mathbf{r}^N)/k_BT}\)</span> is always <span class="math inline">\(1\)</span> for all valid configurations. The only way we can change the state of the system is by varying the accessible volume. For a system of <span class="math inline">\(N\)</span> identical hard spheres in a volume <span class="math inline">\(V\)</span> this can only be done in two ways</p>
<ul>
<li>by adding more spheres (of the same kind)</li>
<li>by varying the volume V</li>
</ul>
<p>The two routes essentially amount to varying one single parameter, which is the <strong>packing fraction</strong> (also called, <em>volume fraction</em>) of the system, defined as</p>
<p><span class="math display">\[\phi = N\dfrac{v_{\rm sphere}}{V} = \dfrac{\pi \sigma^6 N}{6V}\]</span></p>
<p>which can also be expressed in terms of the <strong>number density</strong> <span class="math inline">\(\rho=N/V\)</span> as <span class="math inline">\(\phi=\pi\sigma^3\rho/6\)</span>.</p>
<p>To change the phase behaviour of hard spheres we have a <strong>single control parameter</strong>, <span class="math inline">\(\phi\)</span> meaning that (differently from fluids like water) we are bound to have <strong>one-dimensional</strong> phase diagram.</p>
<p>We explore the phase behaviour of hard spheres by considering different regimes of packing fraction.</p>
</section>
<section id="low-packing-fractions" class="level4 unnumbered page-columns page-full">
<h4 class="unnumbered anchored" data-anchor-id="low-packing-fractions">Low packing fractions</h4>
<p>The hard repulsion between hard spheres means that each sphere is surrounded by an excluded volume in which the center of other spheres cannot be placed. Since the distance of closest approach between two spheres is <span class="math inline">\(\sigma\)</span> such <strong>excluded volume</strong> per particle is simply <span class="math inline">\(v_{\rm ex} =4\pi\sigma^3/3\)</span> and it is much larger than the volume pert particle <span class="math inline">\(v= V/N\)</span>. A collection of <span class="math inline">\(N\)</span> hard spheres has a total excluded volume <span class="math inline">\(V_{\rm ex}\neq N v_{\rm ex}\)</span> simply because the excluded volumes of individual particles can in general overlap, as we saw earlier with the case of depletion.</p>
<p>At very low densities, most hard spheres isolated. So, in this case, we can approximate the roral excluded volume as <span class="math inline">\(V_{\rm ex} \rm N v_{\rm ex}\)</span> so that the accessible volume (the volume not occupied by the spheres) is</p>
<p><span class="math display">\[V_{\rm accessible} = V-Nv_{\rm ex}\]</span></p>
<p>We use this to perform an appropriate statistical mechanical calculation for the Helmholtz free energy of system <span class="math inline">\(F\)</span>, which we know is purely entropic <span class="math inline">\(F=-TS\)</span>. The partition function <span class="math inline">\(\mathcal{Z}\)</span> is</p>
<p><span class="math display">\[
\mathcal{Z} = \frac{1}{N! \Lambda^{3N}} \int_{V_{\rm accessible}} d\mathbf{r}_1 \ldots d\mathbf{r}_N
\]</span></p>
<p>where <span class="math inline">\(\Lambda\)</span> is the thermal de Broglie wavelength</p>
<p><span class="math display">\[\Lambda = h/\sqrt{2\pi mk_B T},\]</span> and originates from the integration over the Maxwell-Boltzmann disribution of momenta for particles of mass <span class="math inline">\(m\)</span>, while <span class="math inline">\(h\)</span> is Planck’s constant.</p>
<p>For hard spheres, the integral is over all configurations where no two spheres overlap (i.e., <span class="math inline">\(|\mathbf{r}_i - \mathbf{r}_j| \geq \sigma\)</span> for all <span class="math inline">\(i \neq j\)</span>), and <span class="math inline">\(V_{\rm accessible}\)</span> is the total accessible volume. The results is that</p>
<p><span class="math display">\[\mathcal{Z} = \dfrac{(V-Nv_{\rm ex}/2)^N}{N!\Lambda^{3N}},\]</span></p>
<p>with the <span class="math inline">\(1/2\)</span> factor coming from the fact that we avoid double counting the excluded volume of pairs. The entropy is <span class="math display">\[
S = k_B \ln \mathcal{Z} = k_B \left[ N \ln(V - N v_{\rm ex}/2) - \ln N! - 3N \ln \Lambda \right]
\]</span></p>
<p>From the partition function, we use Stirling’s formula <span class="math inline">\(\ln N! = N\ln N -N\)</span> and obtain</p>
<p><span class="math display">\[
S = k_B \left[ N \ln(V - N v_{\rm ex}/2) - (N \ln N - N) - 3N \ln \Lambda \right]
\]</span></p>
<p>which reads <span class="math display">\[
S = N k_B \left[ \ln\left( \frac{V - N v_{\rm ex}/2}{N \Lambda^3} \right) + 1 \right]
\]</span></p>
<p>The phase behaviour is encoded in the <strong>equation of state</strong> (the equation that links the three thermodynamics variables <span class="math inline">\(P,T\)</span> and <span class="math inline">\(\phi\)</span>). To obtain it, we calculate the pressure</p>
<p><span class="math display">\[P = -\left(\dfrac{\partial F}{\partial V}\right)_{N,T} =T\left(\dfrac{\partial S}{\partial V}\right)_{N,T}= \dfrac{k_B T }{v-v_{\rm ex}/2}\]</span></p>
<p>This expression can be simplified (do it as an exercise) to obtain the quation of state</p>
<p><span class="math display">\[Z_{\rm comp}= \dfrac{PV}{Nk_BT}=\dfrac{1}{1-4\phi} \quad (\phi\ll 1)\]</span></p>
<p>also known as the <strong>compressibility factor</strong> <span class="math inline">\(Z_{\rm comp}\)</span>. Since <span class="math inline">\(\phi\)</span> is very small the expression is in fact</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>The choice of the letter “Z” is unfortunate. Do not confuse the compressibility factor with the partition function!</p>
</div></div><p><span class="math display">\[Z_{\rm comp} = 1+4\phi+O(\phi^2)\]</span></p>
<p>This expression makes it apparent that the first term linear in <span class="math inline">\(\phi\)</span> is a <em>correction</em> to the ideal gas law. This is example (to very low order) of what is called the <strong>virial expansion</strong>. This, in general takes the form</p>
<p><span class="math display">\[Z_{\rm comp}= 1 + B_2 \rho + B_3 \rho^2+ \dots\]</span></p>
<p>where <span class="math inline">\(B_2, B_3, \dots\)</span> are the <strong>virial coefficients</strong> and for systems that are not hard spheres they depend also on the temperature, <span class="math inline">\(B_2(T), B_3(T),\dots\)</span>. They are important as they encode the effects of <strong>correlations</strong>:</p>
<ul>
<li><span class="math inline">\(B_2\)</span> accounts for pairwise correlations (how the presence of one particle affects the probability of finding another nearby),</li>
<li><span class="math inline">\(B_3\)</span> for three-body correlations, and so on.</li>
</ul>
<p>Given an interaction potential the second virial coefficient <span class="math inline">\(B_2\)</span> can be calculated independently from the equation state</p>
<p><span class="math display">\[
B_2(T)=-\frac{1}{2} \int_0^{\infty}\left(\exp \left(-\frac{U(r)}{k_B T}\right)-1\right) 4 \pi r^2 d r
\]</span></p>
<p>For hard spheres this results in</p>
<p><span class="math display">\[
B_2 =  \frac{2\pi}{3} \sigma^3
\]</span></p>
<p>which is exactly what is predicted by the equation of state above, once you recognise that <span class="math inline">\(\phi = \frac{\pi\sigma^3}{6}\rho\)</span>.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Exercise: check this calculation.</p>
</div></div><p>Higher-order coefficients become increasingly complex to compute and reflect more complex many-body corelations that can be established even if the interaction potential is purely twobody (as in the case of hard spheres). The higher order coefficients become mor eand more important as the packing fraction is increased. Eventually something surprising occurs at a sufficiently high volume fraction.</p>
</section>
<section id="dense-packing-metastability-and-crystalisation" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="dense-packing-metastability-and-crystalisation">Dense packing: metastability and crystalisation</h4>
<p>As we increase the packing fraction, the accessible (free) volume reduces rapidly. At some point, disordered packing of spheres are so tightly packed that thermal motion becomes extremely inefficient or even impossible. Such disordered (<strong>random</strong>) packing of spheres are described as <strong>jammed</strong>: they are so densely packed that they are no longer behaving like a fluid but they instead display some of the rigidity that we typically associate with solids. Such jammed configurations are indeed examples of <strong>amorphous solids</strong>. We will explore them more in detail in the chapter dedicated to arrested systems.</p>
<p>It is important to note, however, that the disordered packing at high volume fractions are not minima of the free energy. The densest possible packing of hard spheres is achieved by arranging them in a crystalline lattice. In three dimensions, the densest packings are the face-centered cubic (FCC) and hexagonal close-packed (HCP) structures, both of which have a maximum packing fraction of</p>
<p><span class="math display">\[
\phi_{\text{max}} = \frac{\pi}{3\sqrt{2}} \approx 0.74
\]</span></p>
<p>This means that, at most, about 74% of the available volume can be filled by the spheres, with the remainder being empty space. This result was conjectured by Kepler in 1611 and proved rigorously only in 1998 (the <a href="https://en.wikipedia.org/wiki/Kepler_conjecture">Kepler conjecture</a>).</p>
<p>In contrast, <strong>random close packing</strong> (the densest disordered arrangement of spheres) yields a lower packing fraction, typically around <span class="math inline">\(\phi_{\text{rcp}} \approx 0.64\)</span>. Notice that this value is approximate and variations can be observed (due to randomness and, more importantky, to the method by which such packing are reached, i.e.&nbsp;the <em>compression protocol</em>). This means that the only way to compress spheres at very high packing has to lead (<em>spontaneously</em>) to the formation of crystals. We can indeed imagine to perform the following experiment:</p>
<ul>
<li>prepare a disordered assembly of colloidal hard spheres</li>
<li>compress them gradually to high and higher packing fraction, taking care to monitor the systems so that time correlations decay and the system is at thermal equilibrium</li>
<li>measure the resulting packing fraction</li>
</ul>
<p>Experiments of this sort have been performed historically, leveraging for example the <strong>slow sedimentation</strong> of colloids, which on long time scales leads to the accumulation of dense packings of spheres. Such experiments reveal that beyond the so-called <strong>freezing packing fraction</strong> <span class="math inline">\(\phi_{f} 0.494\)</span> the system spontaneously forms small regions of crystals mixed with the fluid. At a the high <strong>melting packing fraction</strong> <span class="math inline">\(\phi_{m}=0.545\)</span> the entirety of the system is then crystalline and its optical properties consequently change.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/rsta20090181f01.jpg" class="img-fluid figure-img"></p>
<figcaption>Phase behaviour of hard-sphere colloids from <span class="citation" data-cites="pusey2009hard">Pusey et al. (<a href="#ref-pusey2009hard" role="doc-biblioref">2009</a>)</span></figcaption>
</figure>
</div>
<p>A simple <strong>cell model</strong> can help us rationalise what is taking place. When the spheres are packed within their FCC cell, they can move very little beyond their own diameter <span class="math inline">\(\sigma\)</span>. Assume that the volume per particle again is <span class="math inline">\(v\)</span> and the (geometrically consrained) close packed volume is <span class="math inline">\(v_{cp}\)</span>.</p>
<p>The maximum dispalcement is <span class="math display">\[
\delta=\frac{\sigma}{\sqrt{2}}\left(\left(\frac{v}{v_{c p}}\right)^{1 / 3}-1\right)
\]</span> The corresponding free volume is then <span class="math inline">\(v_f=\frac{4 \pi}{3} \delta^3\)</span> from which we can calculate the entropy</p>
<p><span class="math display">\[
S = -N k_B T \ln \left(v_f / \Lambda^3\right)
\]</span></p>
<p>and the resulting pressure</p>
<p><span class="math display">\[
P=\frac{N k_B T}{v_{c p}} \frac{\left(v / v_{c p}\right)^{-2 / 3}}{\left(v / v_{c p}\right)^{1 / 3}-1}
\]</span></p>
<p>Rearranging and expressing everything in terms of packing fraction <span class="math inline">\(\phi = \dfrac{\pi\sigma^3}{6v}\)</span> yields</p>
<p><span class="math display">\[
Z_{\rm comp}=\frac{1}{1-\left(\phi / \phi_{c p}\right)^{1 / 3}}
\]</span></p>
<p>What is noteable here is that the expression we have obtained is a completely different functional form compared to the low density fluid regime. Thisis indicative of a <strong>discontinuous</strong>, <strong>first-order</strong> phase transition between the fluid and the crystalline phases. First order phase transitions are characterised by coexisting regions where the system can be found in partial fluid and partial crystaline state, as illustrated in the experiments above. This also means that we can prepare a disordered packing at very high density: this will not be its equilibrium state (global minimum of the free energy), but will still be stable for some (finite) time. This <em>local equilibrium state</em> is called a *<strong>metastable state</strong>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/metastable.png" class="img-fluid figure-img"></p>
<figcaption>Schematic free energy for hard spheres compressed at high pressures: the fluid branch becomes metastable and the free enrgy minimum is located in the crystal phase</figcaption>
</figure>
</div>
<p>But where does the free energy advantage of the crystal over the disrodered fluid come from? From the discussion above the answer is obvious: crystals can accommodate higher packings, meaning that they use the availale volume more efficiently. This in fact means that (on average) every hard sphere has more available volume if it arranged in the crystalline state compared to the fluid phase: the increased volume (available for thermal fluctuations and random particle displacements) is translated into an <strong>increased entropy</strong>. So, in fact the ordered, crystalline state has overall a higher entropy than the disordered fluid. This is important instance in which the conventional storytelling, where entropy is just <strong>disorder</strong>, simply does not hold. As we have seen with depletion forces earlier, entropy can lead to structure: in the case of hard spheres, it si the only mechanism leading to structure, and such structure is the most orderly one can think of: long-range, crystalline order.</p>
<p>The video below shows instead the results of a Monte-Carlo simulation at packing <span class="math inline">\(\phi=0.493\)</span> for a small system of 32 particles. Small systems have enhanced fluctuations, and since the overal packing fraction is very close to the freezing line, we see spontaneous freezing and unfreezing of the small system (wait until second 14 in the movie).</p>
<div class="quarto-video"><video id="video_shortcode_videojs_video1" class="video-js vjs-default-skin vjs-fluid" controls="" preload="auto" data-setup="{}" title=""><source src="figs/melt_freeze.mp4"></video></div>
<p>In conclusion, colloidal hard spheres have a one-dimensional phase diagram, that depends only on the packing fraction but with various distinct phases</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/hard-sphere-diag.svg" class="img-fluid figure-img"></p>
<figcaption>Hard-spheres phase diagram</figcaption>
</figure>
</div>
</section>
</section>
<section id="beyond-hard-spheres-simple-liquids" class="level3" data-number="15.3.2">
<h3 data-number="15.3.2" class="anchored" data-anchor-id="beyond-hard-spheres-simple-liquids"><span class="header-section-number">15.3.2</span> Beyond hard-spheres: simple liquids</h3>
<p>A <strong>simple liquid</strong> is a system of particles interacting via short-range, spherically symmetric (isotropic) pair potentials. The most common model is the <strong>Lennard-Jones (LJ) potential</strong>, which captures both the short-range repulsion (due to Pauli exclusion) and longer-range van der Waals attraction:</p>
<p><span class="math display">\[
U_{\mathrm{LJ}}(r) = 4\epsilon \left[ \left( \frac{\sigma}{r} \right)^{12} - \left( \frac{\sigma}{r} \right)^6 \right]
\]</span></p>
<p>where <span class="math inline">\(\epsilon\)</span> sets the depth of the potential well (interaction strength) and <span class="math inline">\(\sigma\)</span> is the particle diameter (distance at which <span class="math inline">\(U=0\)</span>). The <span class="math inline">\(r^{-12}\)</span> term models steep repulsion, while <span class="math inline">\(r^{-6}\)</span> describes the attractive tail.</p>
<p>The Lennard-Jones fluid exhibits rich phase behavior: at low temperatures and densities, it forms a gas; at intermediate conditions, a liquid; and at high densities, a solid. The LJ model is widely used to study atomic and molecular liquids, and serves as a reference for understanding real fluids and their phase transitions.</p>
<p>In the phase diagram below these different phases have been highlighted. It is clear that, compared to hard spheres which only display a fluid and a crystalline solid phase, systems like the Lennard-Jones fluid display an additional phase, the <strong>liquid</strong>. This phase emerges from the presence of the attractive well in the interaction potential. This allows for short-range attractive interactions that case a region of teh phase diagram in the save class of universality of the <a href="../phase-transitions/Ising-model.html"><strong>Ising model</strong></a> and the <a href="../phase-transitions/lattice-gas.html"><strong>lattice gas</strong></a>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/LJPhaseDiagram.png" class="img-fluid figure-img"></p>
<figcaption>Phase diagram of the Lennard-Jones Fluid, adapted from Wikimedia.</figcaption>
</figure>
</div>
<p>The Lennard-Jones interaction has already been designed to model noble gases (e.g.&nbsp;Argon) but has over time been used to model many other systems due to its simplicity and computational convenince: in particular it is used tor construct coarse-grained models of macromolecules, as well as colloids and nanoparticles. It belongs to a wider class of, classical, effective <strong>pair-wise</strong> interaction models actensively used to claculate properties and phase diagrams of a variety of condensed matter systems. This are useful because they allow one to, for example, long molecular simulations that are normally unreachable when considering atomistics and electronic density calculations.</p>
<p>The following table provides you with a few example potentials and their functional forms:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 13%">
<col style="width: 54%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th>Potential Name</th>
<th>Mathematical Form</th>
<th>Typical Systems/Features</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Lennard-Jones (LJ)</td>
<td><span class="math inline">\(U(r) = 4\epsilon \left[ \left( \frac{\sigma}{r} \right)^{12} - \left( \frac{\sigma}{r} \right)^6 \right]\)</span></td>
<td>Simple atomic fluids, coarse-grained molecular interactions</td>
</tr>
<tr class="even">
<td>Hard Sphere</td>
<td><span class="math inline">\(U(r) = \begin{cases} \infty &amp; r &lt; \sigma \\ 0 &amp; r \geq \sigma \end{cases}\)</span></td>
<td>Colloids, granular materials, excluded volume</td>
</tr>
<tr class="odd">
<td>Yukawa (Screened Coulomb)</td>
<td><span class="math inline">\(U(r) = \epsilon \frac{e^{-\kappa r}}{r}\)</span></td>
<td>Charged colloids, plasmas, electrolytes</td>
</tr>
<tr class="even">
<td>Dipolar</td>
<td><span class="math inline">\(U(r) = \frac{\mu_0}{4\pi} \frac{\mu_1 \mu_2}{r^3} (1 - 3\cos^2\theta)\)</span></td>
<td>Magnetic colloids, polar molecules</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="characterisation-of-colloidal-systems" class="level2" data-number="15.4">
<h2 data-number="15.4" class="anchored" data-anchor-id="characterisation-of-colloidal-systems"><span class="header-section-number">15.4</span> Characterisation of colloidal systems</h2>
<p>When looking at colloidal systems, we typically focus on two main aspects of their physics:</p>
<ul>
<li>their <strong>structural features</strong>, chracterised by the <strong>spatial</strong> correlations between their constituents</li>
<li>their <strong>dynamical features</strong>, characterised by the mobility of single particles or groups of particles.</li>
</ul>
<p>Here below, we briefly account of some main approaches to characterise these two dimensions.</p>
<section id="structural-properties-the-radial-distribution-function" class="level3" data-number="15.4.1">
<h3 data-number="15.4.1" class="anchored" data-anchor-id="structural-properties-the-radial-distribution-function"><span class="header-section-number">15.4.1</span> Structural properties: the radial distribution function</h3>
<p>Structural features of disordered (but also ordered) systems are described in terms of <strong>correlation functions</strong>. The underlying idea is that we are provided with an ensemble of stochastic variables (the positions of the colloids) which have a characteristic spatial distribution. for <span class="math inline">\(N\)</span> particles we have an N-body probability distribution function <span class="math inline">\(\rho_N(\mathbf{r}^N)\)</span> which contains all the necessary statistical mechanical information to describe the thermodyanmics of the system. However, this is very difficult to access directly. In experiments or theoretical calculations we typically only have access to some lower order <em>marginalisation</em> of the distribution, in terms of few-body distributions.</p>
<p>One of the simplest assumptions we can make when we describe a system is that its potential energy is expressed in terms of purely pairwise additive potential, meaning that</p>
<p><span class="math display">\[ U_N (\mathbf{r}^N)=\sum_{i=1}^{N-1}\sum_{j=i+1}^N V(r_ij) = \dfrac{1}{2}\sum_{i\neq j}V(r_{ij})\]</span></p>
<p>where <span class="math inline">\(V(r_{ij})\)</span> is the pairwise, radial interaction potential that only depends on the distance between particle centres <span class="math inline">\(r_{ij} = \mathbf{r}_i-\mathbf{r}_j\)</span>.</p>
<p>For system with pariwise interactions, the natural spatial correlation function is a twobody correlation <span class="math inline">\(g(\mathbf{r}_i, \mathbf{r}_j)\)</span>, where <span class="math inline">\(\mathbf{r}_i\)</span> and <span class="math inline">\(\mathbf{r}_j\)</span> are two randomly chosen particles. In the case of non-crystalline, disordered systems the corrlation function has to be</p>
<ul>
<li>translationally invariant , so that it only depends on the difference <span class="math inline">\(\mathbf{r}_i-\mathbf{r}_j\)</span></li>
<li>rotationally invariant, so that there is no angular component and hence only the distance <span class="math inline">\(r_{ij} =| \mathbf{r}_i-\mathbf{r}_j|\)</span> matters</li>
</ul>
<p>This function <span class="math inline">\(g(r)\)</span> is called the <strong>radial distribution function</strong> and plays a crucial role in the characterisation of fluids, crystals, glasses and much more. For system with twobody interactions only, it contains in principle all the thermodynamic information necessary to reconstruct the free energy, as one can write</p>
<p><span class="math display">\[
\frac{F_{\mathrm{ex}}}{k_B T}=2 \pi \rho N \int_0^{\infty}[g(r) \ln g(r)-g(r)+1] r^2 d r+\frac{\rho N}{2 k_B T} \int V(r) g(r) d^3 r
\]</span> where the first term represent the entropic contributions and the second term represents the energetic contribution.</p>
But how is it calculated? very simply. You can think of constructing a histogram of the distances between all of the particles and suitably normalising such histogram by the density of the system. Mathematically this reads as
<div style="border: 2px solid red; padding: 1em; border-radius: 8px; background-color: transparent;">
<p><span class="math display">\[
g(r) = \frac{1}{\rho N} \left\langle \sum_{i=1}^N \sum_{j \neq i} \delta(|\mathbf{r}_i - \mathbf{r}_j| - r) \right\rangle
\]</span></p>
</div>
<p>where <span class="math inline">\(\rho = N/V\)</span> is the number density, and the angle brackets denote an ensemble average and <span class="math inline">\(\delta\)</span> is a Dirac delta function.</p>
<ul>
<li>For an <strong>ideal gas</strong>, <span class="math inline">\(g(r) = 1\)</span> everywhere (no correlations).</li>
<li>For <strong>hard spheres</strong>, <span class="math inline">\(g(r) = 0\)</span> for <span class="math inline">\(r &lt; \sigma\)</span> (no overlap), and <span class="math inline">\(g(r)\)</span> shows oscillations at higher <span class="math inline">\(r\)</span> due to packing effects.</li>
</ul>
<p>Notice that the radial distribution function is an instance of the more general class of pair-wise correlations that have been introduced earlier, see <a href="../phase-transitions/background.html#sec-correlations" class="quarto-xref"><span>Section 2.2</span></a> and it is paired with its reciprocal space Fourier transform, the <strong>structure factor</strong>:</p>
<p><span class="math display">\[
S(k) = 1 + \rho \int \left[ g(r) - 1 \right] e^{-i \mathbf{k} \cdot \mathbf{r}} d\mathbf{r}
\]</span></p>
<p>For isotropic systems, this reduces to:</p>
<p><span class="math display">\[
S(k) = 1 + 4\pi \rho \int_0^\infty r^2 [g(r) - 1] \frac{\sin(kr)}{kr} dr
\]</span></p>
<p>Experimentally, on can measure <span class="math inline">\(S(k)\)</span> can be measured using scattering techniques or <span class="math inline">\(g(r)\)</span> via direct imaging in colloidal systems. They provide insight into short-range order, local structure, and phase transitions in soft matter.</p>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The radial distribution function <span class="math inline">\(g(r)\)</span> has two possible interpretations</p>
<ul>
<li>It represents the probability density of finding a particle at distance <span class="math inline">\(r\)</span> away from a reference particle <em>relative</em> to the probability density of an idela gas at the same number density.</li>
<li>If a given refernce particle is taken at the origin, then the local average density at distance <span class="math inline">\(r\)</span> is <span class="math inline">\(\rho g(r)\)</span>.</li>
</ul>
</div>
</div>
</div>
<p>Here below we show two codes to calculate the radial distribution fucntion for an ideal gas (which is trivial) and then for an assembly of hard spheres</p>
<div>
<div id="pyodide-7" class="exercise-cell">

</div>
<script type="pyodide-7-contents">
eyJhdHRyIjp7ImF1dG9ydW4iOnRydWUsImNhcHRpb24iOiJSYWRpYWwgZGlzdHJpYnV0aW9uIGZ1bmN0aW9uIG9mIGFuIGlkZWFsIGdhcyBbcHJlc3MgY3RybC9jbWQgW0VOVEVSXSB0byBydW5dIiwiZWRpdCI6dHJ1ZSwiZXZhbCI6dHJ1ZX0sImNvZGUiOiJpbXBvcnQgbnVtcHkgYXMgbnBcbmltcG9ydCBtYXRwbG90bGliLnB5cGxvdCBhcyBwbHRcblxuIyBQYXJhbWV0ZXJzXG5OID0gNTAwICAgICAgIyBudW1iZXIgb2YgcG9pbnRzLCBjaGFuZ2UgdGhpcyB0byBjaGVjayBjb252ZXJnZW5jZVxuTCA9IDEwLjAgICAgICMgYm94IHNpemVcbmJpbnMgPSA1MCAgICAjIG51bWJlciBvZiBiaW5zXG5cbiMgR2VuZXJhdGUgcmFuZG9tIHBvaW50cyAoaWRlYWwgZ2FzKVxucG9zaXRpb25zID0gbnAucmFuZG9tLnVuaWZvcm0oMCwgTCwgc2l6ZT0oTiwgMykpXG5cbmRlZiByYWRpYWxfZGlzdHIocG9zaXRpb25zLCBMKTpcbiAgICBOID0gbGVuKHBvc2l0aW9ucylcbiAgICBcbiAgICAjIENvbXB1dGUgYWxsIHBhaXJ3aXNlIGRpc3RhbmNlcyB3aXRoIFBCQ1xuICAgIGRpZmYgPSBwb3NpdGlvbnNbOiwgbnAubmV3YXhpcywgOl0gLSBwb3NpdGlvbnNbbnAubmV3YXhpcywgOiwgOl1cbiAgICBkaWZmID0gZGlmZiAtIEwgKiBucC5yb3VuZChkaWZmIC8gTClcbiAgICBkaXN0c19tYXRyaXggPSBucC5zcXJ0KG5wLnN1bShkaWZmKioyLCBheGlzPS0xKSlcbiAgICBcbiAgICAjIEdldCB1cHBlciB0cmlhbmd1bGFyIGRpc3RhbmNlcyAoZWFjaCBwYWlyIGNvdW50ZWQgb25jZSlcbiAgICBpLCBqID0gbnAudHJpdV9pbmRpY2VzKE4sIGs9MSlcbiAgICBkaXN0cyA9IGRpc3RzX21hdHJpeFtpLCBqXVxuICAgIFxuICAgICMgQ3JlYXRlIGhpc3RvZ3JhbVxuICAgIHJfbWF4ID0gTC8yXG4gICAgcl9lZGdlcyA9IG5wLmxpbnNwYWNlKDAsIHJfbWF4LCBiaW5zKzEpXG4gICAgaGlzdCwgXyA9IG5wLmhpc3RvZ3JhbShkaXN0cywgYmlucz1yX2VkZ2VzKVxuICAgIHJfY2VudGVycyA9IDAuNSAqIChyX2VkZ2VzWzotMV0gKyByX2VkZ2VzWzE6XSlcbiAgICBcbiAgICAjIENhbGN1bGF0ZSBnKHIpIHdpdGggY29ycmVjdCBub3JtYWxpemF0aW9uXG4gICAgcmhvID0gTiAvIEwqKjMgICMgbnVtYmVyIGRlbnNpdHlcbiAgICBkciA9IHJfZWRnZXNbMTpdIC0gcl9lZGdlc1s6LTFdICAjIGJpbiB3aWR0aHNcbiAgICBcbiAgICAjIFZvbHVtZSBvZiBzcGhlcmljYWwgc2hlbGxcbiAgICBzaGVsbF92b2x1bWVzID0gNCAqIG5wLnBpICogcl9jZW50ZXJzKioyICogZHJcbiAgICBcbiAgICAjIEZvciBlYWNoIHBhcnRpY2xlLCBleHBlY3RlZCBudW1iZXIgb2YgbmVpZ2hib3JzIGluIHNoZWxsID0gcmhvICogc2hlbGxfdm9sdW1lXG4gICAgIyBUb3RhbCBleHBlY3RlZCBwYWlycyBpbiBzaGVsbCA9IE4gKiByaG8gKiBzaGVsbF92b2x1bWUgLyAyIFxuICAgICMgKGRpdmlkZSBieSAyIGJlY2F1c2Ugd2UgY291bnQgZWFjaCBwYWlyIG9uY2UpXG4gICAgZXhwZWN0ZWRfcGFpcnMgPSBOICogcmhvICogc2hlbGxfdm9sdW1lcyAvIDJcbiAgICBcbiAgICAjIGcocikgPSBhY3R1YWxfcGFpcnMgLyBleHBlY3RlZF9wYWlyc1xuICAgIGdfciA9IGhpc3QgLyBleHBlY3RlZF9wYWlyc1xuICAgIFxuICAgIHJldHVybiByX2NlbnRlcnMsIGdfclxuXG5yLCBnID0gcmFkaWFsX2Rpc3RyKHBvc2l0aW9ucywgTClcbnBsdC5wbG90KHIsIGcsICdiLScsIGRyYXdzdHlsZT1cInN0ZXBzLW1pZFwiKVxucGx0LmF4aGxpbmUoeT0xLCBjb2xvcj0ncicsIGxpbmVzdHlsZT0nLS0nLCBhbHBoYT0wLjcsIGxhYmVsPSdJZGVhbCBnYXMgKGcocik9MSknKVxucGx0LnhsYWJlbChcInJcIilcbnBsdC55bGFiZWwoXCJnKHIpXCIpXG5wbHQuZ2NhKCkuc2V0KHhsaW09KDAsIEwvMikseWxpbT0oMCwyKSlcbnBsdC5sZWdlbmQoKVxucGx0LnNob3coKSJ9
</script>
</div>
<p>We can compare this with arrangements of hard spheres</p>
<div>
<div id="pyodide-8" class="exercise-cell">

</div>
<script type="pyodide-8-contents">
eyJhdHRyIjp7ImNhcHRpb24iOiJSYWRpYWwgZGlzdHJpYnV0aW9uIGZ1bmN0aW9uIGZvciBhIGhhcmQgc3BoZXJlIGNvbmZpZ3VyYXRpb24gW3ByZXNzIGN0cmwvY21kIFtFTlRFUl0gdG8gcnVuXSIsImVkaXQiOnRydWUsImV2YWwiOnRydWV9LCJjb2RlIjoiIyBub3cgdHJ5IHdpdGggaGFyZCBzcGhlcmVzLCB1c2luZyBhIGN1c3RvbSBsaWJhcnJ5IHlvdSB3aWxsIGZpbmQgaW4gdGhlIGNvdXJzZSBwYWdlc1xuZnJvbSBzcmMgaW1wb3J0IGhhcmRzcGhlcmVzXG5cbnNpZ21hID0gMS4wXG5MID0gNS4qc2lnbWEgI3Rha2UgYSBzbWFsbCB2YWx1ZVxucGhpID0gMC4yICMgcGFja2luZyBmcmFjdGlvblxuTiA9IGludChwaGkvKG5wLnBpLzYqc2lnbWEqKjMpKkwqKjMpXG5cbiMgIHdlIHJ1biBNb250ZS1DYXJsbyBzaW11bGF0aW9ucyBvZiBoYXJkLXNwaGVyZXMgb24gdGhlIGZseSBcbmZyZXEgPSA1XG5uc3RlcHMgPSAxMDAqTlxudHJhamVjdG9yeSwgYWNjZXB0YW5jZSA9IGhhcmRzcGhlcmVzLk1vbnRlX0NhcmxvX3RyYWooTixMLCBzaWdtYSwgbnN0ZXBzLGZyZXEpXG5ncyA9IFtdXG5mb3IgcG9zaXRpb25zIGluIHRyYWplY3Rvcnk6XG4gICAgX3IsIF9nID0gcmFkaWFsX2Rpc3RyKHBvc2l0aW9ucywgTClcbiAgICBncy5hcHBlbmQoX2cpXG5wbHQucGxvdChyLCBucC5tZWFuKGdzLGF4aXM9MCksICdiLScsIGxhYmVsPXJmXCJIYXJkIHNwaGVyZXMsIHJmJFxccGhpPXtwaGl9JFwiKVxucGx0LnNldCh4bGFiZWw9XCJyXCIsIHlsYWJlbD1cImcocilcIiwgeWxpbT0gKDAsMikpXG5wbHQubGVnZW5kKClcbnBsdC5zaG93KCkifQ==
</script>
</div>
<p>The radial distribution function is the central object of much of <strong>liquid state theory</strong>, which aims to predict the shape of the correlation functions (such as <span class="math inline">\(g(r)\)</span>) from the sole knowledge of the interaction potential between the elementary particles (see <span class="citation" data-cites="santos2016concise">Santos (<a href="#ref-santos2016concise" role="doc-biblioref">2016</a>)</span> for a gentle introduction to the topic). In particular, one can imagine the correlations between two particles <span class="math inline">\(1\)</span> and <span class="math inline">\(2\)</span> in a fluid to have two possible origins</p>
<ul>
<li>a <strong>direct</strong> correlation between the two particles, mediated by direct interactions (e.g.&nbsp;collisions) between 1 and 2.</li>
<li>an <strong>indirect correlation</strong>, mediated by other particle sin the fluid</li>
</ul>
<p>The <span class="math inline">\(g(r)\)</span> contains both direct and indirect correlations. We can assume that a suitable function <span class="math inline">\(c(r)\)</span> exists to express the direct correlations. In such case, for twobody interactions, we cna write a hierarchy of equations via a central result of liquid state theory, the <strong>Ornestein-Zernicke</strong> (OZ) equation</p>
<p><span id="eq-oz"><span class="math display">\[
h\left(r_{12}\right)=c\left(r_{12}\right)+\rho \int c\left(r_{13}\right) h\left(r_{32}\right) d \mathbf{r}_3
\tag{15.3}\]</span></span></p>
<p>where we defined the total correlation function as <span class="math inline">\(h(r)=g(r)-1\)</span>. The OZ equation is an integral equation. In Fourier space (assuming the isotropicity of a fluid) it becomes an algebraic equation <span class="math display">\[
\tilde{h}(k)=\frac{\tilde{c}(k)}{1-\rho \tilde{c}(k)}
\]</span> Since both <span class="math inline">\(h(r)\)</span> and <span class="math inline">\(c(r)\)</span> an additional relationship is known called a <strong>closure</strong>. These constructed through phsyical arguments. A common one is the so-caled Percus-Yevick closure</p>
<p><span class="math display">\[
c(r)=[1+h(r)]\left[1-e^{\beta U(r)}\right]
\]</span> where the pairwise interaction enters explicitly.</p>
<p>Solving the OZ equation with the Percus-Yevick closure produces realistic radial distribution functions in a wide range of packing fractions for hard spheres.</p>
<div id="ef7a5279" class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="soft-matter_colloids_files/figure-html/cell-2-output-1.png" width="576" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="dynamics-single-vs-collective-displacements" class="level3" data-number="15.4.2">
<h3 data-number="15.4.2" class="anchored" data-anchor-id="dynamics-single-vs-collective-displacements"><span class="header-section-number">15.4.2</span> Dynamics: single vs collective displacements</h3>
<p>We have seen <a href="../phase-transitions/Brownian-and-Langevin-dynamics.html">earlier</a> that if we are given a number of particles evolving microscopically according to the Langevin equation of drag <span class="math inline">\(\gamma\)</span> and zero-mean noise <span class="math inline">\(\eta\)</span></p>
<p><span class="math display">\[
m \frac{d \vec{v}}{d t}=-\gamma\vec{v}+\vec{\eta}(t)
\]</span></p>
<p>then an <em>ensemble</em> of independent particles will follow the <strong>diffusion equation</strong>:</p>
<p><span class="math display">\[\frac{\partial \rho(\mathbf{r}, t)}{\partial t} = D \nabla^2 \rho(\mathbf{r}, t) \]</span></p>
<p>where <span class="math inline">\(\rho(\mathbf{r},t)\)</span> is the probability of finding a particle at position <span class="math inline">\(\mathbf{r}\)</span> at time <span class="math inline">\(t\)</span> with diffusivity <span class="math inline">\(D\)</span>. The diffusivity <span class="math inline">\(D\)</span> is related to the microscopic Langevin equation parameters via the fluctuation-dissipation relation (or Einstein relation) <span class="math display">\[
D = \frac{k_B T}{\gamma}
\]</span> where <span class="math inline">\(k_B\)</span> is Boltzmann’s constant, <span class="math inline">\(T\)</span> is temperature, and <span class="math inline">\(\gamma\)</span> is the friction (drag) coefficient.</p>
<p>It is easy to show (see below) that in 1 dimension the general solution is</p>
<p><span class="math display">\[
\rho(x, t) = \frac{1}{\sqrt{4\pi D t}} \exp\left(-\frac{x^2}{4Dt}\right)
\]</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution of the diffusion equation using Laplace transform
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The 1D diffusion equation is: <span class="math display">\[
\frac{\partial \rho(x, t)}{\partial t} = D \frac{\partial^2 \rho(x, t)}{\partial x^2}
\]</span></p>
<p>Suppose the initial condition is a delta function at the origin: <span class="math display">\[
\rho(x, 0) = \delta(x)
\]</span></p>
<p>Take the Laplace transform in time: <span class="math display">\[
\tilde{\rho}(x, s) = \int_0^\infty \rho(x, t) e^{-st} dt
\]</span></p>
<p>The Laplace transform of the time derivative: <span class="math display">\[
\mathcal{L}\left[\frac{\partial n}{\partial t}\right] = s\tilde{\rho}(x, s) - \rho(x, 0)
\]</span></p>
<p>So the transformed equation is: <span class="math display">\[
s\tilde{\rho}(x, s) - \delta(x) = D \frac{\partial^2 \tilde{\rho}(x, s)}{\partial x^2}
\]</span></p>
<p>Rearrange: <span class="math display">\[
D \frac{\partial^2 \tilde{\rho}}{\partial x^2} - s\tilde{\rho} = -\delta(x)
\]</span></p>
<p>For <span class="math inline">\(x \neq 0\)</span>, the homogeneous equation: <span class="math display">\[
D \frac{\partial^2 \tilde{\rho}}{\partial x^2} - s\tilde{\rho} = 0
\]</span></p>
<p>General solution: <span class="math display">\[
\tilde{\rho}(x, s) = A e^{-\lambda |x|}, \quad \lambda = \sqrt{\frac{s}{D}}
\]</span></p>
<p>The delta function at <span class="math inline">\(x=0\)</span> gives a discontinuity in the derivative: <span class="math display">\[
\left.\frac{\partial \tilde{\rho}}{\partial x}\right|_{x=0^+} - \left.\frac{\partial \tilde{\rho}}{\partial x}\right|_{x=0^-} = -\frac{1}{D}
\]</span></p>
<p>Compute derivatives: <span class="math display">\[
\frac{\partial \tilde{\rho}}{\partial x} = -A \lambda \, \text{sgn}(x) e^{-\lambda |x|}
\]</span></p>
<p>So at <span class="math inline">\(x=0^+\)</span>: <span class="math inline">\(-A\lambda\)</span>, at <span class="math inline">\(x=0^-\)</span>: <span class="math inline">\(A\lambda\)</span>. The jump is <span class="math inline">\(-2A\lambda\)</span>.</p>
<p>Set equal to <span class="math inline">\(-1/D\)</span>: <span class="math display">\[
-2A\lambda = -\frac{1}{D} \implies A = \frac{1}{2D\lambda}
\]</span></p>
<p>So: <span class="math display">\[
\tilde{\rho}(x, s) = \frac{1}{2D\lambda} e^{-\lambda |x|} = \frac{1}{2\sqrt{Ds}} e^{-|x|\sqrt{\frac{s}{D}}}
\]</span></p>
<p>Invert the Laplace transform (using tables or convolution theorem): <span class="math display">\[
\rho(x, t) = \frac{1}{\sqrt{4\pi D t}} \exp\left(-\frac{x^2}{4Dt}\right)
\]</span></p>
<p>This is the fundamental solution (Green’s function) of the diffusion equation.</p>
</div>
</div>
</div>
<p>The diffusion equation can also be read as a simple consequence of two requirements:</p>
<ul>
<li><p>continuity of the distribution of mass (no mass is lost during the transport), as expressed in the <strong>continuity equation</strong> <span class="math display">\[
\frac{\partial \rho(\mathbf{r}, t)}{\partial t} + \nabla \cdot \mathbf{J}(\mathbf{r}, t) = 0
\]</span> where the divergence <span class="math inline">\(\nabla \cdot \mathbf{J}(\mathbf{r}, t)\)</span> represents the net outflow of particles from a given region due to the flux <span class="math inline">\(\mathbf{J}\)</span>.</p></li>
<li><p>the flux of particles is assumed to be proportional to the gradient in the density (or concnetration of the particles). This can be taken as an empirical assumption, a reasonable approximation (i.e.&nbsp;a perturbative approach) or a consequence of underlying Brownian dynamics. It is known as Fick’s law:</p></li>
</ul>
<p><span class="math display">\[
\mathbf{J}(\mathbf{r}, t) = -D \nabla \rho(\mathbf{r}, t)
\]</span></p>
<p>The diffusivity constant <span class="math inline">\(D\)</span> is therefore central for the diffusion. It is possible to link the microscopic motion of the particles to the collective behaviour of the density distribution <span class="math inline">\(\rho(x,t)\)</span> by exploting the connection provided bt the <strong>mean squared displacement</strong>, which is simply the variance of the distributione <span class="math inline">\(\rho(x,t)\)</span> at time <span class="math inline">\(t\)</span>.</p>
<p>As discussed earlier, in <span class="math inline">\(d\)</span> dimensions this is equal to <span class="math display">\[\langle r(t)^2\rangle-\langle r(t)\rangle^2 = 2d D t\]</span></p>
<p>Hence, measuring the average squared displacements is sufficient to recover the diffusivity and to reconstruct the distribution.</p>
<section id="diffusion-and-interactions" class="level4" data-number="15.4.2.1">
<h4 data-number="15.4.2.1" class="anchored" data-anchor-id="diffusion-and-interactions"><span class="header-section-number">15.4.2.1</span> Diffusion and interactions</h4>
<p>We have up to now considered the dilute (or non-nteracting) limit, where collisions between the colloids are ignored. Let’s now consider instead simple colloids (again, hard spheres) and their dynamics.</p>
<p>We are interested in the mean squared displacement <span class="math inline">\(\left\langle r^{2}(t)\right\rangle\)</span> as a function of time for different volume fractions. At low volume fractions, the particles undergo Brownian motion (random-walk diffusion) due to collisions with liquid molecules. The mean squared displacement (in three dimensions) is <span class="math display">\[\left\langle\underline{r}^{2}(t)\right\rangle=6 D_{0} t\]</span> where the meaning of the subscript 0 will be apparent shortly.</p>
<p>For sufficiently dense hard spheres (e.g.&nbsp;above <span class="math inline">\(\phi \sim 0.3\)</span>), however, different regimes are observed. At short times the particles diffuse with the short time (self) diffusion constant <span class="math inline">\(D_{s}\)</span>. This is determined from the short time limit and is smaller than the <span class="math inline">\(D_{0}\)</span> measured for <span class="math inline">\(\phi \rightarrow 0\)</span>. The motion of the particles (self diffusion) is still driven by collisions with the liquid molecules, but in addition the interactions between particles become significant.</p>
<p>While the particles are diffusing in their cages formed by their neighbours, the hydrodynamic interaction with the neighbours, transmitted through flows in the liquid, causes slowing down relative to the free diffusion at low concentrations. At intermediate times the particles encounter the neighbours and the interactions slow the motion down. To make further progress, the particle has to break out of the cage formed by its neighbours. Now the particles experience a further interaction, direct interactions (hard-sphere interactions), in addition to the hydrodynamic interactions. The long-time and long-ranged movement is also diffusive, i.e.&nbsp;we still have <span class="math display">\[\langle r^{2}(t)\rangle \propto t\]</span> when the particles undergo large-scale random-walk diffusion through many cages.</p>
<p>However, the motion is further slowed and a smaller diffusion constant relative to the motion in the short time limit is observed, the long time (self) diffusion constant <span class="math inline">\(D_{L}\)</span>.</p>
<div id="31ff8098" class="cell" data-execution_count="2">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="soft-matter_colloids_files/figure-html/cell-3-output-1.png" width="633" height="407" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The slowing down due to collisions eventually dominates the ohysics of hard spheres at high densities. This is more broadly true also for generic dense colloidal suspensions, where the short range interactions dominate on other mechanisms of motion (including the hydrodynamics). Eventually, for very dense packings one observes the emergence of a new physical regime where relaxation becomes anomalous and non-diffusive: this is the glassy regime, which we will revisit in a following chapter.</p>
<p><!-- short time: $<r^{2}(t)>=6 D_{S} t$ short-time self diff. coeff. $D_{S}<D_{0}$ purely because of hydrodyn. interactions theoretical predictions exist intermediate time: some theory long time: $<r^{2}(t)>=6 D_{L} t$ long-time self diff. coeff. $D_{L}<D_{S}\left(<D_{0}\right)$ because of hydrodyn. and direct interactions theory very complicated, but some predictions exist.  --></p>
</section>
</section>
<section id="stokes-einstein-relation" class="level3" data-number="15.4.3">
<h3 data-number="15.4.3" class="anchored" data-anchor-id="stokes-einstein-relation"><span class="header-section-number">15.4.3</span> Stokes-Einstein relation</h3>
<p>Suppose that the particles are subjected to an external force F in the x direction, e.g.&nbsp;gravity. In thermal equilibrium the Maxwell-Boltzmann distribution is valid, i.e.&nbsp;the particle density <span class="math inline">\(n(x)\)</span> is given by</p>
<p><span class="math display">\[
n(x)=n_{0} \exp \left(-U(x) / k_{B} T\right)=n_{0} \exp \left(-F x / k_{B} T\right)
\]</span></p>
<p>where we assumed a constant force <span class="math inline">\(F\)</span> in the last equation. In the case of gravity <span class="math inline">\(F=m_{B} g\)</span> with <span class="math inline">\(m_{B}\)</span> the buoyant mass. <span class="math inline">\(n(x)\)</span> results from the balance between the motion of the particles due to the external force setting up a concentration gradient, and the resultant diffusion given by Fick’s law.</p>
<div class="cell">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="1230" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1229;"><span id="cb1-1230"><a href="#cb1-1230" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb1-1231"><a href="#cb1-1231" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> width <span class="op">=</span> <span class="dv">600</span><span class="op">;</span></span>
<span id="cb1-1232"><a href="#cb1-1232" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> height <span class="op">=</span> <span class="dv">400</span><span class="op">;</span></span>
<span id="cb1-1233"><a href="#cb1-1233" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> numCircles <span class="op">=</span> <span class="dv">300</span><span class="op">;</span></span>
<span id="cb1-1234"><a href="#cb1-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1235"><a href="#cb1-1235" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> temperature <span class="op">=</span> <span class="dv">300</span><span class="op">;</span>    <span class="co">// Arbitrary scale</span></span>
<span id="cb1-1236"><a href="#cb1-1236" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> viscosity <span class="op">=</span> <span class="fl">0.02</span><span class="op">;</span>     <span class="co">// Arbitrary scale</span></span>
<span id="cb1-1237"><a href="#cb1-1237" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> particleRadius <span class="op">=</span> <span class="dv">5</span><span class="op">;</span> <span class="co">// pixels</span></span>
<span id="cb1-1238"><a href="#cb1-1238" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> timeStep <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-1239"><a href="#cb1-1239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1240"><a href="#cb1-1240" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> kB <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> <span class="co">// reduced units</span></span>
<span id="cb1-1241"><a href="#cb1-1241" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> gravityFactor <span class="op">=</span> <span class="fl">0.1</span><span class="op">;</span></span>
<span id="cb1-1242"><a href="#cb1-1242" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> gravity <span class="op">=</span> <span class="dv">10</span> <span class="op">*</span> gravityFactor<span class="op">;</span></span>
<span id="cb1-1243"><a href="#cb1-1243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1244"><a href="#cb1-1244" aria-hidden="true" tabindex="-1"></a><span class="co">// Compute damping as velocity decay per timestep (Langevin friction)</span></span>
<span id="cb1-1245"><a href="#cb1-1245" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">computeDamping</span>(viscosity<span class="op">,</span> radius<span class="op">,</span> dt) {</span>
<span id="cb1-1246"><a href="#cb1-1246" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> gamma <span class="op">=</span> <span class="dv">6</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span> <span class="op">*</span> viscosity <span class="op">*</span> radius<span class="op">;</span> <span class="co">// friction coeff</span></span>
<span id="cb1-1247"><a href="#cb1-1247" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">exp</span>(<span class="op">-</span>gamma <span class="op">*</span> dt)<span class="op">;</span></span>
<span id="cb1-1248"><a href="#cb1-1248" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-1249"><a href="#cb1-1249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1250"><a href="#cb1-1250" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> damping <span class="op">=</span> <span class="fu">computeDamping</span>(viscosity<span class="op">,</span> particleRadius<span class="op">,</span> timeStep)<span class="op">;</span></span>
<span id="cb1-1251"><a href="#cb1-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1252"><a href="#cb1-1252" aria-hidden="true" tabindex="-1"></a><span class="co">// Create SVG</span></span>
<span id="cb1-1253"><a href="#cb1-1253" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> svg <span class="op">=</span> d3<span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb1-1254"><a href="#cb1-1254" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> width)</span>
<span id="cb1-1255"><a href="#cb1-1255" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> height)</span>
<span id="cb1-1256"><a href="#cb1-1256" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">style</span>(<span class="st">"border"</span><span class="op">,</span> <span class="st">"1px solid #ccc"</span>)</span>
<span id="cb1-1257"><a href="#cb1-1257" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">style</span>(<span class="st">"background"</span><span class="op">,</span> <span class="st">"#f9f9f9"</span>)<span class="op">;</span></span>
<span id="cb1-1258"><a href="#cb1-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1259"><a href="#cb1-1259" aria-hidden="true" tabindex="-1"></a><span class="co">// Initialize circles</span></span>
<span id="cb1-1260"><a href="#cb1-1260" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> circles <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">from</span>({ <span class="dt">length</span><span class="op">:</span> numCircles }<span class="op">,</span> (_<span class="op">,</span> i) <span class="kw">=&gt;</span> ({</span>
<span id="cb1-1261"><a href="#cb1-1261" aria-hidden="true" tabindex="-1"></a>  <span class="dt">id</span><span class="op">:</span> i<span class="op">,</span></span>
<span id="cb1-1262"><a href="#cb1-1262" aria-hidden="true" tabindex="-1"></a>  <span class="dt">x</span><span class="op">:</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>() <span class="op">*</span> width<span class="op">,</span></span>
<span id="cb1-1263"><a href="#cb1-1263" aria-hidden="true" tabindex="-1"></a>  <span class="dt">y</span><span class="op">:</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>() <span class="op">*</span> height <span class="op">*</span> <span class="fl">0.3</span><span class="op">,</span></span>
<span id="cb1-1264"><a href="#cb1-1264" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vx</span><span class="op">:</span> (<span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>() <span class="op">-</span> <span class="fl">0.5</span>) <span class="op">*</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb1-1265"><a href="#cb1-1265" aria-hidden="true" tabindex="-1"></a>  <span class="dt">vy</span><span class="op">:</span> (<span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>() <span class="op">-</span> <span class="fl">0.5</span>) <span class="op">*</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb1-1266"><a href="#cb1-1266" aria-hidden="true" tabindex="-1"></a>  <span class="dt">radius</span><span class="op">:</span> particleRadius<span class="op">,</span></span>
<span id="cb1-1267"><a href="#cb1-1267" aria-hidden="true" tabindex="-1"></a>  <span class="dt">color</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">interpolateYlOrBr</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>() <span class="op">*</span> <span class="fl">0.5</span> <span class="op">+</span> <span class="fl">0.25</span>)</span>
<span id="cb1-1268"><a href="#cb1-1268" aria-hidden="true" tabindex="-1"></a>}))<span class="op">;</span></span>
<span id="cb1-1269"><a href="#cb1-1269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1270"><a href="#cb1-1270" aria-hidden="true" tabindex="-1"></a><span class="co">// Create circles in SVG</span></span>
<span id="cb1-1271"><a href="#cb1-1271" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> circleElements <span class="op">=</span> svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"circle"</span>)</span>
<span id="cb1-1272"><a href="#cb1-1272" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">data</span>(circles)</span>
<span id="cb1-1273"><a href="#cb1-1273" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb1-1274"><a href="#cb1-1274" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">append</span>(<span class="st">"circle"</span>)</span>
<span id="cb1-1275"><a href="#cb1-1275" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"r"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">radius</span>)</span>
<span id="cb1-1276"><a href="#cb1-1276" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">color</span>)</span>
<span id="cb1-1277"><a href="#cb1-1277" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="fl">0.8</span>)</span>
<span id="cb1-1278"><a href="#cb1-1278" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"#333"</span>)</span>
<span id="cb1-1279"><a href="#cb1-1279" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb1-1280"><a href="#cb1-1280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1281"><a href="#cb1-1281" aria-hidden="true" tabindex="-1"></a><span class="co">// Collision detection &amp; response</span></span>
<span id="cb1-1282"><a href="#cb1-1282" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">handleCollisions</span>() {</span>
<span id="cb1-1283"><a href="#cb1-1283" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> circles<span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb1-1284"><a href="#cb1-1284" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">let</span> j <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;</span> circles<span class="op">.</span><span class="at">length</span><span class="op">;</span> j<span class="op">++</span>) {</span>
<span id="cb1-1285"><a href="#cb1-1285" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> c1 <span class="op">=</span> circles[i]<span class="op">;</span></span>
<span id="cb1-1286"><a href="#cb1-1286" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> c2 <span class="op">=</span> circles[j]<span class="op">;</span></span>
<span id="cb1-1287"><a href="#cb1-1287" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> dx <span class="op">=</span> c2<span class="op">.</span><span class="at">x</span> <span class="op">-</span> c1<span class="op">.</span><span class="at">x</span><span class="op">;</span></span>
<span id="cb1-1288"><a href="#cb1-1288" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> dy <span class="op">=</span> c2<span class="op">.</span><span class="at">y</span> <span class="op">-</span> c1<span class="op">.</span><span class="at">y</span><span class="op">;</span></span>
<span id="cb1-1289"><a href="#cb1-1289" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> dist <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">hypot</span>(dx<span class="op">,</span> dy)<span class="op">;</span></span>
<span id="cb1-1290"><a href="#cb1-1290" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> minDist <span class="op">=</span> c1<span class="op">.</span><span class="at">radius</span> <span class="op">+</span> c2<span class="op">.</span><span class="at">radius</span><span class="op">;</span></span>
<span id="cb1-1291"><a href="#cb1-1291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1292"><a href="#cb1-1292" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (dist <span class="op">&lt;</span> minDist <span class="op">&amp;&amp;</span> dist <span class="op">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb1-1293"><a href="#cb1-1293" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> overlap <span class="op">=</span> minDist <span class="op">-</span> dist<span class="op">;</span></span>
<span id="cb1-1294"><a href="#cb1-1294" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> nx <span class="op">=</span> dx <span class="op">/</span> dist<span class="op">;</span></span>
<span id="cb1-1295"><a href="#cb1-1295" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> ny <span class="op">=</span> dy <span class="op">/</span> dist<span class="op">;</span></span>
<span id="cb1-1296"><a href="#cb1-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1297"><a href="#cb1-1297" aria-hidden="true" tabindex="-1"></a>        c1<span class="op">.</span><span class="at">x</span> <span class="op">-=</span> nx <span class="op">*</span> overlap <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb1-1298"><a href="#cb1-1298" aria-hidden="true" tabindex="-1"></a>        c1<span class="op">.</span><span class="at">y</span> <span class="op">-=</span> ny <span class="op">*</span> overlap <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb1-1299"><a href="#cb1-1299" aria-hidden="true" tabindex="-1"></a>        c2<span class="op">.</span><span class="at">x</span> <span class="op">+=</span> nx <span class="op">*</span> overlap <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb1-1300"><a href="#cb1-1300" aria-hidden="true" tabindex="-1"></a>        c2<span class="op">.</span><span class="at">y</span> <span class="op">+=</span> ny <span class="op">*</span> overlap <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb1-1301"><a href="#cb1-1301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1302"><a href="#cb1-1302" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> dvx <span class="op">=</span> c2<span class="op">.</span><span class="at">vx</span> <span class="op">-</span> c1<span class="op">.</span><span class="at">vx</span><span class="op">;</span></span>
<span id="cb1-1303"><a href="#cb1-1303" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> dvy <span class="op">=</span> c2<span class="op">.</span><span class="at">vy</span> <span class="op">-</span> c1<span class="op">.</span><span class="at">vy</span><span class="op">;</span></span>
<span id="cb1-1304"><a href="#cb1-1304" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> vn <span class="op">=</span> dvx <span class="op">*</span> nx <span class="op">+</span> dvy <span class="op">*</span> ny<span class="op">;</span></span>
<span id="cb1-1305"><a href="#cb1-1305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1306"><a href="#cb1-1306" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (vn <span class="op">&gt;</span> <span class="dv">0</span>) <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb1-1307"><a href="#cb1-1307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1308"><a href="#cb1-1308" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> restitution <span class="op">=</span> <span class="fl">1.0</span><span class="op">;</span></span>
<span id="cb1-1309"><a href="#cb1-1309" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> impulse <span class="op">=</span> (<span class="op">-</span>(<span class="dv">1</span> <span class="op">+</span> restitution) <span class="op">*</span> vn) <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb1-1310"><a href="#cb1-1310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1311"><a href="#cb1-1311" aria-hidden="true" tabindex="-1"></a>        c1<span class="op">.</span><span class="at">vx</span> <span class="op">-=</span> impulse <span class="op">*</span> nx<span class="op">;</span></span>
<span id="cb1-1312"><a href="#cb1-1312" aria-hidden="true" tabindex="-1"></a>        c1<span class="op">.</span><span class="at">vy</span> <span class="op">-=</span> impulse <span class="op">*</span> ny<span class="op">;</span></span>
<span id="cb1-1313"><a href="#cb1-1313" aria-hidden="true" tabindex="-1"></a>        c2<span class="op">.</span><span class="at">vx</span> <span class="op">+=</span> impulse <span class="op">*</span> nx<span class="op">;</span></span>
<span id="cb1-1314"><a href="#cb1-1314" aria-hidden="true" tabindex="-1"></a>        c2<span class="op">.</span><span class="at">vy</span> <span class="op">+=</span> impulse <span class="op">*</span> ny<span class="op">;</span></span>
<span id="cb1-1315"><a href="#cb1-1315" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb1-1316"><a href="#cb1-1316" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-1317"><a href="#cb1-1317" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-1318"><a href="#cb1-1318" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-1319"><a href="#cb1-1319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1320"><a href="#cb1-1320" aria-hidden="true" tabindex="-1"></a><span class="co">// Update damping when viscosity or timestep changes</span></span>
<span id="cb1-1321"><a href="#cb1-1321" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">updateDamping</span>() {</span>
<span id="cb1-1322"><a href="#cb1-1322" aria-hidden="true" tabindex="-1"></a>  damping <span class="op">=</span> <span class="fu">computeDamping</span>(viscosity<span class="op">,</span> particleRadius<span class="op">,</span> timeStep)<span class="op">;</span></span>
<span id="cb1-1323"><a href="#cb1-1323" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-1324"><a href="#cb1-1324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1325"><a href="#cb1-1325" aria-hidden="true" tabindex="-1"></a><span class="co">// Animate function</span></span>
<span id="cb1-1326"><a href="#cb1-1326" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">animate</span>() {</span>
<span id="cb1-1327"><a href="#cb1-1327" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> diffusion <span class="op">=</span> (kB <span class="op">*</span> temperature) <span class="op">/</span> (<span class="dv">6</span> <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="cn">PI</span> <span class="op">*</span> viscosity <span class="op">*</span> particleRadius)<span class="op">;</span></span>
<span id="cb1-1328"><a href="#cb1-1328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1329"><a href="#cb1-1329" aria-hidden="true" tabindex="-1"></a>  circles<span class="op">.</span><span class="fu">forEach</span>(c <span class="kw">=&gt;</span> {</span>
<span id="cb1-1330"><a href="#cb1-1330" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Apply gravity</span></span>
<span id="cb1-1331"><a href="#cb1-1331" aria-hidden="true" tabindex="-1"></a>    c<span class="op">.</span><span class="at">vy</span> <span class="op">+=</span> gravity <span class="op">*</span> timeStep<span class="op">;</span></span>
<span id="cb1-1332"><a href="#cb1-1332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1333"><a href="#cb1-1333" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Diffusion random kick scaled by sqrt(2*D/dt)</span></span>
<span id="cb1-1334"><a href="#cb1-1334" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> diffusionForce <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(<span class="dv">2</span> <span class="op">*</span> diffusion <span class="op">/</span> timeStep)<span class="op">;</span></span>
<span id="cb1-1335"><a href="#cb1-1335" aria-hidden="true" tabindex="-1"></a>    c<span class="op">.</span><span class="at">vx</span> <span class="op">+=</span> (<span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>() <span class="op">-</span> <span class="fl">0.5</span>) <span class="op">*</span> diffusionForce<span class="op">;</span></span>
<span id="cb1-1336"><a href="#cb1-1336" aria-hidden="true" tabindex="-1"></a>    c<span class="op">.</span><span class="at">vy</span> <span class="op">+=</span> (<span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>() <span class="op">-</span> <span class="fl">0.5</span>) <span class="op">*</span> diffusionForce<span class="op">;</span></span>
<span id="cb1-1337"><a href="#cb1-1337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1338"><a href="#cb1-1338" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Apply damping</span></span>
<span id="cb1-1339"><a href="#cb1-1339" aria-hidden="true" tabindex="-1"></a>    c<span class="op">.</span><span class="at">vx</span> <span class="op">*=</span> damping<span class="op">;</span></span>
<span id="cb1-1340"><a href="#cb1-1340" aria-hidden="true" tabindex="-1"></a>    c<span class="op">.</span><span class="at">vy</span> <span class="op">*=</span> damping<span class="op">;</span></span>
<span id="cb1-1341"><a href="#cb1-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1342"><a href="#cb1-1342" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Update position</span></span>
<span id="cb1-1343"><a href="#cb1-1343" aria-hidden="true" tabindex="-1"></a>    c<span class="op">.</span><span class="at">x</span> <span class="op">+=</span> c<span class="op">.</span><span class="at">vx</span> <span class="op">*</span> timeStep<span class="op">;</span></span>
<span id="cb1-1344"><a href="#cb1-1344" aria-hidden="true" tabindex="-1"></a>    c<span class="op">.</span><span class="at">y</span> <span class="op">+=</span> c<span class="op">.</span><span class="at">vy</span> <span class="op">*</span> timeStep<span class="op">;</span></span>
<span id="cb1-1345"><a href="#cb1-1345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1346"><a href="#cb1-1346" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Boundary collision</span></span>
<span id="cb1-1347"><a href="#cb1-1347" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (c<span class="op">.</span><span class="at">x</span> <span class="op">-</span> c<span class="op">.</span><span class="at">radius</span> <span class="op">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb1-1348"><a href="#cb1-1348" aria-hidden="true" tabindex="-1"></a>      c<span class="op">.</span><span class="at">x</span> <span class="op">=</span> c<span class="op">.</span><span class="at">radius</span><span class="op">;</span></span>
<span id="cb1-1349"><a href="#cb1-1349" aria-hidden="true" tabindex="-1"></a>      c<span class="op">.</span><span class="at">vx</span> <span class="op">*=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-1350"><a href="#cb1-1350" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-1351"><a href="#cb1-1351" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (c<span class="op">.</span><span class="at">x</span> <span class="op">+</span> c<span class="op">.</span><span class="at">radius</span> <span class="op">&gt;</span> width) {</span>
<span id="cb1-1352"><a href="#cb1-1352" aria-hidden="true" tabindex="-1"></a>      c<span class="op">.</span><span class="at">x</span> <span class="op">=</span> width <span class="op">-</span> c<span class="op">.</span><span class="at">radius</span><span class="op">;</span></span>
<span id="cb1-1353"><a href="#cb1-1353" aria-hidden="true" tabindex="-1"></a>      c<span class="op">.</span><span class="at">vx</span> <span class="op">*=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-1354"><a href="#cb1-1354" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-1355"><a href="#cb1-1355" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (c<span class="op">.</span><span class="at">y</span> <span class="op">-</span> c<span class="op">.</span><span class="at">radius</span> <span class="op">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb1-1356"><a href="#cb1-1356" aria-hidden="true" tabindex="-1"></a>      c<span class="op">.</span><span class="at">y</span> <span class="op">=</span> c<span class="op">.</span><span class="at">radius</span><span class="op">;</span></span>
<span id="cb1-1357"><a href="#cb1-1357" aria-hidden="true" tabindex="-1"></a>      c<span class="op">.</span><span class="at">vy</span> <span class="op">*=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-1358"><a href="#cb1-1358" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-1359"><a href="#cb1-1359" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (c<span class="op">.</span><span class="at">y</span> <span class="op">+</span> c<span class="op">.</span><span class="at">radius</span> <span class="op">&gt;</span> height) {</span>
<span id="cb1-1360"><a href="#cb1-1360" aria-hidden="true" tabindex="-1"></a>      c<span class="op">.</span><span class="at">y</span> <span class="op">=</span> height <span class="op">-</span> c<span class="op">.</span><span class="at">radius</span><span class="op">;</span></span>
<span id="cb1-1361"><a href="#cb1-1361" aria-hidden="true" tabindex="-1"></a>      c<span class="op">.</span><span class="at">vy</span> <span class="op">*=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-1362"><a href="#cb1-1362" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-1363"><a href="#cb1-1363" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb1-1364"><a href="#cb1-1364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1365"><a href="#cb1-1365" aria-hidden="true" tabindex="-1"></a>  <span class="fu">handleCollisions</span>()<span class="op">;</span></span>
<span id="cb1-1366"><a href="#cb1-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1367"><a href="#cb1-1367" aria-hidden="true" tabindex="-1"></a>  circleElements</span>
<span id="cb1-1368"><a href="#cb1-1368" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cx"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">x</span>)</span>
<span id="cb1-1369"><a href="#cb1-1369" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"cy"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">y</span>)<span class="op">;</span></span>
<span id="cb1-1370"><a href="#cb1-1370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1371"><a href="#cb1-1371" aria-hidden="true" tabindex="-1"></a>  diffusionDisplay<span class="op">.</span><span class="fu">text</span>(<span class="vs">`Diffusion: </span><span class="sc">${</span>diffusion<span class="op">.</span><span class="fu">toFixed</span>(<span class="dv">4</span>)<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb1-1372"><a href="#cb1-1372" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-1373"><a href="#cb1-1373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1374"><a href="#cb1-1374" aria-hidden="true" tabindex="-1"></a><span class="co">// Start timer</span></span>
<span id="cb1-1375"><a href="#cb1-1375" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> timer <span class="op">=</span> d3<span class="op">.</span><span class="fu">timer</span>(animate)<span class="op">;</span></span>
<span id="cb1-1376"><a href="#cb1-1376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1377"><a href="#cb1-1377" aria-hidden="true" tabindex="-1"></a><span class="co">// Controls container</span></span>
<span id="cb1-1378"><a href="#cb1-1378" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> controls <span class="op">=</span> d3<span class="op">.</span><span class="fu">create</span>(<span class="st">"div"</span>)</span>
<span id="cb1-1379"><a href="#cb1-1379" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">style</span>(<span class="st">"margin-top"</span><span class="op">,</span> <span class="st">"10px"</span>)</span>
<span id="cb1-1380"><a href="#cb1-1380" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">style</span>(<span class="st">"padding"</span><span class="op">,</span> <span class="st">"10px"</span>)</span>
<span id="cb1-1381"><a href="#cb1-1381" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">style</span>(<span class="st">"background"</span><span class="op">,</span> <span class="st">"#f0f0f0"</span>)</span>
<span id="cb1-1382"><a href="#cb1-1382" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">style</span>(<span class="st">"border-radius"</span><span class="op">,</span> <span class="st">"8px"</span>)</span>
<span id="cb1-1383"><a href="#cb1-1383" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">style</span>(<span class="st">"width"</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>width<span class="sc">}</span><span class="vs">px`</span>)<span class="op">;</span></span>
<span id="cb1-1384"><a href="#cb1-1384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1385"><a href="#cb1-1385" aria-hidden="true" tabindex="-1"></a><span class="co">// Slider factory</span></span>
<span id="cb1-1386"><a href="#cb1-1386" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">createSlider</span>(labelText<span class="op">,</span> min<span class="op">,</span> max<span class="op">,</span> initial<span class="op">,</span> step<span class="op">,</span> onChange) {</span>
<span id="cb1-1387"><a href="#cb1-1387" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> container <span class="op">=</span> controls<span class="op">.</span><span class="fu">append</span>(<span class="st">"div"</span>)</span>
<span id="cb1-1388"><a href="#cb1-1388" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"margin-bottom"</span><span class="op">,</span> <span class="st">"10px"</span>)</span>
<span id="cb1-1389"><a href="#cb1-1389" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"display"</span><span class="op">,</span> <span class="st">"flex"</span>)</span>
<span id="cb1-1390"><a href="#cb1-1390" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"align-items"</span><span class="op">,</span> <span class="st">"center"</span>)</span>
<span id="cb1-1391"><a href="#cb1-1391" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"gap"</span><span class="op">,</span> <span class="st">"10px"</span>)<span class="op">;</span></span>
<span id="cb1-1392"><a href="#cb1-1392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1393"><a href="#cb1-1393" aria-hidden="true" tabindex="-1"></a>  container<span class="op">.</span><span class="fu">append</span>(<span class="st">"label"</span>)</span>
<span id="cb1-1394"><a href="#cb1-1394" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(labelText)</span>
<span id="cb1-1395"><a href="#cb1-1395" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"min-width"</span><span class="op">,</span> <span class="st">"120px"</span>)</span>
<span id="cb1-1396"><a href="#cb1-1396" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-weight"</span><span class="op">,</span> <span class="st">"bold"</span>)<span class="op">;</span></span>
<span id="cb1-1397"><a href="#cb1-1397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1398"><a href="#cb1-1398" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> slider <span class="op">=</span> container<span class="op">.</span><span class="fu">append</span>(<span class="st">"input"</span>)</span>
<span id="cb1-1399"><a href="#cb1-1399" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"type"</span><span class="op">,</span> <span class="st">"range"</span>)</span>
<span id="cb1-1400"><a href="#cb1-1400" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"min"</span><span class="op">,</span> min)</span>
<span id="cb1-1401"><a href="#cb1-1401" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"max"</span><span class="op">,</span> max)</span>
<span id="cb1-1402"><a href="#cb1-1402" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"step"</span><span class="op">,</span> step)</span>
<span id="cb1-1403"><a href="#cb1-1403" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"value"</span><span class="op">,</span> initial)</span>
<span id="cb1-1404"><a href="#cb1-1404" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"flex"</span><span class="op">,</span> <span class="st">"1"</span>)<span class="op">;</span></span>
<span id="cb1-1405"><a href="#cb1-1405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1406"><a href="#cb1-1406" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> valueDisplay <span class="op">=</span> container<span class="op">.</span><span class="fu">append</span>(<span class="st">"span"</span>)</span>
<span id="cb1-1407"><a href="#cb1-1407" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(initial<span class="op">.</span><span class="fu">toFixed</span>(step <span class="op">&lt;</span> <span class="dv">1</span> <span class="op">?</span> <span class="dv">4</span> <span class="op">:</span> <span class="dv">0</span>))</span>
<span id="cb1-1408"><a href="#cb1-1408" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"width"</span><span class="op">,</span> <span class="st">"50px"</span>)</span>
<span id="cb1-1409"><a href="#cb1-1409" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"text-align"</span><span class="op">,</span> <span class="st">"right"</span>)</span>
<span id="cb1-1410"><a href="#cb1-1410" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"monospace"</span>)<span class="op">;</span></span>
<span id="cb1-1411"><a href="#cb1-1411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1412"><a href="#cb1-1412" aria-hidden="true" tabindex="-1"></a>  slider<span class="op">.</span><span class="fu">on</span>(<span class="st">"input"</span><span class="op">,</span> <span class="kw">function</span> () {</span>
<span id="cb1-1413"><a href="#cb1-1413" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> val <span class="op">=</span> <span class="op">+</span><span class="kw">this</span><span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="cb1-1414"><a href="#cb1-1414" aria-hidden="true" tabindex="-1"></a>    <span class="fu">onChange</span>(val)<span class="op">;</span></span>
<span id="cb1-1415"><a href="#cb1-1415" aria-hidden="true" tabindex="-1"></a>    valueDisplay<span class="op">.</span><span class="fu">text</span>(val<span class="op">.</span><span class="fu">toFixed</span>(step <span class="op">&lt;</span> <span class="dv">1</span> <span class="op">?</span> <span class="dv">4</span> <span class="op">:</span> <span class="dv">0</span>))<span class="op">;</span></span>
<span id="cb1-1416"><a href="#cb1-1416" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb1-1417"><a href="#cb1-1417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1418"><a href="#cb1-1418" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> slider<span class="op">;</span></span>
<span id="cb1-1419"><a href="#cb1-1419" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-1420"><a href="#cb1-1420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1421"><a href="#cb1-1421" aria-hidden="true" tabindex="-1"></a><span class="co">// Create sliders</span></span>
<span id="cb1-1422"><a href="#cb1-1422" aria-hidden="true" tabindex="-1"></a><span class="fu">createSlider</span>(<span class="st">"Gravity"</span><span class="op">,</span> <span class="op">-</span><span class="dv">100</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> gravity <span class="op">/</span> gravityFactor<span class="op">,</span> <span class="dv">10</span><span class="op">,</span> v <span class="kw">=&gt;</span> gravity <span class="op">=</span> v <span class="op">*</span> gravityFactor)<span class="op">;</span></span>
<span id="cb1-1423"><a href="#cb1-1423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1424"><a href="#cb1-1424" aria-hidden="true" tabindex="-1"></a><span class="fu">createSlider</span>(<span class="st">"Temperature"</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1000</span><span class="op">,</span> temperature<span class="op">,</span> <span class="dv">10</span><span class="op">,</span> v <span class="kw">=&gt;</span> temperature <span class="op">=</span> v)<span class="op">;</span></span>
<span id="cb1-1425"><a href="#cb1-1425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1426"><a href="#cb1-1426" aria-hidden="true" tabindex="-1"></a><span class="fu">createSlider</span>(<span class="st">"Viscosity"</span><span class="op">,</span> <span class="fl">0.001</span><span class="op">,</span> <span class="fl">0.1</span><span class="op">,</span> viscosity<span class="op">,</span> <span class="fl">0.001</span><span class="op">,</span> v <span class="kw">=&gt;</span> {</span>
<span id="cb1-1427"><a href="#cb1-1427" aria-hidden="true" tabindex="-1"></a>  viscosity <span class="op">=</span> v<span class="op">;</span></span>
<span id="cb1-1428"><a href="#cb1-1428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">updateDamping</span>()<span class="op">;</span></span>
<span id="cb1-1429"><a href="#cb1-1429" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb1-1430"><a href="#cb1-1430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1431"><a href="#cb1-1431" aria-hidden="true" tabindex="-1"></a><span class="co">// createSlider("Time Step", 0.1, 5, timeStep, 0.1, v =&gt; {</span></span>
<span id="cb1-1432"><a href="#cb1-1432" aria-hidden="true" tabindex="-1"></a><span class="co">//   timeStep = v;</span></span>
<span id="cb1-1433"><a href="#cb1-1433" aria-hidden="true" tabindex="-1"></a><span class="co">//   updateDamping();</span></span>
<span id="cb1-1434"><a href="#cb1-1434" aria-hidden="true" tabindex="-1"></a><span class="co">// });</span></span>
<span id="cb1-1435"><a href="#cb1-1435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1436"><a href="#cb1-1436" aria-hidden="true" tabindex="-1"></a><span class="co">// Diffusion display</span></span>
<span id="cb1-1437"><a href="#cb1-1437" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> diffusionDisplay <span class="op">=</span> controls<span class="op">.</span><span class="fu">append</span>(<span class="st">"div"</span>)</span>
<span id="cb1-1438"><a href="#cb1-1438" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">style</span>(<span class="st">"margin-top"</span><span class="op">,</span> <span class="st">"10px"</span>)</span>
<span id="cb1-1439"><a href="#cb1-1439" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-family"</span><span class="op">,</span> <span class="st">"monospace"</span>)</span>
<span id="cb1-1440"><a href="#cb1-1440" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-weight"</span><span class="op">,</span> <span class="st">"bold"</span>)</span>
<span id="cb1-1441"><a href="#cb1-1441" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">text</span>(<span class="st">""</span>)<span class="op">;</span></span>
<span id="cb1-1442"><a href="#cb1-1442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1443"><a href="#cb1-1443" aria-hidden="true" tabindex="-1"></a><span class="co">// Reset button</span></span>
<span id="cb1-1444"><a href="#cb1-1444" aria-hidden="true" tabindex="-1"></a>controls<span class="op">.</span><span class="fu">append</span>(<span class="st">"button"</span>)</span>
<span id="cb1-1445"><a href="#cb1-1445" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">text</span>(<span class="st">"Reset Positions"</span>)</span>
<span id="cb1-1446"><a href="#cb1-1446" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">style</span>(<span class="st">"margin-top"</span><span class="op">,</span> <span class="st">"10px"</span>)</span>
<span id="cb1-1447"><a href="#cb1-1447" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">style</span>(<span class="st">"padding"</span><span class="op">,</span> <span class="st">"6px 12px"</span>)</span>
<span id="cb1-1448"><a href="#cb1-1448" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">on</span>(<span class="st">"click"</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb1-1449"><a href="#cb1-1449" aria-hidden="true" tabindex="-1"></a>    circles<span class="op">.</span><span class="fu">forEach</span>(c <span class="kw">=&gt;</span> {</span>
<span id="cb1-1450"><a href="#cb1-1450" aria-hidden="true" tabindex="-1"></a>      c<span class="op">.</span><span class="at">x</span> <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>() <span class="op">*</span> width<span class="op">;</span></span>
<span id="cb1-1451"><a href="#cb1-1451" aria-hidden="true" tabindex="-1"></a>      c<span class="op">.</span><span class="at">y</span> <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>() <span class="op">*</span> height <span class="op">*</span> <span class="fl">0.3</span><span class="op">;</span></span>
<span id="cb1-1452"><a href="#cb1-1452" aria-hidden="true" tabindex="-1"></a>      c<span class="op">.</span><span class="at">vx</span> <span class="op">=</span> (<span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>() <span class="op">-</span> <span class="fl">0.5</span>) <span class="op">*</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb1-1453"><a href="#cb1-1453" aria-hidden="true" tabindex="-1"></a>      c<span class="op">.</span><span class="at">vy</span> <span class="op">=</span> (<span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>() <span class="op">-</span> <span class="fl">0.5</span>) <span class="op">*</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb1-1454"><a href="#cb1-1454" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb1-1455"><a href="#cb1-1455" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb1-1456"><a href="#cb1-1456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1457"><a href="#cb1-1457" aria-hidden="true" tabindex="-1"></a><span class="co">// Start/Stop toggle</span></span>
<span id="cb1-1458"><a href="#cb1-1458" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> startStopBtn <span class="op">=</span> controls<span class="op">.</span><span class="fu">append</span>(<span class="st">"button"</span>)</span>
<span id="cb1-1459"><a href="#cb1-1459" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">text</span>(<span class="st">"Stop"</span>)</span>
<span id="cb1-1460"><a href="#cb1-1460" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">style</span>(<span class="st">"margin-left"</span><span class="op">,</span> <span class="st">"10px"</span>)</span>
<span id="cb1-1461"><a href="#cb1-1461" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">style</span>(<span class="st">"padding"</span><span class="op">,</span> <span class="st">"6px 12px"</span>)</span>
<span id="cb1-1462"><a href="#cb1-1462" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">on</span>(<span class="st">"click"</span><span class="op">,</span> <span class="kw">function</span> () {</span>
<span id="cb1-1463"><a href="#cb1-1463" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (timer<span class="op">.</span><span class="at">_call</span>) {</span>
<span id="cb1-1464"><a href="#cb1-1464" aria-hidden="true" tabindex="-1"></a>      timer<span class="op">.</span><span class="fu">stop</span>()<span class="op">;</span></span>
<span id="cb1-1465"><a href="#cb1-1465" aria-hidden="true" tabindex="-1"></a>      <span class="kw">this</span><span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="st">"Start"</span><span class="op">;</span></span>
<span id="cb1-1466"><a href="#cb1-1466" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb1-1467"><a href="#cb1-1467" aria-hidden="true" tabindex="-1"></a>      timer<span class="op">.</span><span class="fu">restart</span>(animate)<span class="op">;</span></span>
<span id="cb1-1468"><a href="#cb1-1468" aria-hidden="true" tabindex="-1"></a>      <span class="kw">this</span><span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="st">"Stop"</span><span class="op">;</span></span>
<span id="cb1-1469"><a href="#cb1-1469" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-1470"><a href="#cb1-1470" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb1-1471"><a href="#cb1-1471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1472"><a href="#cb1-1472" aria-hidden="true" tabindex="-1"></a><span class="co">// Container div</span></span>
<span id="cb1-1473"><a href="#cb1-1473" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> container <span class="op">=</span> d3<span class="op">.</span><span class="fu">create</span>(<span class="st">"div"</span>)<span class="op">;</span></span>
<span id="cb1-1474"><a href="#cb1-1474" aria-hidden="true" tabindex="-1"></a>container<span class="op">.</span><span class="fu">node</span>()<span class="op">.</span><span class="fu">appendChild</span>(svg<span class="op">.</span><span class="fu">node</span>())<span class="op">;</span></span>
<span id="cb1-1475"><a href="#cb1-1475" aria-hidden="true" tabindex="-1"></a>container<span class="op">.</span><span class="fu">node</span>()<span class="op">.</span><span class="fu">appendChild</span>(controls<span class="op">.</span><span class="fu">node</span>())<span class="op">;</span></span>
<span id="cb1-1476"><a href="#cb1-1476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-1477"><a href="#cb1-1477" aria-hidden="true" tabindex="-1"></a><span class="cf">return</span> container<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb1-1478"><a href="#cb1-1478" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-1" data-nodetype="expression">

</div>
</div>
</div>
<!-- ![](https://cdn.mathpix.com/cropped/2025_01_27_a9af280ad9752fe3d0c0g-13.jpg?height=291&width=619&top_left_y=1597&top_left_x=466) -->
<p>In the case of gravity, this leads to a sedimentation equilibrium. (a) Flux due to external force, <span class="math inline">\(J_{F}\)</span></p>
<p>The velocity of a particle under an applied force <span class="math inline">\(F\)</span> in a viscous fluid can be written as <span class="math inline">\(v=\)</span> <span class="math inline">\(F / \xi\)</span> which defines the friction coefficient <span class="math inline">\(\xi\)</span>. Hence</p>
<p><span class="math display">\[
J_{F}=n(x) v=\frac{n(x) F}{\xi}
\]</span></p>
<ol start="2" type="a">
<li>Diffusive flux, <span class="math inline">\(J_{D}\)</span> <span class="math inline">\(J_{D}\)</span> is given by Fick’s Law (see above):</li>
</ol>
<p><span class="math display">\[
J_{D}(x)=-D \frac{\partial n(x)}{\partial x}
\]</span></p>
<p>Equating the two fluxes <span class="math inline">\(J_{F}=J_{D}\)</span> we get</p>
<p><span class="math display">\[
\frac{n(x) F}{\xi}=-D \frac{\partial n(x)}{d x}=+D \frac{F}{k_{B} T} n(x)
\]</span></p>
<p>The second equation is obtained by differentiating the Maxwell-Boltzmann distribution. This gives the relation between the diffusion and friction coefficients:</p>
<p><span class="math display">\[
D=\frac{k_{B} T}{\xi}=\frac{k_{B} T}{6 \pi \eta R}
\]</span></p>
<p>The last equation applies to a spherical particle of radius <span class="math inline">\(R\)</span> in a fluid of viscosity <span class="math inline">\(\eta\)</span>, for which Stokes’s Law gives <span class="math inline">\(\xi=6 \pi \eta R\)</span> (which applies only at low Reynold’s number, <span class="math inline">\(\rho R v / \eta\)</span> <span class="math inline">\(\ll 1\)</span> ) resulting in the Stokes-Einstein (and Sutherland) relation.</p>
<ul>
<li><p>The Stokes-Einstein relation is a very deep result. It relates equilibrium fluctuations in a system to the energy dissipation when the system is driven off equilibrium. Here, the fluctuations in the fluid give rise to the diffusive motion of the suspended particle and <span class="math inline">\(D\)</span> is therefore the ‘fluctuation’ part. A sheared fluid will dissipate energy because of its finite viscosity and thus <span class="math inline">\(\eta\)</span> represents the dissipative part.</p></li>
<li><p>More generally, Brownian motion sets a natural limit to the precision of physical measurements. Example from the <a href="https://www.feynmanlectures.caltech.edu/I_41.html">Feynman Lectures</a>:</p>
<blockquote class="blockquote">
<p>A mirror suspended on a torsion fibre reflects a spot of light onto a scale. The spot will jiggle due to the random impact of air molecules and the random motion of atoms in the quartz fibre. To reduce the jiggle, the apparatus has to be cooled. The relation between fluctuation and dissipation tells us where to cool. ‘This depends upon where [the mirror] is getting its ’kicks’ from. If it is through the fibre, we cool it … if the mirror is surrounded by a gas and is getting hit mostly by collisions in the gas, it is better to cool the gas. As a matter of fact, if we know where the damping of the oscillations comes from, it turns out that that is always the source of the fluctuations. (Adapted from Feynman, Chapter 41)</p>
</blockquote></li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Check your understanding
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Colloids are mixtures with dispersed particles (1 nm – 1 μm) that remain suspended due to Brownian motion.</li>
<li>Stability of colloids depends on the balance between attractive (van der Waals) and repulsive (double layer) interactions.</li>
<li>The DLVO theory combines van der Waals attraction and double layer repulsion to explain colloidal stability and aggregation.</li>
<li>Entropic effects (e.g., depletion interactions) can induce effective attractions even in purely repulsive systems.</li>
<li>Hard-sphere colloids are a fundamental model: their phase behavior is controlled by packing fraction, leading to fluid, crystalline, and metastable (jammed) states.</li>
<li>The radial distribution function <span class="math inline">\(g(r)\)</span> characterizes spatial correlations and structure in colloidal systems.</li>
<li>Dynamics of colloids are governed by Brownian motion, with diffusion slowed at higher densities due to interactions.</li>
<li>The Stokes-Einstein relation links diffusion to temperature, viscosity, and particle size.</li>
<li>Entropy can drive ordering (e.g., crystallization of hard spheres), showing that entropy is not always associated with disorder.</li>
<li>Colloidal systems serve as accessible models for studying fundamental concepts in soft matter and statistical mechanics.</li>
</ul>
</div>
</div>
<!-- ![Feynamnn schematic of a sensitive light-beam galvanometer.](https://www.feynmanlectures.caltech.edu/img/FLP_I/f41-01/f41-01_tc_big_a.svg) -->
<!-- ### Particle dynamics

#### Hard-spheres

We are interested in the mean-square displacement $\left\langle\underline{r}^{2}(t)\right\rangle$ as a function of time for different volume fractions. At low volume fractions, the particles undergo Brownian motion (random-walk diffusion) due to collisions with liquid molecules. The meansquare displacement $\left\langle\underline{r}^{2}(t)\right\rangle=6 D_{0} t$ as already seen earlier. Above $\phi \sim 0.3$, however, different regimes are observed. At short times the particles diffuse with the short time (self) diffusion constant $D_{s}$. This is determined from the short time limit and is smaller than the $D_{0}$ measured for $\phi \rightarrow 0$. The motion of the particles (self diffusion) is still driven by collisions with the liquid molecules, but in addition the interactions between particles become significant. While the particles are diffusing in their cages formed by their neighbours, the hydrodynamic interaction ![](https://cdn.mathpix.com/cropped/2025_01_27_a9af280ad9752fe3d0c0g-18.jpg?height=391&width=432&top_left_y=368&top_left_x=1351) with the neighbours, transmitted through flows in the liquid, causes slowing down relative to the free diffusion at low concentrations. At intermediate times the particles encounter the neighbours and the interactions slow the motion down. To make further progress, the particle has to break out of the cage formed by its neighbours. Now the particles experience a further interaction, direct interactions (hard-sphere interactions), in addition to the hydrodynamic interactions. The long-time and long-ranged movement is also diffusive, i.e. we still have $\left\langle\underline{r}^{2}(t)>\propto t\right.$, when the particles undergo large-scale random-walk diffusion through many cages. However, the motion is further slowed and a smaller diffusion constant relative to the motion in the short time limit is observed, the long time (self) diffusion constant $D_{L}$. ![](https://cdn.mathpix.com/cropped/2025_01_27_a9af280ad9752fe3d0c0g-19.jpg?height=777&width=1086&top_left_y=868&top_left_x=539) short time: $<r^{2}(t)>=6 D_{S} t$ short-time self diff. coeff. $D_{S}<D_{0}$ purely because of hydrodyn. interactions theoretical predictions exist intermediate time: some theory long time: $<r^{2}(t)>=6 D_{L} t$ long-time self diff. coeff. $D_{L}<D_{S}\left(<D_{0}\right)$ because of hydrodyn. and direct interactions theory very complicated, but some predictions exist. -->
</section>
</section>
<section id="references" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="references">References</h2>


<script type="pyodide-data">
eyJvcHRpb25zIjp7ImVudiI6eyJQTE9UTFlfUkVOREVSRVIiOiJwbG90bHlfbWltZXR5cGUifSwiaW5kZXhVUkwiOiJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvcHlvZGlkZS92MC4yNy4wL2Z1bGwvIn0sInBhY2thZ2VzIjp7InBrZ3MiOlsicHlvZGlkZV9odHRwIiwibWljcm9waXAiLCJpcHl0aG9uIiwibnVtcHkiLCJtYXRwbG90bGliIiwicGxvdGx5IiwibmJmb3JtYXQiXX19
</script>
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3siY2VsbE5hbWUiOiJweW9kaWRlLTgiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoidmlld29mIF9weW9kaWRlX2VkaXRvcl84ID0ge1xuICBjb25zdCB7IFB5b2RpZGVFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuXG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwicHlvZGlkZS04LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtOC1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IoXG4gICAgcHlvZGlkZU9qcy5weW9kaWRlUHJvbWlzZSxcbiAgICBibG9jay5jb2RlLFxuICAgIG9wdGlvbnNcbiAgKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl9weW9kaWRlX3ZhbHVlXzggPSBweW9kaWRlT2pzLnByb2Nlc3MoX3B5b2RpZGVfZWRpdG9yXzgsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTciLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoidmlld29mIF9weW9kaWRlX2VkaXRvcl83ID0ge1xuICBjb25zdCB7IFB5b2RpZGVFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuXG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwicHlvZGlkZS03LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtNy1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IoXG4gICAgcHlvZGlkZU9qcy5weW9kaWRlUHJvbWlzZSxcbiAgICBibG9jay5jb2RlLFxuICAgIG9wdGlvbnNcbiAgKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl9weW9kaWRlX3ZhbHVlXzcgPSBweW9kaWRlT2pzLnByb2Nlc3MoX3B5b2RpZGVfZWRpdG9yXzcsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTYiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoidmlld29mIF9weW9kaWRlX2VkaXRvcl82ID0ge1xuICBjb25zdCB7IFB5b2RpZGVFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuXG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwicHlvZGlkZS02LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtNi1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IoXG4gICAgcHlvZGlkZU9qcy5weW9kaWRlUHJvbWlzZSxcbiAgICBibG9jay5jb2RlLFxuICAgIG9wdGlvbnNcbiAgKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl9weW9kaWRlX3ZhbHVlXzYgPSBweW9kaWRlT2pzLnByb2Nlc3MoX3B5b2RpZGVfZWRpdG9yXzYsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTUiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoidmlld29mIF9weW9kaWRlX2VkaXRvcl81ID0ge1xuICBjb25zdCB7IFB5b2RpZGVFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuXG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwicHlvZGlkZS01LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtNS1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IoXG4gICAgcHlvZGlkZU9qcy5weW9kaWRlUHJvbWlzZSxcbiAgICBibG9jay5jb2RlLFxuICAgIG9wdGlvbnNcbiAgKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl9weW9kaWRlX3ZhbHVlXzUgPSBweW9kaWRlT2pzLnByb2Nlc3MoX3B5b2RpZGVfZWRpdG9yXzUsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTQiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoidmlld29mIF9weW9kaWRlX2VkaXRvcl80ID0ge1xuICBjb25zdCB7IFB5b2RpZGVFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuXG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwicHlvZGlkZS00LWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtNC1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IoXG4gICAgcHlvZGlkZU9qcy5weW9kaWRlUHJvbWlzZSxcbiAgICBibG9jay5jb2RlLFxuICAgIG9wdGlvbnNcbiAgKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl9weW9kaWRlX3ZhbHVlXzQgPSBweW9kaWRlT2pzLnByb2Nlc3MoX3B5b2RpZGVfZWRpdG9yXzQsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTMiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoidmlld29mIF9weW9kaWRlX2VkaXRvcl8zID0ge1xuICBjb25zdCB7IFB5b2RpZGVFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuXG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwicHlvZGlkZS0zLWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtMy1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IoXG4gICAgcHlvZGlkZU9qcy5weW9kaWRlUHJvbWlzZSxcbiAgICBibG9jay5jb2RlLFxuICAgIG9wdGlvbnNcbiAgKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl9weW9kaWRlX3ZhbHVlXzMgPSBweW9kaWRlT2pzLnByb2Nlc3MoX3B5b2RpZGVfZWRpdG9yXzMsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTIiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoidmlld29mIF9weW9kaWRlX2VkaXRvcl8yID0ge1xuICBjb25zdCB7IFB5b2RpZGVFeGVyY2lzZUVkaXRvciwgYjY0RGVjb2RlIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuXG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwicHlvZGlkZS0yLWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyBpZDogYHB5b2RpZGUtMi1jb250ZW50c2AgfSwgYmxvY2suYXR0cik7XG4gIGNvbnN0IGVkaXRvciA9IG5ldyBQeW9kaWRlRXhlcmNpc2VFZGl0b3IoXG4gICAgcHlvZGlkZU9qcy5weW9kaWRlUHJvbWlzZSxcbiAgICBibG9jay5jb2RlLFxuICAgIG9wdGlvbnNcbiAgKTtcblxuICByZXR1cm4gZWRpdG9yLmNvbnRhaW5lcjtcbn1cbl9weW9kaWRlX3ZhbHVlXzIgPSBweW9kaWRlT2pzLnByb2Nlc3MoX3B5b2RpZGVfZWRpdG9yXzIsIHt9KTtcbiJ9LHsiY2VsbE5hbWUiOiJweW9kaWRlLTEiLCJpbmxpbmUiOmZhbHNlLCJtZXRob2ROYW1lIjoiaW50ZXJwcmV0Iiwic291cmNlIjoiX3B5b2RpZGVfdmFsdWVfMSA9IHtcbiAgY29uc3QgeyBoaWdobGlnaHRQeXRob24sIGI2NERlY29kZX0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuXG4gIGNvbnN0IHNjcmlwdENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwicHlvZGlkZS0xLWNvbnRlbnRzXFxcIl1gKS50ZXh0Q29udGVudDtcbiAgY29uc3QgYmxvY2sgPSBKU09OLnBhcnNlKGI2NERlY29kZShzY3JpcHRDb250ZW50KSk7XG5cbiAgLy8gRGVmYXVsdCBldmFsdWF0aW9uIGNvbmZpZ3VyYXRpb25cbiAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe1xuICAgIGlkOiBcInB5b2RpZGUtMS1jb250ZW50c1wiLFxuICAgIGVjaG86IHRydWUsXG4gICAgb3V0cHV0OiB0cnVlXG4gIH0sIGJsb2NrLmF0dHIpO1xuXG4gIC8vIEV2YWx1YXRlIHRoZSBwcm92aWRlZCBQeXRob24gY29kZVxuICBjb25zdCByZXN1bHQgPSBweW9kaWRlT2pzLnByb2Nlc3Moe2NvZGU6IGJsb2NrLmNvZGUsIG9wdGlvbnN9LCB7fSk7XG5cbiAgLy8gRWFybHkgeWllbGQgd2hpbGUgd2Ugd2FpdCBmb3IgdGhlIGZpcnN0IGV2YWx1YXRpb24gYW5kIHJlbmRlclxuICBpZiAob3B0aW9ucy5vdXRwdXQgJiYgIShcIjFcIiBpbiBweW9kaWRlT2pzLnJlbmRlcmVkT2pzKSkge1xuICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgY29uc3Qgc3Bpbm5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cbiAgICBpZiAob3B0aW9ucy5lY2hvKSB7XG4gICAgICAvLyBTaG93IG91dHB1dCBhcyBoaWdobGlnaHRlZCBzb3VyY2VcbiAgICAgIGNvbnN0IHByZUVsZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicHJlXCIpO1xuICAgICAgY29udGFpbmVyLmNsYXNzTmFtZSA9IFwic291cmNlQ29kZVwiO1xuICAgICAgcHJlRWxlbS5jbGFzc05hbWUgPSBcInNvdXJjZUNvZGUgcHl0aG9uXCI7XG4gICAgICBwcmVFbGVtLmFwcGVuZENoaWxkKGhpZ2hsaWdodFB5dGhvbihibG9jay5jb2RlKSk7XG4gICAgICBzcGlubmVyLmNsYXNzTmFtZSA9IFwic3Bpbm5lci1ncm93IHNwaW5uZXItZ3Jvdy1zbSBtLTIgcG9zaXRpb24tYWJzb2x1dGUgdG9wLTAgZW5kLTBcIjtcbiAgICAgIHByZUVsZW0uYXBwZW5kQ2hpbGQoc3Bpbm5lcik7XG4gICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQocHJlRWxlbSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNwaW5uZXIuY2xhc3NOYW1lID0gXCJzcGlubmVyLWJvcmRlciBzcGlubmVyLWJvcmRlci1zbVwiO1xuICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHNwaW5uZXIpO1xuICAgIH1cblxuICAgIHlpZWxkIGNvbnRhaW5lcjtcbiAgfVxuXG4gIHB5b2RpZGVPanMucmVuZGVyZWRPanNbXCIxXCJdID0gdHJ1ZTtcbiAgeWllbGQgYXdhaXQgcmVzdWx0O1xufVxuIn0seyJjZWxsTmFtZSI6InB5b2RpZGUtcHJlbHVkZSIsImlubGluZSI6ZmFsc2UsIm1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InB5b2RpZGVPanMgPSB7XG4gIGNvbnN0IHtcbiAgICBQeW9kaWRlRXZhbHVhdG9yLFxuICAgIFB5b2RpZGVFbnZpcm9ubWVudE1hbmFnZXIsXG4gICAgc2V0dXBQeXRob24sXG4gICAgc3RhcnRQeW9kaWRlV29ya2VyLFxuICAgIGI2NERlY29kZSxcbiAgICBjb2xsYXBzZVBhdGgsXG4gIH0gPSB3aW5kb3cuX2V4ZXJjaXNlX29qc19ydW50aW1lO1xuXG4gIGNvbnN0IHN0YXR1c0NvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZXhlcmNpc2UtbG9hZGluZy1zdGF0dXNcIik7XG4gIGNvbnN0IGluZGljYXRvckNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZXhlcmNpc2UtbG9hZGluZy1pbmRpY2F0b3JcIik7XG4gIGluZGljYXRvckNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFwiZC1ub25lXCIpO1xuXG4gIGxldCBzdGF0dXNUZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKVxuICBzdGF0dXNUZXh0LmNsYXNzTGlzdCA9IFwiZXhlcmNpc2UtbG9hZGluZy1kZXRhaWxzXCI7XG4gIHN0YXR1c1RleHQgPSBzdGF0dXNDb250YWluZXIuYXBwZW5kQ2hpbGQoc3RhdHVzVGV4dCk7XG4gIHN0YXR1c1RleHQudGV4dENvbnRlbnQgPSBgSW5pdGlhbGlzZWA7XG5cbiAgLy8gSG9pc3QgaW5kaWNhdG9yIG91dCBmcm9tIGZpbmFsIHNsaWRlIHdoZW4gcnVubmluZyB1bmRlciByZXZlYWxcbiAgY29uc3QgcmV2ZWFsU3RhdHVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5yZXZlYWwgLmV4ZXJjaXNlLWxvYWRpbmctaW5kaWNhdG9yXCIpO1xuICBpZiAocmV2ZWFsU3RhdHVzKSB7XG4gICAgcmV2ZWFsU3RhdHVzLnJlbW92ZSgpO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucmV2ZWFsID4gLnNsaWRlc1wiKS5hcHBlbmRDaGlsZChyZXZlYWxTdGF0dXMpO1xuICB9XG5cbiAgLy8gTWFrZSBhbnkgcmV2ZWFsIHNsaWRlcyB3aXRoIGxpdmUgY2VsbHMgc2Nyb2xsYWJsZVxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnJldmVhbCAuZXhlcmNpc2UtY2VsbFwiKS5mb3JFYWNoKChlbCkgPT4ge1xuICAgIGVsLmNsb3Nlc3QoJ3NlY3Rpb24uc2xpZGUnKS5jbGFzc0xpc3QuYWRkKFwic2Nyb2xsYWJsZVwiKTtcbiAgfSlcblxuICAvLyBQeW9kaWRlIHN1cHBsZW1lbnRhbCBkYXRhIGFuZCBvcHRpb25zXG4gIGNvbnN0IGRhdGFDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihgc2NyaXB0W3R5cGU9XFxcInB5b2RpZGUtZGF0YVxcXCJdYCkudGV4dENvbnRlbnQ7XG4gIGNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKGI2NERlY29kZShkYXRhQ29udGVudCkpO1xuXG4gIC8vIEdyYWIgbGlzdCBvZiByZXNvdXJjZXMgdG8gYmUgZG93bmxvYWRlZFxuICBjb25zdCBmaWxlc0NvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBzY3JpcHRbdHlwZT1cXFwidmZzLWZpbGVcXFwiXWApLnRleHRDb250ZW50O1xuICBjb25zdCBmaWxlcyA9IEpTT04ucGFyc2UoYjY0RGVjb2RlKGZpbGVzQ29udGVudCkpO1xuXG4gIGxldCBweW9kaWRlUHJvbWlzZSA9IChhc3luYyAoKSA9PiB7XG4gICAgc3RhdHVzVGV4dC50ZXh0Q29udGVudCA9IGBEb3dubG9hZGluZyBQeW9kaWRlYDtcbiAgICBjb25zdCBweW9kaWRlID0gYXdhaXQgc3RhcnRQeW9kaWRlV29ya2VyKGRhdGEub3B0aW9ucyk7XG5cbiAgICBzdGF0dXNUZXh0LnRleHRDb250ZW50ID0gYERvd25sb2FkaW5nIHBhY2thZ2U6IG1pY3JvcGlwYDtcbiAgICBhd2FpdCBweW9kaWRlLmxvYWRQYWNrYWdlKFwibWljcm9waXBcIik7XG4gICAgY29uc3QgbWljcm9waXAgPSBhd2FpdCBweW9kaWRlLnB5aW1wb3J0KFwibWljcm9waXBcIik7XG4gICAgYXdhaXQgZGF0YS5wYWNrYWdlcy5wa2dzLm1hcCgocGtnKSA9PiAoKSA9PiB7XG4gICAgICBzdGF0dXNUZXh0LnRleHRDb250ZW50ID0gYERvd25sb2FkaW5nIHBhY2thZ2U6ICR7cGtnfWA7XG4gICAgICByZXR1cm4gbWljcm9waXAuaW5zdGFsbChwa2cpO1xuICAgIH0pLnJlZHVjZSgoY3VyLCBuZXh0KSA9PiBjdXIudGhlbihuZXh0KSwgUHJvbWlzZS5yZXNvbHZlKCkpO1xuICAgIGF3YWl0IG1pY3JvcGlwLmRlc3Ryb3koKTtcblxuICAgIC8vIERvd25sb2FkIGFuZCBpbnN0YWxsIHJlc291cmNlc1xuICAgIGF3YWl0IGZpbGVzLm1hcCgoZmlsZSkgPT4gYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbmFtZSA9IGZpbGUuc3Vic3RyaW5nKGZpbGUubGFzdEluZGV4T2YoJy8nKSArIDEpO1xuICAgICAgc3RhdHVzVGV4dC50ZXh0Q29udGVudCA9IGBEb3dubG9hZGluZyByZXNvdXJjZTogJHtuYW1lfWA7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGZpbGUpO1xuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENhbid0IGRvd25sb2FkIFxcYCR7ZmlsZX1cXGAuIEVycm9yICR7cmVzcG9uc2Uuc3RhdHVzfTogXCIke3Jlc3BvbnNlLnN0YXR1c1RleHR9XCIuYCk7XG4gICAgICB9XG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuYXJyYXlCdWZmZXIoKTtcblxuICAgICAgLy8gU3RvcmUgVVJMcyBpbiB0aGUgY3dkIHdpdGhvdXQgYW55IHN1YmRpcmVjdG9yeSBzdHJ1Y3R1cmVcbiAgICAgIGlmIChmaWxlLmluY2x1ZGVzKFwiOi8vXCIpKSB7XG4gICAgICAgIGZpbGUgPSBuYW1lO1xuICAgICAgfVxuXG4gICAgICAvLyBDb2xsYXBzZSBoaWdoZXIgZGlyZWN0b3J5IHN0cnVjdHVyZVxuICAgICAgZmlsZSA9IGNvbGxhcHNlUGF0aChmaWxlKTtcblxuICAgICAgLy8gQ3JlYXRlIGRpcmVjdG9yeSB0cmVlLCBpZ25vcmluZyBcImRpcmVjdG9yeSBleGlzdHNcIiBWRlMgZXJyb3JzXG4gICAgICBjb25zdCBwYXJ0cyA9IGZpbGUuc3BsaXQoJy8nKS5zbGljZSgwLCAtMSk7XG4gICAgICBsZXQgcGF0aCA9ICcnO1xuICAgICAgd2hpbGUgKHBhcnRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcGF0aCArPSBwYXJ0cy5zaGlmdCgpICsgJy8nO1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGF3YWl0IHB5b2RpZGUuRlMubWtkaXIocGF0aCk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBpZiAoZS5uYW1lICE9PSBcIkVycm5vRXJyb3JcIikgdGhyb3cgZTtcbiAgICAgICAgICBpZiAoZS5lcnJubyAhPT0gMjApIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yVGV4dFB0ciA9IGF3YWl0IHB5b2RpZGUuX21vZHVsZS5fc3RyZXJyb3IoZS5lcnJubyk7XG4gICAgICAgICAgICBjb25zdCBlcnJvclRleHQgPSBhd2FpdCBweW9kaWRlLl9tb2R1bGUuVVRGOFRvU3RyaW5nKGVycm9yVGV4dFB0cik7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZpbGVzeXN0ZW0gRXJyb3IgJHtlLmVycm5vfSBcIiR7ZXJyb3JUZXh0fVwiLmApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBXcml0ZSB0aGlzIGZpbGUgdG8gdGhlIFZGU1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IHB5b2RpZGUuRlMud3JpdGVGaWxlKGZpbGUsIG5ldyBVaW50OEFycmF5KGRhdGEpKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgaWYgKGUubmFtZSAhPT0gXCJFcnJub0Vycm9yXCIpIHRocm93IGU7XG4gICAgICAgIGNvbnN0IGVycm9yVGV4dFB0ciA9IGF3YWl0IHB5b2RpZGUuX21vZHVsZS5fc3RyZXJyb3IoZS5lcnJubyk7XG4gICAgICAgIGNvbnN0IGVycm9yVGV4dCA9IGF3YWl0IHB5b2RpZGUuX21vZHVsZS5VVEY4VG9TdHJpbmcoZXJyb3JUZXh0UHRyKTtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGaWxlc3lzdGVtIEVycm9yICR7ZS5lcnJub30gXCIke2Vycm9yVGV4dH1cIi5gKTtcbiAgICAgIH1cbiAgICB9KS5yZWR1Y2UoKGN1ciwgbmV4dCkgPT4gY3VyLnRoZW4obmV4dCksIFByb21pc2UucmVzb2x2ZSgpKTtcblxuICAgIHN0YXR1c1RleHQudGV4dENvbnRlbnQgPSBgUHlvZGlkZSBlbnZpcm9ubWVudCBzZXR1cGA7XG4gICAgYXdhaXQgc2V0dXBQeXRob24ocHlvZGlkZSk7XG5cbiAgICBzdGF0dXNUZXh0LnJlbW92ZSgpO1xuICAgIGlmIChzdGF0dXNDb250YWluZXIuY2hpbGRyZW4ubGVuZ3RoID09IDApIHtcbiAgICAgIHN0YXR1c0NvbnRhaW5lci5wYXJlbnROb2RlLnJlbW92ZSgpO1xuICAgIH1cbiAgICByZXR1cm4gcHlvZGlkZTtcbiAgfSkoKS5jYXRjaCgoZXJyKSA9PiB7XG4gICAgc3RhdHVzVGV4dC5zdHlsZS5jb2xvciA9IFwidmFyKC0tZXhlcmNpc2UtZWRpdG9yLWhsLWVyLCAjQUQwMDAwKVwiO1xuICAgIHN0YXR1c1RleHQudGV4dENvbnRlbnQgPSBlcnIubWVzc2FnZTtcbiAgICAvL2luZGljYXRvckNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLnNwaW5uZXItZ3Jvd1wiKS5jbGFzc0xpc3QuYWRkKFwiZC1ub25lXCIpO1xuICAgIHRocm93IGVycjtcbiAgfSk7XG5cbiAgLy8gS2VlcCB0cmFjayBvZiBpbml0aWFsIE9KUyBibG9jayByZW5kZXJcbiAgY29uc3QgcmVuZGVyZWRPanMgPSB7fTtcblxuICBjb25zdCBwcm9jZXNzID0gYXN5bmMgKGNvbnRleHQsIGlucHV0cykgPT4ge1xuICAgIGNvbnN0IHB5b2RpZGUgPSBhd2FpdCBweW9kaWRlUHJvbWlzZTtcbiAgICBjb25zdCBldmFsdWF0b3IgPSBuZXcgUHlvZGlkZUV2YWx1YXRvcihweW9kaWRlLCBjb250ZXh0KTtcbiAgICBhd2FpdCBldmFsdWF0b3IucHJvY2VzcyhpbnB1dHMpO1xuICAgIHJldHVybiBldmFsdWF0b3IuY29udGFpbmVyO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBweW9kaWRlUHJvbWlzZSxcbiAgICByZW5kZXJlZE9qcyxcbiAgICBwcm9jZXNzLFxuICB9O1xufVxuIn1dfQ==
</script>
<div id="exercise-loading-indicator" class="exercise-loading-indicator d-none d-flex align-items-center gap-2">
<div id="exercise-loading-status" class="d-flex gap-2">

</div>
<div class="spinner-grow spinner-grow-sm">

</div>
</div>
<script type="vfs-file">
WyJzcmMvcGxvdHRpbmcucHkiLCJzcmMvaGFyZHNwaGVyZXMucHkiXQ==
</script>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-hamaker1937london" class="csl-entry" role="listitem">
Hamaker, Hugo C. 1937. <span>“The London—van Der Waals Attraction Between Spherical Particles.”</span> <em>Physica</em> 4 (10): 1058–72. <a href="https://www.sciencedirect.com/science/article/pii/S0031891437802037">https://www.sciencedirect.com/science/article/pii/S0031891437802037</a>.
</div>
<div id="ref-lekkerkerker2024colloids" class="csl-entry" role="listitem">
Lekkerkerker, Henk NW, Remco Tuinier, and Mark Vis. 2024. <em>Colloids and the Depletion Interaction</em>. Springer Nature. <a href="https://bris.on.worldcat.org/oclc/1428319704">https://bris.on.worldcat.org/oclc/1428319704</a>.
</div>
<div id="ref-london1937general" class="csl-entry" role="listitem">
London, Fritz. 1937. <span>“The General Theory of Molecular Forces.”</span> <em>Transactions of the Faraday Society</em> 33: 8b–26.
</div>
<div id="ref-pusey2009hard" class="csl-entry" role="listitem">
Pusey, PN, E Zaccarelli, C Valeriani, E Sanz, Wilson CK Poon, and Michael E Cates. 2009. <span>“Hard Spheres: Crystallization and Glass Formation.”</span> <em>Philosophical Transactions of the Royal Society A: Mathematical, Physical and Engineering Sciences</em> 367 (1909): 4993–5011. <a href="https://bris.on.worldcat.org/oclc/8582157462">https://bris.on.worldcat.org/oclc/8582157462</a>.
</div>
<div id="ref-royall2024colloidal" class="csl-entry" role="listitem">
Royall, C Patrick, Patrick Charbonneau, Marjolein Dijkstra, John Russo, Frank Smallenburg, Thomas Speck, and Chantal Valeriani. 2024. <span>“Colloidal Hard Spheres: Triumphs, Challenges, and Mysteries.”</span> <em>Reviews of Modern Physics</em> 96 (4): 045003. <a href="https://journals.aps.org/rmp/abstract/10.1103/RevModPhys.96.045003">https://journals.aps.org/rmp/abstract/10.1103/RevModPhys.96.045003</a>.
</div>
<div id="ref-santos2016concise" class="csl-entry" role="listitem">
Santos, Andrés. 2016. <span>“A Concise Course on the Theory of Classical Liquids.”</span> <em>Lecture Notes in Physics</em> 923: 064601–4. <a href="https://bris.on.worldcat.org/oclc/949904359">https://bris.on.worldcat.org/oclc/949904359</a>.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>This is clearly an instance of the idea of <strong>coarse graining</strong> that we have introduced <a href="../soft-matter/soft-matter_intro.html">earlier</a>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>As you see, scaling by <span class="math inline">\(k_B T\)</span> is a recurrent feature of soft matter.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>From the Greek στερεός, “solid, three-dimensional”.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IntcbiAgY29uc3Qgd2lkdGggPSA2MDA7XG5jb25zdCBoZWlnaHQgPSA0MDA7XG5jb25zdCBudW1DaXJjbGVzID0gMzAwO1xuXG5sZXQgdGVtcGVyYXR1cmUgPSAzMDA7ICAgIC8vIEFyYml0cmFyeSBzY2FsZVxubGV0IHZpc2Nvc2l0eSA9IDAuMDI7ICAgICAvLyBBcmJpdHJhcnkgc2NhbGVcbmNvbnN0IHBhcnRpY2xlUmFkaXVzID0gNTsgLy8gcGl4ZWxzXG5sZXQgdGltZVN0ZXAgPSAxO1xuXG5jb25zdCBrQiA9IDE7IC8vIHJlZHVjZWQgdW5pdHNcbmxldCBncmF2aXR5RmFjdG9yID0gMC4xO1xubGV0IGdyYXZpdHkgPSAxMCAqIGdyYXZpdHlGYWN0b3I7XG5cbi8vIENvbXB1dGUgZGFtcGluZyBhcyB2ZWxvY2l0eSBkZWNheSBwZXIgdGltZXN0ZXAgKExhbmdldmluIGZyaWN0aW9uKVxuZnVuY3Rpb24gY29tcHV0ZURhbXBpbmcodmlzY29zaXR5LCByYWRpdXMsIGR0KSB7XG4gIGNvbnN0IGdhbW1hID0gNiAqIE1hdGguUEkgKiB2aXNjb3NpdHkgKiByYWRpdXM7IC8vIGZyaWN0aW9uIGNvZWZmXG4gIHJldHVybiBNYXRoLmV4cCgtZ2FtbWEgKiBkdCk7XG59XG5cbmxldCBkYW1waW5nID0gY29tcHV0ZURhbXBpbmcodmlzY29zaXR5LCBwYXJ0aWNsZVJhZGl1cywgdGltZVN0ZXApO1xuXG4vLyBDcmVhdGUgU1ZHXG5jb25zdCBzdmcgPSBkMy5jcmVhdGUoXCJzdmdcIilcbiAgLmF0dHIoXCJ3aWR0aFwiLCB3aWR0aClcbiAgLmF0dHIoXCJoZWlnaHRcIiwgaGVpZ2h0KVxuICAuc3R5bGUoXCJib3JkZXJcIiwgXCIxcHggc29saWQgI2NjY1wiKVxuICAuc3R5bGUoXCJiYWNrZ3JvdW5kXCIsIFwiI2Y5ZjlmOVwiKTtcblxuLy8gSW5pdGlhbGl6ZSBjaXJjbGVzXG5jb25zdCBjaXJjbGVzID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogbnVtQ2lyY2xlcyB9LCAoXywgaSkgPT4gKHtcbiAgaWQ6IGksXG4gIHg6IE1hdGgucmFuZG9tKCkgKiB3aWR0aCxcbiAgeTogTWF0aC5yYW5kb20oKSAqIGhlaWdodCAqIDAuMyxcbiAgdng6IChNYXRoLnJhbmRvbSgpIC0gMC41KSAqIDIsXG4gIHZ5OiAoTWF0aC5yYW5kb20oKSAtIDAuNSkgKiAyLFxuICByYWRpdXM6IHBhcnRpY2xlUmFkaXVzLFxuICBjb2xvcjogZDMuaW50ZXJwb2xhdGVZbE9yQnIoTWF0aC5yYW5kb20oKSAqIDAuNSArIDAuMjUpXG59KSk7XG5cbi8vIENyZWF0ZSBjaXJjbGVzIGluIFNWR1xuY29uc3QgY2lyY2xlRWxlbWVudHMgPSBzdmcuc2VsZWN0QWxsKFwiY2lyY2xlXCIpXG4gIC5kYXRhKGNpcmNsZXMpXG4gIC5lbnRlcigpXG4gIC5hcHBlbmQoXCJjaXJjbGVcIilcbiAgLmF0dHIoXCJyXCIsIGQgPT4gZC5yYWRpdXMpXG4gIC5hdHRyKFwiZmlsbFwiLCBkID0+IGQuY29sb3IpXG4gIC5hdHRyKFwib3BhY2l0eVwiLCAwLjgpXG4gIC5hdHRyKFwic3Ryb2tlXCIsIFwiIzMzM1wiKVxuICAuYXR0cihcInN0cm9rZS13aWR0aFwiLCAxKTtcblxuLy8gQ29sbGlzaW9uIGRldGVjdGlvbiAmIHJlc3BvbnNlXG5mdW5jdGlvbiBoYW5kbGVDb2xsaXNpb25zKCkge1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGNpcmNsZXMubGVuZ3RoOyBpKyspIHtcbiAgICBmb3IgKGxldCBqID0gaSArIDE7IGogPCBjaXJjbGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICBjb25zdCBjMSA9IGNpcmNsZXNbaV07XG4gICAgICBjb25zdCBjMiA9IGNpcmNsZXNbal07XG4gICAgICBjb25zdCBkeCA9IGMyLnggLSBjMS54O1xuICAgICAgY29uc3QgZHkgPSBjMi55IC0gYzEueTtcbiAgICAgIGNvbnN0IGRpc3QgPSBNYXRoLmh5cG90KGR4LCBkeSk7XG4gICAgICBjb25zdCBtaW5EaXN0ID0gYzEucmFkaXVzICsgYzIucmFkaXVzO1xuXG4gICAgICBpZiAoZGlzdCA8IG1pbkRpc3QgJiYgZGlzdCA+IDApIHtcbiAgICAgICAgY29uc3Qgb3ZlcmxhcCA9IG1pbkRpc3QgLSBkaXN0O1xuICAgICAgICBjb25zdCBueCA9IGR4IC8gZGlzdDtcbiAgICAgICAgY29uc3QgbnkgPSBkeSAvIGRpc3Q7XG5cbiAgICAgICAgYzEueCAtPSBueCAqIG92ZXJsYXAgLyAyO1xuICAgICAgICBjMS55IC09IG55ICogb3ZlcmxhcCAvIDI7XG4gICAgICAgIGMyLnggKz0gbnggKiBvdmVybGFwIC8gMjtcbiAgICAgICAgYzIueSArPSBueSAqIG92ZXJsYXAgLyAyO1xuXG4gICAgICAgIGNvbnN0IGR2eCA9IGMyLnZ4IC0gYzEudng7XG4gICAgICAgIGNvbnN0IGR2eSA9IGMyLnZ5IC0gYzEudnk7XG4gICAgICAgIGNvbnN0IHZuID0gZHZ4ICogbnggKyBkdnkgKiBueTtcblxuICAgICAgICBpZiAodm4gPiAwKSBjb250aW51ZTtcblxuICAgICAgICBjb25zdCByZXN0aXR1dGlvbiA9IDEuMDtcbiAgICAgICAgY29uc3QgaW1wdWxzZSA9ICgtKDEgKyByZXN0aXR1dGlvbikgKiB2bikgLyAyO1xuXG4gICAgICAgIGMxLnZ4IC09IGltcHVsc2UgKiBueDtcbiAgICAgICAgYzEudnkgLT0gaW1wdWxzZSAqIG55O1xuICAgICAgICBjMi52eCArPSBpbXB1bHNlICogbng7XG4gICAgICAgIGMyLnZ5ICs9IGltcHVsc2UgKiBueTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuLy8gVXBkYXRlIGRhbXBpbmcgd2hlbiB2aXNjb3NpdHkgb3IgdGltZXN0ZXAgY2hhbmdlc1xuZnVuY3Rpb24gdXBkYXRlRGFtcGluZygpIHtcbiAgZGFtcGluZyA9IGNvbXB1dGVEYW1waW5nKHZpc2Nvc2l0eSwgcGFydGljbGVSYWRpdXMsIHRpbWVTdGVwKTtcbn1cblxuLy8gQW5pbWF0ZSBmdW5jdGlvblxuZnVuY3Rpb24gYW5pbWF0ZSgpIHtcbiAgY29uc3QgZGlmZnVzaW9uID0gKGtCICogdGVtcGVyYXR1cmUpIC8gKDYgKiBNYXRoLlBJICogdmlzY29zaXR5ICogcGFydGljbGVSYWRpdXMpO1xuXG4gIGNpcmNsZXMuZm9yRWFjaChjID0+IHtcbiAgICAvLyBBcHBseSBncmF2aXR5XG4gICAgYy52eSArPSBncmF2aXR5ICogdGltZVN0ZXA7XG5cbiAgICAvLyBEaWZmdXNpb24gcmFuZG9tIGtpY2sgc2NhbGVkIGJ5IHNxcnQoMipEL2R0KVxuICAgIGNvbnN0IGRpZmZ1c2lvbkZvcmNlID0gTWF0aC5zcXJ0KDIgKiBkaWZmdXNpb24gLyB0aW1lU3RlcCk7XG4gICAgYy52eCArPSAoTWF0aC5yYW5kb20oKSAtIDAuNSkgKiBkaWZmdXNpb25Gb3JjZTtcbiAgICBjLnZ5ICs9IChNYXRoLnJhbmRvbSgpIC0gMC41KSAqIGRpZmZ1c2lvbkZvcmNlO1xuXG4gICAgLy8gQXBwbHkgZGFtcGluZ1xuICAgIGMudnggKj0gZGFtcGluZztcbiAgICBjLnZ5ICo9IGRhbXBpbmc7XG5cbiAgICAvLyBVcGRhdGUgcG9zaXRpb25cbiAgICBjLnggKz0gYy52eCAqIHRpbWVTdGVwO1xuICAgIGMueSArPSBjLnZ5ICogdGltZVN0ZXA7XG5cbiAgICAvLyBCb3VuZGFyeSBjb2xsaXNpb25cbiAgICBpZiAoYy54IC0gYy5yYWRpdXMgPCAwKSB7XG4gICAgICBjLnggPSBjLnJhZGl1cztcbiAgICAgIGMudnggKj0gLTE7XG4gICAgfVxuICAgIGlmIChjLnggKyBjLnJhZGl1cyA+IHdpZHRoKSB7XG4gICAgICBjLnggPSB3aWR0aCAtIGMucmFkaXVzO1xuICAgICAgYy52eCAqPSAtMTtcbiAgICB9XG4gICAgaWYgKGMueSAtIGMucmFkaXVzIDwgMCkge1xuICAgICAgYy55ID0gYy5yYWRpdXM7XG4gICAgICBjLnZ5ICo9IC0xO1xuICAgIH1cbiAgICBpZiAoYy55ICsgYy5yYWRpdXMgPiBoZWlnaHQpIHtcbiAgICAgIGMueSA9IGhlaWdodCAtIGMucmFkaXVzO1xuICAgICAgYy52eSAqPSAtMTtcbiAgICB9XG4gIH0pO1xuXG4gIGhhbmRsZUNvbGxpc2lvbnMoKTtcblxuICBjaXJjbGVFbGVtZW50c1xuICAgIC5hdHRyKFwiY3hcIiwgZCA9PiBkLngpXG4gICAgLmF0dHIoXCJjeVwiLCBkID0+IGQueSk7XG5cbiAgZGlmZnVzaW9uRGlzcGxheS50ZXh0KGBEaWZmdXNpb246ICR7ZGlmZnVzaW9uLnRvRml4ZWQoNCl9YCk7XG59XG5cbi8vIFN0YXJ0IHRpbWVyXG5jb25zdCB0aW1lciA9IGQzLnRpbWVyKGFuaW1hdGUpO1xuXG4vLyBDb250cm9scyBjb250YWluZXJcbmNvbnN0IGNvbnRyb2xzID0gZDMuY3JlYXRlKFwiZGl2XCIpXG4gIC5zdHlsZShcIm1hcmdpbi10b3BcIiwgXCIxMHB4XCIpXG4gIC5zdHlsZShcInBhZGRpbmdcIiwgXCIxMHB4XCIpXG4gIC5zdHlsZShcImJhY2tncm91bmRcIiwgXCIjZjBmMGYwXCIpXG4gIC5zdHlsZShcImJvcmRlci1yYWRpdXNcIiwgXCI4cHhcIilcbiAgLnN0eWxlKFwid2lkdGhcIiwgYCR7d2lkdGh9cHhgKTtcblxuLy8gU2xpZGVyIGZhY3RvcnlcbmZ1bmN0aW9uIGNyZWF0ZVNsaWRlcihsYWJlbFRleHQsIG1pbiwgbWF4LCBpbml0aWFsLCBzdGVwLCBvbkNoYW5nZSkge1xuICBjb25zdCBjb250YWluZXIgPSBjb250cm9scy5hcHBlbmQoXCJkaXZcIilcbiAgICAuc3R5bGUoXCJtYXJnaW4tYm90dG9tXCIsIFwiMTBweFwiKVxuICAgIC5zdHlsZShcImRpc3BsYXlcIiwgXCJmbGV4XCIpXG4gICAgLnN0eWxlKFwiYWxpZ24taXRlbXNcIiwgXCJjZW50ZXJcIilcbiAgICAuc3R5bGUoXCJnYXBcIiwgXCIxMHB4XCIpO1xuXG4gIGNvbnRhaW5lci5hcHBlbmQoXCJsYWJlbFwiKVxuICAgIC50ZXh0KGxhYmVsVGV4dClcbiAgICAuc3R5bGUoXCJtaW4td2lkdGhcIiwgXCIxMjBweFwiKVxuICAgIC5zdHlsZShcImZvbnQtd2VpZ2h0XCIsIFwiYm9sZFwiKTtcblxuICBjb25zdCBzbGlkZXIgPSBjb250YWluZXIuYXBwZW5kKFwiaW5wdXRcIilcbiAgICAuYXR0cihcInR5cGVcIiwgXCJyYW5nZVwiKVxuICAgIC5hdHRyKFwibWluXCIsIG1pbilcbiAgICAuYXR0cihcIm1heFwiLCBtYXgpXG4gICAgLmF0dHIoXCJzdGVwXCIsIHN0ZXApXG4gICAgLmF0dHIoXCJ2YWx1ZVwiLCBpbml0aWFsKVxuICAgIC5zdHlsZShcImZsZXhcIiwgXCIxXCIpO1xuXG4gIGNvbnN0IHZhbHVlRGlzcGxheSA9IGNvbnRhaW5lci5hcHBlbmQoXCJzcGFuXCIpXG4gICAgLnRleHQoaW5pdGlhbC50b0ZpeGVkKHN0ZXAgPCAxID8gNCA6IDApKVxuICAgIC5zdHlsZShcIndpZHRoXCIsIFwiNTBweFwiKVxuICAgIC5zdHlsZShcInRleHQtYWxpZ25cIiwgXCJyaWdodFwiKVxuICAgIC5zdHlsZShcImZvbnQtZmFtaWx5XCIsIFwibW9ub3NwYWNlXCIpO1xuXG4gIHNsaWRlci5vbihcImlucHV0XCIsIGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCB2YWwgPSArdGhpcy52YWx1ZTtcbiAgICBvbkNoYW5nZSh2YWwpO1xuICAgIHZhbHVlRGlzcGxheS50ZXh0KHZhbC50b0ZpeGVkKHN0ZXAgPCAxID8gNCA6IDApKTtcbiAgfSk7XG5cbiAgcmV0dXJuIHNsaWRlcjtcbn1cblxuLy8gQ3JlYXRlIHNsaWRlcnNcbmNyZWF0ZVNsaWRlcihcIkdyYXZpdHlcIiwgLTEwMCwgMTAwLCBncmF2aXR5IC8gZ3Jhdml0eUZhY3RvciwgMTAsIHYgPT4gZ3Jhdml0eSA9IHYgKiBncmF2aXR5RmFjdG9yKTtcblxuY3JlYXRlU2xpZGVyKFwiVGVtcGVyYXR1cmVcIiwgMCwgMTAwMCwgdGVtcGVyYXR1cmUsIDEwLCB2ID0+IHRlbXBlcmF0dXJlID0gdik7XG5cbmNyZWF0ZVNsaWRlcihcIlZpc2Nvc2l0eVwiLCAwLjAwMSwgMC4xLCB2aXNjb3NpdHksIDAuMDAxLCB2ID0+IHtcbiAgdmlzY29zaXR5ID0gdjtcbiAgdXBkYXRlRGFtcGluZygpO1xufSk7XG5cbi8vIGNyZWF0ZVNsaWRlcihcIlRpbWUgU3RlcFwiLCAwLjEsIDUsIHRpbWVTdGVwLCAwLjEsIHYgPT4ge1xuLy8gICB0aW1lU3RlcCA9IHY7XG4vLyAgIHVwZGF0ZURhbXBpbmcoKTtcbi8vIH0pO1xuXG4vLyBEaWZmdXNpb24gZGlzcGxheVxuY29uc3QgZGlmZnVzaW9uRGlzcGxheSA9IGNvbnRyb2xzLmFwcGVuZChcImRpdlwiKVxuICAuc3R5bGUoXCJtYXJnaW4tdG9wXCIsIFwiMTBweFwiKVxuICAuc3R5bGUoXCJmb250LWZhbWlseVwiLCBcIm1vbm9zcGFjZVwiKVxuICAuc3R5bGUoXCJmb250LXdlaWdodFwiLCBcImJvbGRcIilcbiAgLnRleHQoXCJcIik7XG5cbi8vIFJlc2V0IGJ1dHRvblxuY29udHJvbHMuYXBwZW5kKFwiYnV0dG9uXCIpXG4gIC50ZXh0KFwiUmVzZXQgUG9zaXRpb25zXCIpXG4gIC5zdHlsZShcIm1hcmdpbi10b3BcIiwgXCIxMHB4XCIpXG4gIC5zdHlsZShcInBhZGRpbmdcIiwgXCI2cHggMTJweFwiKVxuICAub24oXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgY2lyY2xlcy5mb3JFYWNoKGMgPT4ge1xuICAgICAgYy54ID0gTWF0aC5yYW5kb20oKSAqIHdpZHRoO1xuICAgICAgYy55ID0gTWF0aC5yYW5kb20oKSAqIGhlaWdodCAqIDAuMztcbiAgICAgIGMudnggPSAoTWF0aC5yYW5kb20oKSAtIDAuNSkgKiAyO1xuICAgICAgYy52eSA9IChNYXRoLnJhbmRvbSgpIC0gMC41KSAqIDI7XG4gICAgfSk7XG4gIH0pO1xuXG4vLyBTdGFydC9TdG9wIHRvZ2dsZVxuY29uc3Qgc3RhcnRTdG9wQnRuID0gY29udHJvbHMuYXBwZW5kKFwiYnV0dG9uXCIpXG4gIC50ZXh0KFwiU3RvcFwiKVxuICAuc3R5bGUoXCJtYXJnaW4tbGVmdFwiLCBcIjEwcHhcIilcbiAgLnN0eWxlKFwicGFkZGluZ1wiLCBcIjZweCAxMnB4XCIpXG4gIC5vbihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodGltZXIuX2NhbGwpIHtcbiAgICAgIHRpbWVyLnN0b3AoKTtcbiAgICAgIHRoaXMudGV4dENvbnRlbnQgPSBcIlN0YXJ0XCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRpbWVyLnJlc3RhcnQoYW5pbWF0ZSk7XG4gICAgICB0aGlzLnRleHRDb250ZW50ID0gXCJTdG9wXCI7XG4gICAgfVxuICB9KTtcblxuLy8gQ29udGFpbmVyIGRpdlxuY29uc3QgY29udGFpbmVyID0gZDMuY3JlYXRlKFwiZGl2XCIpO1xuY29udGFpbmVyLm5vZGUoKS5hcHBlbmRDaGlsZChzdmcubm9kZSgpKTtcbmNvbnRhaW5lci5ub2RlKCkuYXBwZW5kQ2hpbGQoY29udHJvbHMubm9kZSgpKTtcblxucmV0dXJuIGNvbnRhaW5lci5ub2RlKCk7XG59XG4ifV19
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../soft-matter";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="../soft-matter/soft-matter_intro.html" class="pagination-link" aria-label="Entropy matters">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Entropy matters</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../soft-matter/soft-matter_polymers.html" class="pagination-link" aria-label="Polymers">
        <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Polymers</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<script>videojs(video_shortcode_videojs_video1);</script>




</body></html>