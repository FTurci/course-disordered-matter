<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Unifying concepts: Problems</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../phase-transitions/precourse-reading.html" rel="next">
<link href="../phase-transitions/dynamics-of-fluctuations.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-f9e9f27e2f64dd25e94c2742b294698a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/live-runtime/live-runtime.js" type="module"></script>
<link href="../site_libs/quarto-contrib/live-runtime/live-runtime.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="module" src="../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../phase-transitions/introduction.html">Unifying concepts</a></li><li class="breadcrumb-item"><a href="../phase-transitions/problems.html">Precourse reading and revision</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../courselogo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reading.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Recommended texts</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Unifying concepts</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to phase behaviour</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/background.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Background concepts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/approach-to-criticality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The approach to criticality</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/Ising-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">The Ising model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/mean-field-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Mean field theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/scaling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">The static scaling hypothesis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/rg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Universality and renormalization group theory</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/nucleation-and-growth.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Nucleation, growth and spinoidal decomposition</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/master-equation-and-diffusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introduction to stochastic processes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/Brownian-and-Langevin-dynamics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Brownian and Langevin dynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/dynamics-of-fluctuations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Dynamics of fluctuations (non-examinable)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/problems.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Precourse reading and revision</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/precourse-reading.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Problems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/Solutions_to_problems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solutions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/live-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Coding</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Complex disordered systems</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../soft-matter/soft-matter_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Entropy matters</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../soft-matter/soft-matter_colloids.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Colloids</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../soft-matter/soft-matter_polymers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Polymers</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../soft-matter/soft-matter_liquidcrystals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Liquid crystals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../soft-matter/soft-matter_surfactants.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Surfactants</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../soft-matter/soft-matter_glasses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Arrested states</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../soft-matter/soft-matter_active.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Active matter</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../soft-matter/soft-matter_problems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Problems</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Experimental techniques</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../revision_guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Revision guide</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../phase-transitions/concepts_map.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Concept maps</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#existence-of-a-phase-transition-in-d2." id="toc-existence-of-a-phase-transition-in-d2." class="nav-link active" data-scroll-target="#existence-of-a-phase-transition-in-d2.">1. Existence of a phase transition in <span class="math inline">\(d=2\)</span>.</a></li>
  <li><a href="#correlation-length" id="toc-correlation-length" class="nav-link" data-scroll-target="#correlation-length">2. Correlation Length</a></li>
  <li><a href="#a-model-fluid" id="toc-a-model-fluid" class="nav-link" data-scroll-target="#a-model-fluid">3. A model fluid</a></li>
  <li><a href="#mean-field-theory-of-the-ising-model-heat-capacity" id="toc-mean-field-theory-of-the-ising-model-heat-capacity" class="nav-link" data-scroll-target="#mean-field-theory-of-the-ising-model-heat-capacity">4. Mean field theory of the Ising model heat capacity</a></li>
  <li><a href="#magnetisation-and-fluctuations" id="toc-magnetisation-and-fluctuations" class="nav-link" data-scroll-target="#magnetisation-and-fluctuations">5. Magnetisation and fluctuations</a></li>
  <li><a href="#spin-1-ising-model" id="toc-spin-1-ising-model" class="nav-link" data-scroll-target="#spin-1-ising-model">6. Spin-1 Ising model</a></li>
  <li><a href="#transfer-matrix." id="toc-transfer-matrix." class="nav-link" data-scroll-target="#transfer-matrix.">7. Transfer Matrix.</a></li>
  <li><a href="#landau-theory" id="toc-landau-theory" class="nav-link" data-scroll-target="#landau-theory">8. Landau theory</a></li>
  <li><a href="#scaling-equation-of-state" id="toc-scaling-equation-of-state" class="nav-link" data-scroll-target="#scaling-equation-of-state">9. Scaling equation of state</a></li>
  <li><a href="#scaling-laws" id="toc-scaling-laws" class="nav-link" data-scroll-target="#scaling-laws">10. Scaling laws</a></li>
  <li><a href="#classical-nucleation-theory" id="toc-classical-nucleation-theory" class="nav-link" data-scroll-target="#classical-nucleation-theory">11. Classical nucleation theory</a></li>
  <li><a href="#colloidal-diffusion" id="toc-colloidal-diffusion" class="nav-link" data-scroll-target="#colloidal-diffusion">12. Colloidal diffusion</a></li>
  <li><a href="#einsteins-expression-for-the-diffusion-coefficient" id="toc-einsteins-expression-for-the-diffusion-coefficient" class="nav-link" data-scroll-target="#einsteins-expression-for-the-diffusion-coefficient">13. Einstein’s expression for the diffusion coefficient</a></li>
  <li><a href="#life-in-one-dimension" id="toc-life-in-one-dimension" class="nav-link" data-scroll-target="#life-in-one-dimension">14. Life in one dimension</a></li>
  <li><a href="#master-equation" id="toc-master-equation" class="nav-link" data-scroll-target="#master-equation">15. Master equation</a></li>
  <li><a href="#detailed-balance" id="toc-detailed-balance" class="nav-link" data-scroll-target="#detailed-balance">16. Detailed balance</a></li>
  <li><a href="#jump-processes" id="toc-jump-processes" class="nav-link" data-scroll-target="#jump-processes">17. Jump processes</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../phase-transitions/introduction.html">Unifying concepts</a></li><li class="breadcrumb-item"><a href="../phase-transitions/problems.html">Precourse reading and revision</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="problems" class="quarto-section-identifier">Unifying concepts: Problems</span></h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<p>Although you should try all of these questions, some of them are deliberately quite challenging. If you don’t get very far with some, don’t worry. We’ll be going over them in problems classes, so you can just regard them as worked examples.</p>
<section id="existence-of-a-phase-transition-in-d2." class="level3">
<h3 class="anchored" data-anchor-id="existence-of-a-phase-transition-in-d2.">1. Existence of a phase transition in <span class="math inline">\(d=2\)</span>.</h3>
<p>In lectures it was argued that no long ranged order occurs at finite-temperatures in a one dimensional system because of the presence of domain walls. Were macroscopic domain walls to exist in two dimensions at finite temperature, they would similarly destroy long ranged order and prevent a phase transition. By calculating the free energy of a 2D domain wall for an Ising lattice, show that domain walls do not in fact exist for sufficiently low <span class="math inline">\(T\)</span>.</p>
<p>(Hint: Model the domain wall as a non-reversing <span class="math inline">\(N\)</span>-step random walk on the lattice and find an expression for its energy and -from the number of random walk configurations- its entropy.)</p>
<hr>
</section>
<section id="correlation-length" class="level3">
<h3 class="anchored" data-anchor-id="correlation-length">2. Correlation Length</h3>
<p>For a 1D Ising model, show that the correlation between the spins at sites <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>, is</p>
<p><span class="math display">\[\langle s_i s_j\rangle =\sum_m p_m(-1)^m\]</span> where <span class="math inline">\(m\)</span> is the number of domain walls between <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> and <span class="math inline">\(p_m\)</span> is the probability of finding <span class="math inline">\(m\)</span> domain walls between them.</p>
<p>Hence show that when <span class="math inline">\(R_{ij}=|i-j|a\)</span> is large (with <span class="math inline">\(a\)</span> the lattice spacing) and the temperature is small, that</p>
<p><span class="math display">\[\langle s_i s_j\rangle =\exp(-R_{ij}/\xi)\]</span> with <span class="math inline">\(\xi=a/2p\)</span> and <span class="math inline">\(p\)</span> the probability of finding a domain wall on a bond.</p>
<p><em>Hint: In the second part note that <span class="math inline">\(p_m\)</span> is given by a binomial distribution because there is a probability <span class="math inline">\(p\)</span> of each bond containing a domain wall and <span class="math inline">\((1-p)\)</span> that it doesn’t. What special type of distribution does <span class="math inline">\(p_m\)</span> tend to when <span class="math inline">\(p\)</span> is small (as occurs at low <span class="math inline">\(T\)</span>)?</em></p>
<hr>
</section>
<section id="a-model-fluid" class="level3">
<h3 class="anchored" data-anchor-id="a-model-fluid">3. A model fluid</h3>
<p>The van der Waals (vdW) equation of state is essentially a mean field theory for fluids. It relates the pressure and the volume of a fluid to the temperature:</p>
<p><span class="math display">\[\left(P+\frac{a}{V^2}\right)(V-b)=N_Ak_BT\]</span> where <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are constants and <span class="math inline">\(N_A\)</span> is Avogadro’s number.</p>
<p>The critical point of a fluid corresponds to the point at which the isothermal compressibility diverges, that is</p>
<p><span class="math display">\[\left(\frac{\partial P}{\partial V}\right)_T=0\]</span> Additionally, one finds that isotherms of <span class="math inline">\(P\)</span> versus <span class="math inline">\(V\)</span> exhibit a point of inflection at the critical point, that is</p>
<p><span class="math display">\[\left(\frac{\partial^2 P}{\partial V^2}\right)_T=0\]</span></p>
<ul>
<li><p>Use these two requirements to show that the critical point of the vdW fluid is located at</p>
<p><span class="math display">\[V_c=3b, ~~~ P_c=\frac{a}{27b^2},~~~ N_AK_BT_c=\frac{8a}{27b}\]</span></p></li>
<li><p>Hence show that when written in terms of reduced variables</p>
<p><span class="math display">\[p=\frac{P}{P_c}, ~~~~ v=\frac{V}{V_c} ~~~~ t=\frac{T}{T_c}\]</span></p>
<p>the equation takes the form</p>
<p><span class="math display">\[\left(p+\frac{3}{v^2}\right)(v-\frac{1}{3})=\frac{8t}{3}\]</span></p></li>
<li><p>Use a graph-plotting program to plot a selection of isotherms close to the critical temperature (you will need to choose suitable units for your axes). Plot also the gradient and second derivative of <span class="math inline">\(P\)</span> vs <span class="math inline">\(V\)</span> on the critical isotherm and confirm numerically that it exhibits a point of inflection at the critical pressure and temperature.</p></li>
<li><p>Obtain the value of the critical exponent <span class="math inline">\(\gamma\)</span> of the vdW model and confirm that it takes a mean-field value.</p></li>
</ul>
<hr>
</section>
<section id="mean-field-theory-of-the-ising-model-heat-capacity" class="level3">
<h3 class="anchored" data-anchor-id="mean-field-theory-of-the-ising-model-heat-capacity">4. Mean field theory of the Ising model heat capacity</h3>
<p>Using results derived in lectures, obtain an expression for the mean energy <span class="math inline">\(\langle E\rangle\)</span> of the Ising model in zero field, within the simplest mean field approximation <span class="math inline">\(\langle
  s_is_j\rangle=\langle s_i\rangle\langle s_j\rangle=m^2\)</span>. Hence show that for <span class="math inline">\(H=0\)</span> the heat capacity <span class="math inline">\(\partial \langle
  E\rangle/\partial T\)</span> has the behaviour</p>
<span class="math display">\[\begin{aligned}
C_H=&amp; 0 ~~~~ T&gt;T_c\\
C_H=&amp; 3Nk_B/2 ~~~~ T\le T_c
\end{aligned}\]</span>
<hr>
</section>
<section id="magnetisation-and-fluctuations" class="level3">
<h3 class="anchored" data-anchor-id="magnetisation-and-fluctuations">5. Magnetisation and fluctuations</h3>
<p>A system of spins on a lattice, has, in the absence of an applied field, a Hamiltonian <span class="math inline">\({\cal H}\)</span>. In the presence of a field <span class="math inline">\(h\)</span> the Hamiltonian becomes <span class="math display">\[
\tilde {\cal H}={\cal H}-hM
\]</span> where <span class="math inline">\(M\)</span> is the total magnetisation and <span class="math inline">\(h\)</span> is the magnetic field. By considering the partition function <span class="math inline">\(Z(T,h)\)</span> and its relationship to the free energy <span class="math inline">\(F\)</span> show that in general</p>
<p><span class="math display">\[
\langle M \rangle=-\left(\frac{\partial F}{\partial h}\right)_T
\]</span></p>
<p>Show also that the variance of the magnetisation fluctuations is</p>
<p><span class="math display">\[\langle M^2\rangle-\langle M\rangle^2=-k_BT\left(\frac{\partial^2 F}{\partial h^2}\right)_T\]</span></p>
<p>(<em>Hint: This is an important standard derivation found in many text books on Statistical Mechanics. You will need to differentiate <span class="math inline">\(F\)</span> (twice) and use the product and chain rules.</em>)</p>
<hr>
</section>
<section id="spin-1-ising-model" class="level3">
<h3 class="anchored" data-anchor-id="spin-1-ising-model">6. Spin-1 Ising model</h3>
<p>A set of spins on a lattice of coordination number <span class="math inline">\(q\)</span> can take values <span class="math inline">\((-1,0,1)\)</span>, as opposed to just <span class="math inline">\((-1,1)\)</span> as in the spin-1/2 Ising model. The Hamiltonian is</p>
<p><span class="math display">\[{\cal H}=-J\sum_{&lt;ij&gt;}s_is_j + h\sum_i s_i\]</span></p>
<p>Find the partition function and hence show that in the mean field approximation, the magnetisation per site obeys</p>
<p><span class="math display">\[m=\frac{2\sinh[\beta(Jqm+h)]}{2\cosh[\beta(Jqm+h)]+1}\]</span></p>
<p>and find the critical temperature <span class="math inline">\(T_c\)</span> at which the net magnetisation vanishes.</p>
<hr>
</section>
<section id="transfer-matrix." class="level3">
<h3 class="anchored" data-anchor-id="transfer-matrix.">7. Transfer Matrix.</h3>
<p>Verify the calculation of the free energy of the 1D periodic chain Ising model in a field outlined in lectures using the Transfer Matrix method.</p>
<p>Use your results to show that the spontaneous magnetisation is:</p>
<p><span class="math display">\[m=\frac{\sinh \beta H}{\sqrt{\sinh^2\beta H+\exp{-4\beta J}}}\]</span> Comment on the value of <span class="math inline">\(m\)</span> in zero field.</p>
<p>(<em>Hint: Follow the prescription given in lectures. Depending on your approach you may need to use the trigonometrical identities <span class="math inline">\(\cosh^2x-\sinh^2x=1\)</span>, <span class="math inline">\(\cosh(2x)=2\cosh^2x-1\)</span>.</em>)</p>
<hr>
</section>
<section id="landau-theory" class="level3">
<h3 class="anchored" data-anchor-id="landau-theory">8. Landau theory</h3>
<p>Check and complete the Landau theory calculations, given in lectures, for the critical exponents <span class="math inline">\(\gamma=1\)</span> and <span class="math inline">\(\alpha=0\)</span> of the Ising model. For the latter, you should first prove the result</p>
<p><span class="math display">\[C_H =-T\frac{\partial^2 F}{\partial T^2}\]</span> starting from the classical theormodynamics expression for changes in the free energy of a magnet <span class="math inline">\(dF=-SdT-MdH\)</span>.</p>
<p>(<em>Hint: If you get stuck with the proof see standard thermodynamics text books. To get the susceptibility exponent in Landau theory add a term <span class="math inline">\(-Hm\)</span> to the Hamiltonian.</em>)</p>
<hr>
</section>
<section id="scaling-equation-of-state" class="level3">
<h3 class="anchored" data-anchor-id="scaling-equation-of-state">9. Scaling equation of state</h3>
<p>Consider a Landau expression for the free energy of a magnetic system having magnetisation <span class="math inline">\(m\)</span>:</p>
<p><span class="math display">\[
F=F_0+\tilde{a}_2tm^2+a_4m^4-Hm\:,
\]</span> where <span class="math inline">\(t=T-T_c\)</span> and <span class="math inline">\(H\)</span> is an applied magnetic field; <span class="math inline">\(\tilde{a}_2\)</span> and <span class="math inline">\(a_4\)</span> are positive constants and <span class="math inline">\(F_0\)</span> is a constant background term.</p>
<p>Show that the equation of state for the model is</p>
<p><span class="math display">\[
H=2\tilde{a}_2tm+4a_4m^3\:.
\]</span></p>
<p>Use the near-critical power law behaviour of <span class="math inline">\(m\)</span> to show that the equation of state may be written in the scaling form</p>
<p><span class="math display">\[
\frac{H}{m^\delta}=g\left(\frac{t}{m^{1/\beta}}\right)\:,
\]</span> and find the (mean field) values of the critical exponents <span class="math inline">\(\delta\)</span> and <span class="math inline">\(\beta\)</span>.</p>
<p>Deduce that <span class="math inline">\(g(x)=x+1\)</span> up to a choice of scale for <span class="math inline">\(\tilde{a}_2\)</span> and <span class="math inline">\(a_4\)</span>.</p>
<hr>
</section>
<section id="scaling-laws" class="level3">
<h3 class="anchored" data-anchor-id="scaling-laws">10. Scaling laws</h3>
<p>Using the generalised homogeneous form for the free energy given in lectures, take appropriate derivatives to find the relationships to the critical exponents:</p>
<p><span class="math display">\[\beta=\frac{1-b}{a}; ~~ \gamma=\frac{2b-1}{a};~~ \delta= \frac{b}{1-b}; ~~~ \alpha=2-\frac{1}{a}.\]</span></p>
<p>Hence derive the scaling laws among the critical exponents:</p>
<span class="math display">\[\begin{aligned}
\alpha+\beta(\delta+1)=2 \\
\alpha+2\beta+\gamma=2\\
%\gamma=\beta(\delta-1)
\end{aligned}\]</span>
<p>(<em>Hint: For the heat capacity exponent <span class="math inline">\(\alpha\)</span> use the result from problem 9: <span class="math inline">\(C_H=-T\left(\frac{\partial^2F}{\partial T^2}\right)_{h=0}\)</span></em>)</p>
<hr>
</section>
<section id="classical-nucleation-theory" class="level3">
<h3 class="anchored" data-anchor-id="classical-nucleation-theory">11. Classical nucleation theory</h3>
<p>A supercooled liquid metal is undergoing solidification. According to classical nucleation theory, the Gibbs free energy change <span class="math inline">\(\Delta G\)</span> for forming a spherical solid nucleus of radius <span class="math inline">\(r\)</span> in the liquid is given by:</p>
<p><span class="math display">\[
\Delta G(r) = \frac{4}{3}\pi r^3 \Delta G_v + 4\pi r^2 \gamma
\]</span> where <span class="math inline">\(\Delta G_v &lt; 0\)</span> is the free energy change per unit volume due to the phase change, and <span class="math inline">\(\gamma &gt; 0\)</span> is the interfacial energy between the solid and liquid phases.</p>
<p><strong>(a)</strong> Derive the expression for the critical radius <span class="math inline">\(r^*\)</span> at which the nucleus becomes stable and begins to grow.</p>
<p><strong>(b)</strong> Show that the critical energy barrier for nucleation <span class="math inline">\(\Delta G^*\)</span> is given by:</p>
<p><span class="math display">\[
\Delta G^* = \frac{16\pi \gamma^3}{3 (\Delta G_v)^2}
\]</span></p>
<p><strong>(c)</strong> Explain qualitatively how the degree of undercooling <span class="math inline">\(\Delta T\)</span> affects the rate of nucleation. You may use the fact that <span class="math inline">\(\Delta G_v \propto \Delta T\)</span> to support your answer.</p>
<hr>
</section>
<section id="colloidal-diffusion" class="level3">
<h3 class="anchored" data-anchor-id="colloidal-diffusion">12. Colloidal diffusion</h3>
<p>A large colloidal particle of mass <span class="math inline">\(M\)</span> moves in a fluid under the influence of a random force <span class="math inline">\(F(t)\)</span> and a coefficient of Stokes friction drag <span class="math inline">\(\gamma\)</span>, both per unit mass. If the solution of the corresponding Langevin equation for the velocity of the colloidal particle is given by</p>
<p><span class="math display">\[
u = u_0 e^{-\gamma t} + e^{-\gamma t} \int_0^t dt' \, e^{\gamma t'} F(t'),
\]</span></p>
<p>where <span class="math inline">\(u_0\)</span> is the velocity at <span class="math inline">\(t = 0\)</span>, show that for long times the velocity of the particle satisfies the relation</p>
<p><span class="math display">\[
\langle u^2 \rangle = \frac{kT}{M} + \left( u_0^2 - \frac{kT}{M} \right) e^{-2\gamma t},
\]</span></p>
<p>where <span class="math inline">\(k\)</span> is the Boltzmann constant and <span class="math inline">\(T\)</span> is the absolute temperature.</p>
<p>State clearly any assumptions that you make.</p>
<hr>
</section>
<section id="einsteins-expression-for-the-diffusion-coefficient" class="level3">
<h3 class="anchored" data-anchor-id="einsteins-expression-for-the-diffusion-coefficient">13. Einstein’s expression for the diffusion coefficient</h3>
<p>In 1905, Einstein showed that the friction coefficient <span class="math inline">\(\gamma\)</span> (per unit mass) of a colloidal particle must be related to the diffusion coefficient <span class="math inline">\(D\)</span> of the particle by</p>
<p><span class="math display">\[
D = \frac{kT}{\gamma}.
\]</span></p>
<p>If a marked particle covers a distance <span class="math inline">\(X\)</span> in a given time <span class="math inline">\(t\)</span> (assuming a one-dimensional random walk), the diffusion coefficient is defined to be</p>
<p><span class="math display">\[
D = \lim_{t \to \infty} \frac{1}{2t} \langle [X(t) - X(0)]^2 \rangle,
\]</span></p>
<p>where the average <span class="math inline">\(\langle \cdot \rangle\)</span> is taken over an ensemble in thermal equilibrium.</p>
<p>Use the fact that <span class="math inline">\(X(t) - X(0)
= \int_{0}^{t} u(t')\,\mathrm{d}t'\)</span> to show that the Einstein relation may be written as</p>
<p><span class="math display">\[
\gamma = \frac{1}{\mu} = \frac{D}{kT} = \frac{1}{kT} \int_0^\infty \langle u(t_0) u(t_0 + t) \rangle \, dt,
\]</span></p>
<p>where <span class="math inline">\(\mu\)</span> is known as the mobility of the particle and <span class="math inline">\(t_0\)</span> is any arbitrarily chosen time.</p>
<hr>
</section>
<section id="life-in-one-dimension" class="level3">
<h3 class="anchored" data-anchor-id="life-in-one-dimension">14. Life in one dimension</h3>
<p>A particle lives on the sites of a one-dimensional lattice. At any instant it has probability <span class="math inline">\(\alpha\)</span> per unit time that it will hop to the site on its right and probability <span class="math inline">\(\alpha\)</span> per unit time of hopping to the site on its left.</p>
<p>Write down the master equation for the set of probabilities <span class="math inline">\(p_n(t)\)</span> of finding the particle at the <span class="math inline">\(n^{\text{th}}\)</span> site, where <span class="math inline">\(-\infty &lt; n &lt; \infty\)</span>.</p>
<p>Solve the master equation for the <span class="math inline">\(p_n\)</span>, subject to the initial condition that the particle was at the site <span class="math inline">\(n = 0\)</span> at time <span class="math inline">\(t = 0\)</span>. Hence obtain the mean position <span class="math inline">\(\langle n \rangle\)</span> and root mean square deviation from the mean, both as functions of time.</p>
<p><strong>Hint</strong>: The second part of the question is most easily done by introducing the generating function</p>
<p><span class="math display">\[
F(z, t) = \sum_{n=-\infty}^{\infty} p_n(t) z^n.
\]</span></p>
<hr>
</section>
<section id="master-equation" class="level3">
<h3 class="anchored" data-anchor-id="master-equation">15. Master equation</h3>
<p>A system of <span class="math inline">\(N\)</span> atoms, each having two energy levels <span class="math inline">\(E = \pm \epsilon\)</span>, is brought into contact with a heat bath at temperature <span class="math inline">\(T\)</span>. The atoms do not interact with each other, but each atom interacts with the heat bath to have a probability <span class="math inline">\(\lambda_{-\to+}(T)\)</span> per unit time of transition from lower to higher level, and a probability <span class="math inline">\(\lambda_{+\to-}(T)\)</span> per unit time of the reverse transition.</p>
<p>If at any time <span class="math inline">\(t\)</span> there are <span class="math inline">\(n_+(t)\)</span> atoms at the higher level and <span class="math inline">\(n_-(t)\)</span> at the lower level, then <span class="math inline">\(n(t) = n_-(t) - n_+(t)\)</span> is a convenient measure of the non-equilibrium state.</p>
<p>Obtain the master equation for <span class="math inline">\(n(t)\)</span> and hence the relaxation time <span class="math inline">\(\tau\)</span> which characterizes the exponential approach of the system to equilibrium.</p>
<hr>
</section>
<section id="detailed-balance" class="level3">
<h3 class="anchored" data-anchor-id="detailed-balance">16. Detailed balance</h3>
<p><strong>(a)</strong> Starting from the principle of detailed balance for an isolated system, show that for two groups of states within it, <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, the overall rate of transitions from group <span class="math inline">\(A\)</span> to group <span class="math inline">\(B\)</span> is balanced, in equilibrium, by those from <span class="math inline">\(B\)</span> to <span class="math inline">\(A\)</span>:</p>
<p><span class="math display">\[
\lambda_{A \to B} p^{\text{eq}}_A = \lambda_{B \to A} p^{\text{eq}}_B
\]</span></p>
<p><strong>(b)</strong> Deduce that the principle applies to microstates in the canonical ensemble, and hence that the jump rates between states of a subsystem (of fixed number of particles) connected to a heat bath must obey</p>
<p><span class="math display">\[
\frac{\lambda_{i \to j}}{\lambda_{j \to i}} = e^{-(E_j - E_i)/kT}.
\]</span></p>
<hr>
</section>
<section id="jump-processes" class="level3">
<h3 class="anchored" data-anchor-id="jump-processes">17. Jump processes</h3>
<p>An isolated system can occupy three possible states of the same energy. The kinetics are such that it can jump from state 1 to 2 and 2 to 3 but not directly from 1 to 3. Per unit time, there is a probability <span class="math inline">\(\lambda_0\)</span> that the system makes a jump, from the state it is in, into (each of) the other state(s) it can reach.</p>
<p><strong>(a)</strong> Show that the occupancy probabilities <span class="math inline">\(p = (p_1, p_2, p_3)\)</span> of the three states obey the master equation</p>
<p><span class="math display">\[
\dot{p} = M \cdot p
\]</span></p>
<p>where the rate matrix is</p>
<p><span class="math display">\[
M = \lambda_0 \begin{bmatrix}
-1 &amp; 1 &amp; 0 \\
1 &amp; -2 &amp; 1 \\
0 &amp; 1 &amp; -1
\end{bmatrix}
\]</span></p>
<p><strong>(b)</strong> Confirm that an equilibrium state is <span class="math inline">\(p = (1, 1, 1)/3\)</span>.</p>
<p><strong>(c)</strong> Prove this equilibrium state is unique.</p>
<p><strong>Hint</strong>: For part (c), consider the eigenvalues of <span class="math inline">\(M\)</span>.</p>


<script type="ojs-module-contents">
eyJjb250ZW50cyI6W119
</script>
<div id="exercise-loading-indicator" class="exercise-loading-indicator d-none d-flex align-items-center gap-2">
<div id="exercise-loading-status" class="d-flex gap-2">

</div>
<div class="spinner-grow spinner-grow-sm">

</div>
</div>
<script type="vfs-file">
W10=
</script>
</section>

</main> <!-- /main -->
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W119
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../phase-transitions";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="../phase-transitions/dynamics-of-fluctuations.html" class="pagination-link" aria-label="Dynamics of fluctuations (non-examinable)">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Dynamics of fluctuations (non-examinable)</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../phase-transitions/precourse-reading.html" class="pagination-link" aria-label="Problems">
        <span class="nav-page-text">Problems</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>