{"title":"Introduction to Stochastic Processes","markdown":{"headingText":"Introduction to Stochastic Processes","containsRefs":false,"markdown":"\n\nMany natural phenomena are stochastic â€” they involve randomness in their evolution over time.\n\nIn classical physics, this randomness may arise from our lack of knowledge about microscopic details. For example, in a gas, we do not know the precise positions and velocities of each particle, so their collisions with the container walls appear random.\n\nIn quantum mechanics, stochasticity is even more intrinsic. The fundamental objects are probability amplitudes, and outcomes are inherently probabilistic. \n\nTo describe these systems effectively, we use a coarse-grained probabilistic description, which tracks the likelihood of different outcomes rather than precise trajectories. One of the key tools in this approach is the master equation.\n\n\n## The Master Equation\n\nConsider a system in microstate $i$ with energy $E_i$. It can transition to neighboring microstates $j$, where the energy difference $|E_j - E_i|$ is small (within $\\delta E$). \n\nLet $\\nu_{ij}$ be the **rate** at which the system jumps from state $i$ to state $j$. Over an infinitesimal time interval $dt$, the probability $p_i$ changes as:\n\n$$\ndp_i = \\left[ -p_i \\sum_j  \\nu_{ij} + \\sum_j \\nu_{ji} p_j \\right] dt\n$$\n\nThis expression contains two terms:\n\n*  A *loss term*: the system leaves state $i$ at rate $\\nu_{ij}$,\n*  A *gain term*: the system arrives in state $i$ from other states $j$ at rate $\\nu_{ji}$.\n\nThe master equation becomes:\n\n$$\n\\frac{dp_i}{dt} = -\\sum_j \\nu_{ij} p_i + \\sum_j \\nu_{ji} p_j\n$$\n\nThis is a linear first-order differential equation for the vector of probabilities $\\{p_i\\}$.\n\nAlternatively, in matrix form:\n\n$$\n\\frac{d\\mathbf{p}}{dt} = W \\mathbf{p}\n$$\n\nwhere $W$ is the **rate matrix** with entries:\n\n- $W_{ij} = \\nu_{ji}$ for $i \\neq j$,\n- $W_{ii} = -\\sum_{j \\neq i} \\nu_{ij}$.\n\nThis structure ensures probability conservation: the total probability $\\sum_i p_i = 1$ remains constant in time.\n\nThe master equation is first order in time and does not have time reversal symmetry so describes an irreversible process.\nThis irreversibility arises from the coarse-graining process that throws away information about underlying microphysics which \nis described by Newton's equations and which *are* time reversible. Only \nby doing so is the entropy allowed to increase which is required by the second law of thermodynamics for an irreversible process. \nConsequently the increase of entropy is linked to our knowledge about the system rather than anything it is doing internally \nin a manner that may appear dubious. Can it be possible that macroscopic and reproducible phenomena such as heat flow depend\non how we handle information? Perhaps yes since the division between work and heat is somewhat arbitrary. \nWere we able to track all the particle positions there would be no need to talk about heat energy or heat flow.\n\n\n## From the Master Equation to the Diffusion Equation\n\nNow consider the situation where the state index $i$ corresponds to a position in space, $x_i = i a$, ie a one-dimensional lattice with lattice spacing $a$, and transitions only occur between neighboring lattice sites.\n\nWe assume:\n\n* Transition rates are symmetric: \n$\\nu_{i, i+1} = \\nu_{i, i-1} = \\nu$,\n\n* The spacing $a\\to 0$ in the continuum limit.\n\nThe master equation becomes a finite-difference equation:\n\n\\begin{aligned}\n\\frac{dp_i}{dt} =  &\\sum_j\\nu_{ij}(p_j-p_i)\\\\\n\\frac{dp_i}{dt} =  &\\nu(p_{i-1}-p_i) + \\nu(p_{i+1} - p_i)\\\\\n\\frac{dp_i}{dt} =  &\\nu(p_{i+1} + p_{i-1} - 2p_i)\n\\end{aligned}\n\nWe now define a continuous variable $x = i a$, and a probability density $p(x, t)$ such that $p_i(t) \\approx p(x, t)$.\n\nUsing Taylor expansions:\n\n$$\np(x \\pm a, t) = p(x, t) \\pm a \\frac{\\partial p}{\\partial x} + \\frac{a^2}{2} \\frac{\\partial^2 p}{\\partial x^2} + \\cdots\n$$\n\nSubstituting into the master equation gives:\n\n$$\n\\frac{\\partial p}{\\partial t} = \n\\nu a^2 \\frac{\\partial^2 p}{\\partial x^2}\n$$\n\nDefining the diffusion constant $D = \\nu a^2$, we obtain the **diffusion equation**:\n\n$$\n\\frac{\\partial p}{\\partial t} = D \\frac{\\partial^2 p}{\\partial x^2}\n$$\n\nThe diffusion equation describes the evolution of the probability density of a particle with diffusion constant (sometimes called diffusivity) given by $D = \\nu a^2$. The dimensions of $D$ are $[\\text{length}]^2/[\\text{time}]$. Typically, after expansion, we set the lattice spacing $a$ to 1. Additionally, the diffusion equation can describe many non-interacting diffusing particles. In this case, we replace $p$ with $\\rho$, representing the density or concentration of particles, and use the normalization $\\int dx \\, \\rho = M$, where $M$ is the number of particles.\n\nThe diffusion equation, much like the master equation from which it originates, explicitly violates time-reversal symmetry, thus permitting entropy to increase.\n\nThe solution of the diffusion equation for an initial condition where the particle is initially localized at the origin (formally, $p(x,0) = \\delta(x)$) is a Gaussian:\n\n$$\np(x,t) = (4 \\pi D t)^{-1/2} \\exp\\left[-\\frac{x^2}{4 D t}\\right]\n$$\n\n\nWe explicitly see the arrow of time by examining this Gaussian solution at various times $t$. \nAs $t$ increases, the Gaussian \"bell-shaped\" curve spreads out. \nIts width grows according to $\\langle x^2 \\rangle^{1/2} \\sim t^{1/2}$. \nThis is known as \"diffusive scaling,\" and it implies that, after time $t$, a particle will typically be found \nat a distance roughly proportional to $t^{1/2}$ from its starting point. \nConversely, exploring a region of size $L$ typically requires a time of order $O(L^2)$.\n\n\nThe evolution of the solution to the 1d diffusion equation in a spatial region $x=[0,1]$  as a function of times are shown in the movie below. The diffusion constant is $D=0.01$.\nThe movie corresponds to a particle initialised at $x=0.5$. One sees how the probability density spreads out over the range as time increases. \nThis can be used to model the diffusion of particles down a concentration gradient as you will see in the next part of the course.\n\n{{< video Movies/diffusion_evolution.mp4 >}}\n\n\n```{python}\n#| echo: true\n#| eval: false\n#| code-fold: true\n#| code-summary: \"Show python code\"\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport matplotlib.animation as animation\nimport os\n\n# Parameters\nL = 1.0        # Length of the domain\nT = 1.0        # Total time \nnx = 400       # Number of spatial points\nnt = 2000      # Number of time steps\nD = 0.1        # Diffusion coefficient\n\n# Discretization\ndx = L / (nx - 1)\ndt = T / nt\n\n# Stability condition auto-adjust\nif D * dt / dx**2 > 0.5:\n    print(\"Adjusting dt and nt to satisfy stability condition...\")\n    dt = 0.4 * dx**2 / D\n    nt = int(T / dt)\n    dt = T / nt  # Recalculate dt exactly\n\nnt = int(nt / 50)  # Artificial slowdown for animation\n\nprint(f\"Using dt = {dt:.4e}, nt = {nt}\")\n\n# Initialize x and u\nx = np.linspace(0, L, nx)\n\n# Initial condition: smooth narrow Gaussian\nsigma = 0.01\nu = np.exp(-(x - L/2)**2 / (2 * sigma**2))\n\n# Normalize initial condition\nu /= np.sum(u) * dx\n\n# Setup figure\nplt.rcParams.update({\n    \"text.usetex\": True,\n    \"font.family\": \"serif\"\n})\n\nfig, ax = plt.subplots()\nline, = ax.plot(x, u)\n\n# Compute peak height for setting y-axis\npeak_height = 1 / (np.sqrt(2 * np.pi) * sigma)\nax.set_ylim(0, peak_height * 1.05)\n\nax.set_xlabel(r'$x$', fontsize=20)\nax.set_ylabel(r'$p(x,t)$', fontsize=20)\n\nax.tick_params(axis='both', which='major', labelsize=14)\n\n# Tiny time counter text\ntime_text = ax.text(0.85, 0.05, '', transform=ax.transAxes, fontsize=10, verticalalignment='bottom')\n\n\n# Function to update the plot\ndef update(frame):\n    global u\n    unew = np.copy(u)\n    unew[1:-1] = u[1:-1] + D * dt / dx**2 * (u[2:] - 2*u[1:-1] + u[:-2])\n    u = unew\n\n    # Normalize at every step\n    u /= np.sum(u) * dx\n\n    line.set_ydata(u)\n    current_time = frame * dt\n    time_text.set_text(r'$t=%.4f$' % current_time)\n    return line, time_text\n\nani = animation.FuncAnimation(fig, update, frames=nt, interval=100, blit=True)\n\n\n# Save the animation as a movie\nWriter = animation.writers['ffmpeg']\nwriter = Writer(fps=15, metadata=dict(artist='Me'), bitrate=1800)\nani.save(\"../Movies/diffusion_evolution.mp4\", writer=writer)\n\n\nplt.show()\n\n```\n<!--\n ![Solutions to the 1d diffusion equation at increasing times](Figs/diffusion_profiles.png){fig-align=\"center\" #fig-diffusion width=70%}\n-->\n\n\n\n## Consequences of time reversal symmetry\n\nAs we have seen by introducing a type of coarse graining, the master equation violates time reversal symmetry of the underlying Newtonian dynamics. \nRemarkably however, the fact that the underlying microphysics is actually time reversal symmetric has several deep consequences which survive the coarse \ngraining procedure These results are some of the cornerstones of nonequilibrium thermodynamics\n\n### Detailed balance\n\nRecall from year 2 Statistical Mechanics that for a system in equilibrium, the principle of equal a-priori probabilities of microstates holds. Therefore\n\n$$\n\\nu_{ij} p_i^{eq} = \\nu_{ji} p_j^{eq}\n$$\n\nHence, on average, the actual rate of quantum jumps from $i$ to $j$ (the left-hand side) is the same as from $j$ to $i$. This is a stronger statement than the master equation, which asserts only that there is overall balance between the rate of jumping into and out of state $i$ in equilibrium. The result above is known as the *principle of detailed balance*.\n\nThis principle is powerful because it applies not only to individual states but also to any grouping of states.\n\n*Exercise:* Show that for two groups of states, $A$ and $B$, the overall rate of transitions from group $A$ to group $B$ is balanced, in equilibrium, by those from $B$ to $A$:\n\n$$\n\\nu_{AB} p_A^{eq} = \\nu_{BA} p_B^{eq}\n$$\n\nHence, detailed balance arguments can be extended to subsystems within a large isolated system, and even to systems that are not isolated. However, in such cases, the principle is far from obvious, because once states are grouped together:\n\n$$\n\\nu_{AB} \\ne \\nu_{BA}, \\quad p_A \\ne p_B\n$$\n\n(This can be easily demonstrated, for example, by considering two groups that contain different numbers of states with similar energies.) Nonetheless, the detailed balance relation holds, in equilibrium, in the general form above.\n\n\n### Computer simulation\n\nIn computer simulation, good results will be obtained if one accurately follows the microscopic equations of motion. This is the *molecular dynamics (MD)* method which we now outline.\n\n**Molecular dynamics**\n\n\nMolecular Dynamics (MD) involves a system of classical particles interacting through specified interparticle forces. \nThe motion of these particles is determined by numerically integrating Newton's equations of motion. \nIn MD simulations, averages of state variables are obtained as time averages over trajectories in phase space. \nTypically, the forces acting between particles are conservative, ensuring that the total energy $E$ remains constant. \nThis conservation implies that the motion is restricted to a $(2dN - 1)$-dimensional surface in phase space,\n denoted by $\\Gamma(E)$.\n\nA central aspect of MD is the averaging of observables. For a given observable $A$, its average is computed \nas the time average along the trajectory. Mathematically, this is expressed as:\n\n$$\n\\left\\langle A(\\{ \\mathbf{p}_i \\}, \\{ \\mathbf{r}_i \\}) \\right\\rangle = \\frac{1}{\\tau} \\int_{t_0}^{t_0+\\tau} dt\\, A(\\{ \\mathbf{p}_i(t) \\}, \\{ \\mathbf{r}_i(t) \\})\n$$\n\nThis formula represents the integral of the observable over a time interval $\\tau$, normalized by the length of that interval.\n\nThe practical steps of an MD simulation start with generating an initial random configuration of particle positions \n$\\{ \\mathbf{r}_i \\}$ and momenta $\\{ \\mathbf{p}_i \\}$. The system's equations of motion are then iteratively solved using a \nsuitable algorithm to allow it to reach equilibrium. After equilibration, a production run is performed over many time \nsteps to collect meaningful data. Finally, relevant averages, such as pressure or kinetic energy, are calculated from the \ncollected data.\n\n\n**Monte Carlo**\n\nHowever, to obtain the equilibrium properties of the system, it may be much faster to use a dynamics which is nothing like the actual equations of motion. \n\nAt first sight, this looks very dangerous; however, if one can prove that in the required equilibrium distribution, the artificial dynamics\nobey the principle of detailed balance, then it is (almost) guaranteed that the steady state found by simulation is the true equilibrium state.\n\nThe best known example is the *Monte Carlo method*, in which the dynamical algorithm consists of random jumps. The jump rates $\\nu_{AB}$ for all pairs of states $(A, B)$ take the form:\n\n$$\n\\nu_{AB} = \\nu_0 \\quad \\text{if } E_B \\le E_A\n$$\n\n$$\n\\nu_{AB} = \\nu_0 e^{-\\beta (E_B - E_A)} \\quad \\text{if } E_B \\ge E_A\n$$\n\nwhere $\\nu_0$ is a constant.\n\n*Exercise:* Show that this gives the canonical distribution in steady state.\n","srcMarkdownNoYaml":""},"formats":{"live-html":{"identifier":{"display-name":"HTML","target-format":"live-html","base-format":"html","extension-name":"live"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"shortcodes":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","filters":["/Users/phxnw/Dropbox/course-disordered-matter/quarto/_extensions/r-wasm/live/live.lua"],"toc":true,"output-file":"master-equation-and-diffusion.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.551","ojs-engine":true,"revealjs-plugins":[],"theme":"cosmo","grid":{"sidebar-width":"305px"},"mainfont":"sans-serif","fontsize":"15px","pyodide":{"cell-options":{"autorun":true}}},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["live-html"]}